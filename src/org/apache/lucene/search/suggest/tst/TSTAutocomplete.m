//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./suggest/src/java/org/apache/lucene/search/suggest/tst/TSTAutocomplete.java
//

#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/lang/CharSequence.h"
#include "java/util/ArrayList.h"
#include "java/util/Stack.h"
#include "org/apache/lucene/search/suggest/tst/TSTAutocomplete.h"
#include "org/apache/lucene/search/suggest/tst/TernaryTreeNode.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/search/suggest/tst/TSTAutocomplete must not be compiled with ARC (-fobjc-arc)"
#endif

@implementation OrgApacheLuceneSearchSuggestTstTSTAutocomplete

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneSearchSuggestTstTSTAutocomplete_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)balancedTreeWithNSObjectArray:(IOSObjectArray *)tokens
                    withNSObjectArray:(IOSObjectArray *)vals
                              withInt:(jint)lo
                              withInt:(jint)hi
withOrgApacheLuceneSearchSuggestTstTernaryTreeNode:(OrgApacheLuceneSearchSuggestTstTernaryTreeNode *)root {
  if (lo > hi) return;
  jint mid = JreIntDiv((lo + hi), 2);
  root = [self insertWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:root withJavaLangCharSequence:(NSString *) cast_chk(IOSObjectArray_Get(nil_chk(tokens), mid), [NSString class]) withId:IOSObjectArray_Get(nil_chk(vals), mid) withInt:0];
  [self balancedTreeWithNSObjectArray:tokens withNSObjectArray:vals withInt:lo withInt:mid - 1 withOrgApacheLuceneSearchSuggestTstTernaryTreeNode:root];
  [self balancedTreeWithNSObjectArray:tokens withNSObjectArray:vals withInt:mid + 1 withInt:hi withOrgApacheLuceneSearchSuggestTstTernaryTreeNode:root];
}

- (OrgApacheLuceneSearchSuggestTstTernaryTreeNode *)insertWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:(OrgApacheLuceneSearchSuggestTstTernaryTreeNode *)currentNode
                                                                                    withJavaLangCharSequence:(id<JavaLangCharSequence>)s
                                                                                                      withId:(id)val
                                                                                                     withInt:(jint)x {
  if (s == nil || [s java_length] <= x) {
    return currentNode;
  }
  if (currentNode == nil) {
    OrgApacheLuceneSearchSuggestTstTernaryTreeNode *newNode = create_OrgApacheLuceneSearchSuggestTstTernaryTreeNode_init();
    newNode->splitchar_ = [s charAtWithInt:x];
    currentNode = newNode;
    if (x < [s java_length] - 1) {
      JreStrongAssign(&currentNode->eqKid_, [self insertWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:currentNode->eqKid_ withJavaLangCharSequence:s withId:val withInt:x + 1]);
    }
    else {
      JreStrongAssign(&currentNode->token_, [s description]);
      JreStrongAssign(&currentNode->val_, val);
      return currentNode;
    }
  }
  else if (currentNode->splitchar_ > [s charAtWithInt:x]) {
    JreStrongAssign(&currentNode->loKid_, [self insertWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:currentNode->loKid_ withJavaLangCharSequence:s withId:val withInt:x]);
  }
  else if (currentNode->splitchar_ == [s charAtWithInt:x]) {
    if (x < [s java_length] - 1) {
      JreStrongAssign(&currentNode->eqKid_, [self insertWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:currentNode->eqKid_ withJavaLangCharSequence:s withId:val withInt:x + 1]);
    }
    else {
      JreStrongAssign(&currentNode->token_, [s description]);
      JreStrongAssign(&currentNode->val_, val);
      return currentNode;
    }
  }
  else {
    JreStrongAssign(&currentNode->hiKid_, [self insertWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:currentNode->hiKid_ withJavaLangCharSequence:s withId:val withInt:x]);
  }
  return currentNode;
}

- (JavaUtilArrayList *)prefixCompletionWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:(OrgApacheLuceneSearchSuggestTstTernaryTreeNode *)root
                                                                 withJavaLangCharSequence:(id<JavaLangCharSequence>)s
                                                                                  withInt:(jint)x {
  OrgApacheLuceneSearchSuggestTstTernaryTreeNode *p = JreRetainedLocalValue(root);
  JavaUtilArrayList *suggest = create_JavaUtilArrayList_init();
  while (p != nil) {
    if ([((id<JavaLangCharSequence>) nil_chk(s)) charAtWithInt:x] < p->splitchar_) {
      p = p->loKid_;
    }
    else if ([s charAtWithInt:x] == p->splitchar_) {
      if (x == [s java_length] - 1) {
        break;
      }
      else {
        x++;
      }
      p = p->eqKid_;
    }
    else {
      p = p->hiKid_;
    }
  }
  if (p == nil) return suggest;
  if (p->eqKid_ == nil && p->token_ == nil) return suggest;
  if (p->eqKid_ == nil && p->token_ != nil) {
    [suggest addWithId:p];
    return suggest;
  }
  if (p->token_ != nil) {
    [suggest addWithId:p];
  }
  p = p->eqKid_;
  JavaUtilStack *st = create_JavaUtilStack_init();
  [st pushWithId:p];
  while (![st empty]) {
    OrgApacheLuceneSearchSuggestTstTernaryTreeNode *top = JreRetainedLocalValue([st peek]);
    [st pop];
    if (((OrgApacheLuceneSearchSuggestTstTernaryTreeNode *) nil_chk(top))->token_ != nil) {
      [suggest addWithId:top];
    }
    if (top->eqKid_ != nil) {
      [st pushWithId:top->eqKid_];
    }
    if (top->loKid_ != nil) {
      [st pushWithId:top->loKid_];
    }
    if (top->hiKid_ != nil) {
      [st pushWithId:top->hiKid_];
    }
  }
  return suggest;
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 0, 1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneSearchSuggestTstTernaryTreeNode;", 0x1, 2, 3, -1, -1, -1, -1 },
    { NULL, "LJavaUtilArrayList;", 0x1, 4, 5, -1, 6, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(balancedTreeWithNSObjectArray:withNSObjectArray:withInt:withInt:withOrgApacheLuceneSearchSuggestTstTernaryTreeNode:);
  methods[2].selector = @selector(insertWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:withJavaLangCharSequence:withId:withInt:);
  methods[3].selector = @selector(prefixCompletionWithOrgApacheLuceneSearchSuggestTstTernaryTreeNode:withJavaLangCharSequence:withInt:);
  #pragma clang diagnostic pop
  static const void *ptrTable[] = { "balancedTree", "[LNSObject;[LNSObject;IILOrgApacheLuceneSearchSuggestTstTernaryTreeNode;", "insert", "LOrgApacheLuceneSearchSuggestTstTernaryTreeNode;LJavaLangCharSequence;LNSObject;I", "prefixCompletion", "LOrgApacheLuceneSearchSuggestTstTernaryTreeNode;LJavaLangCharSequence;I", "(Lorg/apache/lucene/search/suggest/tst/TernaryTreeNode;Ljava/lang/CharSequence;I)Ljava/util/ArrayList<Lorg/apache/lucene/search/suggest/tst/TernaryTreeNode;>;" };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestTstTSTAutocomplete = { "TSTAutocomplete", "org.apache.lucene.search.suggest.tst", ptrTable, methods, NULL, 7, 0x1, 4, 0, -1, -1, -1, -1, -1 };
  return &_OrgApacheLuceneSearchSuggestTstTSTAutocomplete;
}

@end

void OrgApacheLuceneSearchSuggestTstTSTAutocomplete_init(OrgApacheLuceneSearchSuggestTstTSTAutocomplete *self) {
  NSObject_init(self);
}

OrgApacheLuceneSearchSuggestTstTSTAutocomplete *new_OrgApacheLuceneSearchSuggestTstTSTAutocomplete_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestTstTSTAutocomplete, init)
}

OrgApacheLuceneSearchSuggestTstTSTAutocomplete *create_OrgApacheLuceneSearchSuggestTstTSTAutocomplete_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestTstTSTAutocomplete, init)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestTstTSTAutocomplete)
