//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./suggest/src/java/org/apache/lucene/search/suggest/SortedInputIterator.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/Closeable.h"
#include "java/io/IOException.h"
#include "java/lang/Long.h"
#include "java/util/Comparator.h"
#include "java/util/HashSet.h"
#include "java/util/Set.h"
#include "org/apache/lucene/search/suggest/InputIterator.h"
#include "org/apache/lucene/search/suggest/SortedInputIterator.h"
#include "org/apache/lucene/store/ByteArrayDataInput.h"
#include "org/apache/lucene/store/ByteArrayDataOutput.h"
#include "org/apache/lucene/util/ArrayUtil.h"
#include "org/apache/lucene/util/BytesRef.h"
#include "org/apache/lucene/util/BytesRefBuilder.h"
#include "org/apache/lucene/util/IOUtils.h"
#include "org/apache/lucene/util/OfflineSorter.h"
#include "org/lukhnos/portmobile/file/Files.h"
#include "org/lukhnos/portmobile/file/Path.h"

@interface OrgApacheLuceneSearchSuggestSortedInputIterator () {
 @public
  id<OrgApacheLuceneSearchSuggestInputIterator> source_;
  OrgLukhnosPortmobileFilePath *tempInput_;
  OrgLukhnosPortmobileFilePath *tempSorted_;
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *reader_;
  id<JavaUtilComparator> comparator_;
  jboolean hasPayloads_;
  jboolean hasContexts_;
  jboolean done_;
  jlong weight_;
  OrgApacheLuceneUtilBytesRefBuilder *scratch_;
  OrgApacheLuceneUtilBytesRef *payload_;
  id<JavaUtilSet> contexts_;
  /*!
   @brief Sortes by BytesRef (ascending) then cost (ascending).
   */
  id<JavaUtilComparator> tieBreakByCostComparator_;
}

- (OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *)sort;

- (void)close;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, source_, id<OrgApacheLuceneSearchSuggestInputIterator>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, tempInput_, OrgLukhnosPortmobileFilePath *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, tempSorted_, OrgLukhnosPortmobileFilePath *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, reader_, OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, comparator_, id<JavaUtilComparator>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, scratch_, OrgApacheLuceneUtilBytesRefBuilder *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, payload_, OrgApacheLuceneUtilBytesRef *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, contexts_, id<JavaUtilSet>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator, tieBreakByCostComparator_, id<JavaUtilComparator>)

__attribute__((unused)) static OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *OrgApacheLuceneSearchSuggestSortedInputIterator_sort(OrgApacheLuceneSearchSuggestSortedInputIterator *self);

__attribute__((unused)) static void OrgApacheLuceneSearchSuggestSortedInputIterator_close(OrgApacheLuceneSearchSuggestSortedInputIterator *self);

@interface OrgApacheLuceneSearchSuggestSortedInputIterator_$1 : NSObject < JavaUtilComparator > {
 @public
  OrgApacheLuceneSearchSuggestSortedInputIterator *this$0_;
  OrgApacheLuceneUtilBytesRef *leftScratch_;
  OrgApacheLuceneUtilBytesRef *rightScratch_;
  OrgApacheLuceneStoreByteArrayDataInput *input_;
}

- (jint)compareWithId:(OrgApacheLuceneUtilBytesRef *)left
               withId:(OrgApacheLuceneUtilBytesRef *)right;

- (instancetype)initWithOrgApacheLuceneSearchSuggestSortedInputIterator:(OrgApacheLuceneSearchSuggestSortedInputIterator *)outer$;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneSearchSuggestSortedInputIterator_$1)

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator_$1, this$0_, OrgApacheLuceneSearchSuggestSortedInputIterator *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator_$1, leftScratch_, OrgApacheLuceneUtilBytesRef *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator_$1, rightScratch_, OrgApacheLuceneUtilBytesRef *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestSortedInputIterator_$1, input_, OrgApacheLuceneStoreByteArrayDataInput *)

__attribute__((unused)) static void OrgApacheLuceneSearchSuggestSortedInputIterator_$1_initWithOrgApacheLuceneSearchSuggestSortedInputIterator_(OrgApacheLuceneSearchSuggestSortedInputIterator_$1 *self, OrgApacheLuceneSearchSuggestSortedInputIterator *outer$);

__attribute__((unused)) static OrgApacheLuceneSearchSuggestSortedInputIterator_$1 *new_OrgApacheLuceneSearchSuggestSortedInputIterator_$1_initWithOrgApacheLuceneSearchSuggestSortedInputIterator_(OrgApacheLuceneSearchSuggestSortedInputIterator *outer$) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneSearchSuggestSortedInputIterator_$1 *create_OrgApacheLuceneSearchSuggestSortedInputIterator_$1_initWithOrgApacheLuceneSearchSuggestSortedInputIterator_(OrgApacheLuceneSearchSuggestSortedInputIterator *outer$);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneSearchSuggestSortedInputIterator_$1)

@implementation OrgApacheLuceneSearchSuggestSortedInputIterator

- (instancetype)initWithOrgApacheLuceneSearchSuggestInputIterator:(id<OrgApacheLuceneSearchSuggestInputIterator>)source {
  OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_(self, source);
  return self;
}

- (instancetype)initWithOrgApacheLuceneSearchSuggestInputIterator:(id<OrgApacheLuceneSearchSuggestInputIterator>)source
                                           withJavaUtilComparator:(id<JavaUtilComparator>)comparator {
  OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_withJavaUtilComparator_(self, source, comparator);
  return self;
}

- (OrgApacheLuceneUtilBytesRef *)next {
  jboolean success = false;
  if (done_) {
    return nil;
  }
  @try {
    OrgApacheLuceneStoreByteArrayDataInput *input = create_OrgApacheLuceneStoreByteArrayDataInput_init();
    if ([((OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *) nil_chk(reader_)) readWithOrgApacheLuceneUtilBytesRefBuilder:scratch_]) {
      OrgApacheLuceneUtilBytesRef *bytes = [((OrgApacheLuceneUtilBytesRefBuilder *) nil_chk(scratch_)) get];
      weight_ = [self decodeWithOrgApacheLuceneUtilBytesRef:bytes withOrgApacheLuceneStoreByteArrayDataInput:input];
      if (hasPayloads_) {
        JreStrongAssign(&payload_, [self decodePayloadWithOrgApacheLuceneUtilBytesRef:bytes withOrgApacheLuceneStoreByteArrayDataInput:input]);
      }
      if (hasContexts_) {
        JreStrongAssign(&contexts_, [self decodeContextsWithOrgApacheLuceneUtilBytesRef:bytes withOrgApacheLuceneStoreByteArrayDataInput:input]);
      }
      success = true;
      return bytes;
    }
    OrgApacheLuceneSearchSuggestSortedInputIterator_close(self);
    success = done_ = true;
    return nil;
  }
  @finally {
    if (!success) {
      done_ = true;
      OrgApacheLuceneSearchSuggestSortedInputIterator_close(self);
    }
  }
}

- (jlong)weight {
  return weight_;
}

- (OrgApacheLuceneUtilBytesRef *)payload {
  if (hasPayloads_) {
    return payload_;
  }
  return nil;
}

- (jboolean)hasPayloads {
  return hasPayloads_;
}

- (id<JavaUtilSet>)contexts {
  return contexts_;
}

- (jboolean)hasContexts {
  return hasContexts_;
}

- (OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *)sort {
  return OrgApacheLuceneSearchSuggestSortedInputIterator_sort(self);
}

- (void)close {
  OrgApacheLuceneSearchSuggestSortedInputIterator_close(self);
}

- (void)encodeWithOrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter:(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *)writer
                           withOrgApacheLuceneStoreByteArrayDataOutput:(OrgApacheLuceneStoreByteArrayDataOutput *)output
                                                         withByteArray:(IOSByteArray *)buffer
                                       withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)spare
                                       withOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)payload
                                                       withJavaUtilSet:(id<JavaUtilSet>)contexts
                                                              withLong:(jlong)weight {
  jint requiredLength = ((OrgApacheLuceneUtilBytesRef *) nil_chk(spare))->length_ + 8 + ((hasPayloads_) ? 2 + ((OrgApacheLuceneUtilBytesRef *) nil_chk(payload))->length_ : 0);
  if (hasContexts_) {
    for (OrgApacheLuceneUtilBytesRef * __strong ctx in nil_chk(contexts)) {
      requiredLength += 2 + ((OrgApacheLuceneUtilBytesRef *) nil_chk(ctx))->length_;
    }
    requiredLength += 2;
  }
  if (requiredLength >= ((IOSByteArray *) nil_chk(buffer))->size_) {
    buffer = OrgApacheLuceneUtilArrayUtil_growWithByteArray_withInt_(buffer, requiredLength);
  }
  [((OrgApacheLuceneStoreByteArrayDataOutput *) nil_chk(output)) resetWithByteArray:buffer];
  [output writeBytesWithByteArray:spare->bytes_ withInt:spare->offset_ withInt:spare->length_];
  if (hasContexts_) {
    for (OrgApacheLuceneUtilBytesRef * __strong ctx in nil_chk(contexts)) {
      [output writeBytesWithByteArray:((OrgApacheLuceneUtilBytesRef *) nil_chk(ctx))->bytes_ withInt:ctx->offset_ withInt:ctx->length_];
      [output writeShortWithShort:(jshort) ctx->length_];
    }
    [output writeShortWithShort:(jshort) [contexts size]];
  }
  if (hasPayloads_) {
    [output writeBytesWithByteArray:((OrgApacheLuceneUtilBytesRef *) nil_chk(payload))->bytes_ withInt:payload->offset_ withInt:payload->length_];
    [output writeShortWithShort:(jshort) payload->length_];
  }
  [output writeLongWithLong:weight];
  [((OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *) nil_chk(writer)) writeWithByteArray:buffer withInt:0 withInt:[output getPosition]];
}

- (jlong)decodeWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)scratch
    withOrgApacheLuceneStoreByteArrayDataInput:(OrgApacheLuceneStoreByteArrayDataInput *)tmpInput {
  [((OrgApacheLuceneStoreByteArrayDataInput *) nil_chk(tmpInput)) resetWithByteArray:((OrgApacheLuceneUtilBytesRef *) nil_chk(scratch))->bytes_];
  [tmpInput skipBytesWithLong:scratch->length_ - 8];
  scratch->length_ -= 8;
  return [tmpInput readLong];
}

- (id<JavaUtilSet>)decodeContextsWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)scratch
                      withOrgApacheLuceneStoreByteArrayDataInput:(OrgApacheLuceneStoreByteArrayDataInput *)tmpInput {
  [((OrgApacheLuceneStoreByteArrayDataInput *) nil_chk(tmpInput)) resetWithByteArray:((OrgApacheLuceneUtilBytesRef *) nil_chk(scratch))->bytes_];
  [tmpInput skipBytesWithLong:scratch->length_ - 2];
  jshort ctxSetSize = [tmpInput readShort];
  scratch->length_ -= 2;
  id<JavaUtilSet> contextSet = create_JavaUtilHashSet_init();
  for (jshort i = 0; i < ctxSetSize; i++) {
    [tmpInput setPositionWithInt:scratch->length_ - 2];
    jshort curContextLength = [tmpInput readShort];
    scratch->length_ -= 2;
    [tmpInput setPositionWithInt:scratch->length_ - curContextLength];
    OrgApacheLuceneUtilBytesRef *contextSpare = create_OrgApacheLuceneUtilBytesRef_initWithInt_(curContextLength);
    [tmpInput readBytesWithByteArray:contextSpare->bytes_ withInt:0 withInt:curContextLength];
    contextSpare->length_ = curContextLength;
    [contextSet addWithId:contextSpare];
    scratch->length_ -= curContextLength;
  }
  return contextSet;
}

- (OrgApacheLuceneUtilBytesRef *)decodePayloadWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)scratch
                                   withOrgApacheLuceneStoreByteArrayDataInput:(OrgApacheLuceneStoreByteArrayDataInput *)tmpInput {
  [((OrgApacheLuceneStoreByteArrayDataInput *) nil_chk(tmpInput)) resetWithByteArray:((OrgApacheLuceneUtilBytesRef *) nil_chk(scratch))->bytes_];
  [tmpInput skipBytesWithLong:scratch->length_ - 2];
  jshort payloadLength = [tmpInput readShort];
  [tmpInput setPositionWithInt:scratch->length_ - 2 - payloadLength];
  OrgApacheLuceneUtilBytesRef *payloadScratch = create_OrgApacheLuceneUtilBytesRef_initWithInt_(payloadLength);
  [tmpInput readBytesWithByteArray:payloadScratch->bytes_ withInt:0 withInt:payloadLength];
  payloadScratch->length_ = payloadLength;
  scratch->length_ -= 2;
  scratch->length_ -= payloadLength;
  return payloadScratch;
}

- (void)dealloc {
  RELEASE_(source_);
  RELEASE_(tempInput_);
  RELEASE_(tempSorted_);
  RELEASE_(reader_);
  RELEASE_(comparator_);
  RELEASE_(scratch_);
  RELEASE_(payload_);
  RELEASE_(contexts_);
  RELEASE_(tieBreakByCostComparator_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneSearchSuggestInputIterator:", "SortedInputIterator", NULL, 0x1, "Ljava.io.IOException;", NULL },
    { "initWithOrgApacheLuceneSearchSuggestInputIterator:withJavaUtilComparator:", "SortedInputIterator", NULL, 0x1, "Ljava.io.IOException;", "(Lorg/apache/lucene/search/suggest/InputIterator;Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;)V" },
    { "next", NULL, "Lorg.apache.lucene.util.BytesRef;", 0x1, "Ljava.io.IOException;", NULL },
    { "weight", NULL, "J", 0x1, NULL, NULL },
    { "payload", NULL, "Lorg.apache.lucene.util.BytesRef;", 0x1, NULL, NULL },
    { "hasPayloads", NULL, "Z", 0x1, NULL, NULL },
    { "contexts", NULL, "Ljava.util.Set;", 0x1, NULL, "()Ljava/util/Set<Lorg/apache/lucene/util/BytesRef;>;" },
    { "hasContexts", NULL, "Z", 0x1, NULL, NULL },
    { "sort", NULL, "Lorg.apache.lucene.util.OfflineSorter$ByteSequencesReader;", 0x2, "Ljava.io.IOException;", NULL },
    { "close", NULL, "V", 0x2, "Ljava.io.IOException;", NULL },
    { "encodeWithOrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter:withOrgApacheLuceneStoreByteArrayDataOutput:withByteArray:withOrgApacheLuceneUtilBytesRef:withOrgApacheLuceneUtilBytesRef:withJavaUtilSet:withLong:", "encode", "V", 0x4, "Ljava.io.IOException;", "(Lorg/apache/lucene/util/OfflineSorter$ByteSequencesWriter;Lorg/apache/lucene/store/ByteArrayDataOutput;[BLorg/apache/lucene/util/BytesRef;Lorg/apache/lucene/util/BytesRef;Ljava/util/Set<Lorg/apache/lucene/util/BytesRef;>;J)V" },
    { "decodeWithOrgApacheLuceneUtilBytesRef:withOrgApacheLuceneStoreByteArrayDataInput:", "decode", "J", 0x4, NULL, NULL },
    { "decodeContextsWithOrgApacheLuceneUtilBytesRef:withOrgApacheLuceneStoreByteArrayDataInput:", "decodeContexts", "Ljava.util.Set;", 0x4, NULL, "(Lorg/apache/lucene/util/BytesRef;Lorg/apache/lucene/store/ByteArrayDataInput;)Ljava/util/Set<Lorg/apache/lucene/util/BytesRef;>;" },
    { "decodePayloadWithOrgApacheLuceneUtilBytesRef:withOrgApacheLuceneStoreByteArrayDataInput:", "decodePayload", "Lorg.apache.lucene.util.BytesRef;", 0x4, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "source_", NULL, 0x12, "Lorg.apache.lucene.search.suggest.InputIterator;", NULL, NULL, .constantValue.asLong = 0 },
    { "tempInput_", NULL, 0x2, "Lorg.lukhnos.portmobile.file.Path;", NULL, NULL, .constantValue.asLong = 0 },
    { "tempSorted_", NULL, 0x2, "Lorg.lukhnos.portmobile.file.Path;", NULL, NULL, .constantValue.asLong = 0 },
    { "reader_", NULL, 0x12, "Lorg.apache.lucene.util.OfflineSorter$ByteSequencesReader;", NULL, NULL, .constantValue.asLong = 0 },
    { "comparator_", NULL, 0x12, "Ljava.util.Comparator;", NULL, "Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;", .constantValue.asLong = 0 },
    { "hasPayloads_", NULL, 0x12, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "hasContexts_", NULL, 0x12, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "done_", NULL, 0x2, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "weight_", NULL, 0x2, "J", NULL, NULL, .constantValue.asLong = 0 },
    { "scratch_", NULL, 0x12, "Lorg.apache.lucene.util.BytesRefBuilder;", NULL, NULL, .constantValue.asLong = 0 },
    { "payload_", NULL, 0x2, "Lorg.apache.lucene.util.BytesRef;", NULL, NULL, .constantValue.asLong = 0 },
    { "contexts_", NULL, 0x2, "Ljava.util.Set;", NULL, "Ljava/util/Set<Lorg/apache/lucene/util/BytesRef;>;", .constantValue.asLong = 0 },
    { "tieBreakByCostComparator_", NULL, 0x12, "Ljava.util.Comparator;", NULL, "Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;", .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestSortedInputIterator = { 2, "SortedInputIterator", "org.apache.lucene.search.suggest", NULL, 0x1, 14, methods, 13, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneSearchSuggestSortedInputIterator;
}

@end

void OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_(OrgApacheLuceneSearchSuggestSortedInputIterator *self, id<OrgApacheLuceneSearchSuggestInputIterator> source) {
  OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_withJavaUtilComparator_(self, source, OrgApacheLuceneUtilBytesRef_getUTF8SortedAsUnicodeComparator());
}

OrgApacheLuceneSearchSuggestSortedInputIterator *new_OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_(id<OrgApacheLuceneSearchSuggestInputIterator> source) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestSortedInputIterator, initWithOrgApacheLuceneSearchSuggestInputIterator_, source)
}

OrgApacheLuceneSearchSuggestSortedInputIterator *create_OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_(id<OrgApacheLuceneSearchSuggestInputIterator> source) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestSortedInputIterator, initWithOrgApacheLuceneSearchSuggestInputIterator_, source)
}

void OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_withJavaUtilComparator_(OrgApacheLuceneSearchSuggestSortedInputIterator *self, id<OrgApacheLuceneSearchSuggestInputIterator> source, id<JavaUtilComparator> comparator) {
  NSObject_init(self);
  self->done_ = false;
  JreStrongAssignAndConsume(&self->scratch_, new_OrgApacheLuceneUtilBytesRefBuilder_init());
  JreStrongAssignAndConsume(&self->payload_, new_OrgApacheLuceneUtilBytesRef_init());
  JreStrongAssign(&self->contexts_, nil);
  JreStrongAssignAndConsume(&self->tieBreakByCostComparator_, new_OrgApacheLuceneSearchSuggestSortedInputIterator_$1_initWithOrgApacheLuceneSearchSuggestSortedInputIterator_(self));
  self->hasPayloads_ = [((id<OrgApacheLuceneSearchSuggestInputIterator>) nil_chk(source)) hasPayloads];
  self->hasContexts_ = [source hasContexts];
  JreStrongAssign(&self->source_, source);
  JreStrongAssign(&self->comparator_, comparator);
  JreStrongAssign(&self->reader_, OrgApacheLuceneSearchSuggestSortedInputIterator_sort(self));
}

OrgApacheLuceneSearchSuggestSortedInputIterator *new_OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_withJavaUtilComparator_(id<OrgApacheLuceneSearchSuggestInputIterator> source, id<JavaUtilComparator> comparator) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestSortedInputIterator, initWithOrgApacheLuceneSearchSuggestInputIterator_withJavaUtilComparator_, source, comparator)
}

OrgApacheLuceneSearchSuggestSortedInputIterator *create_OrgApacheLuceneSearchSuggestSortedInputIterator_initWithOrgApacheLuceneSearchSuggestInputIterator_withJavaUtilComparator_(id<OrgApacheLuceneSearchSuggestInputIterator> source, id<JavaUtilComparator> comparator) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestSortedInputIterator, initWithOrgApacheLuceneSearchSuggestInputIterator_withJavaUtilComparator_, source, comparator)
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *OrgApacheLuceneSearchSuggestSortedInputIterator_sort(OrgApacheLuceneSearchSuggestSortedInputIterator *self) {
  NSString *prefix = [[self getClass] getSimpleName];
  OrgLukhnosPortmobileFilePath *directory = OrgApacheLuceneUtilOfflineSorter_defaultTempDir();
  JreStrongAssign(&self->tempInput_, OrgLukhnosPortmobileFileFiles_createTempFileWithOrgLukhnosPortmobileFilePath_withNSString_withNSString_(directory, prefix, @".input"));
  JreStrongAssign(&self->tempSorted_, OrgLukhnosPortmobileFileFiles_createTempFileWithOrgLukhnosPortmobileFilePath_withNSString_withNSString_(directory, prefix, @".sorted"));
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *writer = create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithOrgLukhnosPortmobileFilePath_(self->tempInput_);
  jboolean success = false;
  @try {
    OrgApacheLuceneUtilBytesRef *spare;
    IOSByteArray *buffer = [IOSByteArray arrayWithLength:0];
    OrgApacheLuceneStoreByteArrayDataOutput *output = create_OrgApacheLuceneStoreByteArrayDataOutput_initWithByteArray_(buffer);
    while ((spare = [((id<OrgApacheLuceneSearchSuggestInputIterator>) nil_chk(self->source_)) next]) != nil) {
      [self encodeWithOrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter:writer withOrgApacheLuceneStoreByteArrayDataOutput:output withByteArray:buffer withOrgApacheLuceneUtilBytesRef:spare withOrgApacheLuceneUtilBytesRef:[self->source_ payload] withJavaUtilSet:[self->source_ contexts] withLong:[self->source_ weight]];
    }
    [writer close];
    [create_OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_(self->tieBreakByCostComparator_) sortWithOrgLukhnosPortmobileFilePath:self->tempInput_ withOrgLukhnosPortmobileFilePath:self->tempSorted_];
    OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *reader = create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithOrgLukhnosPortmobileFilePath_(self->tempSorted_);
    success = true;
    return reader;
  }
  @finally {
    if (success) {
      OrgApacheLuceneUtilIOUtils_closeWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ writer } count:1 type:JavaIoCloseable_class_()]);
    }
    else {
      @try {
        OrgApacheLuceneUtilIOUtils_closeWhileHandlingExceptionWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ writer } count:1 type:JavaIoCloseable_class_()]);
      }
      @finally {
        OrgApacheLuceneSearchSuggestSortedInputIterator_close(self);
      }
    }
  }
}

void OrgApacheLuceneSearchSuggestSortedInputIterator_close(OrgApacheLuceneSearchSuggestSortedInputIterator *self) {
  jboolean success = false;
  @try {
    OrgApacheLuceneUtilIOUtils_closeWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ self->reader_ } count:1 type:JavaIoCloseable_class_()]);
    success = true;
  }
  @finally {
    if (success) {
      OrgApacheLuceneUtilIOUtils_deleteFilesIfExistWithOrgLukhnosPortmobileFilePathArray_([IOSObjectArray arrayWithObjects:(id[]){ self->tempInput_, self->tempSorted_ } count:2 type:OrgLukhnosPortmobileFilePath_class_()]);
    }
    else {
      OrgApacheLuceneUtilIOUtils_deleteFilesIgnoringExceptionsWithOrgLukhnosPortmobileFilePathArray_([IOSObjectArray arrayWithObjects:(id[]){ self->tempInput_, self->tempSorted_ } count:2 type:OrgLukhnosPortmobileFilePath_class_()]);
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestSortedInputIterator)

@implementation OrgApacheLuceneSearchSuggestSortedInputIterator_$1

- (jint)compareWithId:(OrgApacheLuceneUtilBytesRef *)left
               withId:(OrgApacheLuceneUtilBytesRef *)right {
  JreStrongAssign(&((OrgApacheLuceneUtilBytesRef *) nil_chk(leftScratch_))->bytes_, ((OrgApacheLuceneUtilBytesRef *) nil_chk(left))->bytes_);
  leftScratch_->offset_ = left->offset_;
  leftScratch_->length_ = left->length_;
  JreStrongAssign(&((OrgApacheLuceneUtilBytesRef *) nil_chk(rightScratch_))->bytes_, ((OrgApacheLuceneUtilBytesRef *) nil_chk(right))->bytes_);
  rightScratch_->offset_ = right->offset_;
  rightScratch_->length_ = right->length_;
  jlong leftCost = [this$0_ decodeWithOrgApacheLuceneUtilBytesRef:leftScratch_ withOrgApacheLuceneStoreByteArrayDataInput:input_];
  jlong rightCost = [this$0_ decodeWithOrgApacheLuceneUtilBytesRef:rightScratch_ withOrgApacheLuceneStoreByteArrayDataInput:input_];
  if (this$0_->hasPayloads_) {
    [this$0_ decodePayloadWithOrgApacheLuceneUtilBytesRef:leftScratch_ withOrgApacheLuceneStoreByteArrayDataInput:input_];
    [this$0_ decodePayloadWithOrgApacheLuceneUtilBytesRef:rightScratch_ withOrgApacheLuceneStoreByteArrayDataInput:input_];
  }
  if (this$0_->hasContexts_) {
    [this$0_ decodeContextsWithOrgApacheLuceneUtilBytesRef:leftScratch_ withOrgApacheLuceneStoreByteArrayDataInput:input_];
    [this$0_ decodeContextsWithOrgApacheLuceneUtilBytesRef:rightScratch_ withOrgApacheLuceneStoreByteArrayDataInput:input_];
  }
  jint cmp = [((id<JavaUtilComparator>) nil_chk(this$0_->comparator_)) compareWithId:leftScratch_ withId:rightScratch_];
  if (cmp != 0) {
    return cmp;
  }
  return JavaLangLong_compareWithLong_withLong_(leftCost, rightCost);
}

- (instancetype)initWithOrgApacheLuceneSearchSuggestSortedInputIterator:(OrgApacheLuceneSearchSuggestSortedInputIterator *)outer$ {
  OrgApacheLuceneSearchSuggestSortedInputIterator_$1_initWithOrgApacheLuceneSearchSuggestSortedInputIterator_(self, outer$);
  return self;
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(leftScratch_);
  RELEASE_(rightScratch_);
  RELEASE_(input_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "compareWithId:withId:", "compare", "I", 0x1, NULL, NULL },
    { "initWithOrgApacheLuceneSearchSuggestSortedInputIterator:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.apache.lucene.search.suggest.SortedInputIterator;", NULL, NULL, .constantValue.asLong = 0 },
    { "leftScratch_", NULL, 0x12, "Lorg.apache.lucene.util.BytesRef;", NULL, NULL, .constantValue.asLong = 0 },
    { "rightScratch_", NULL, 0x12, "Lorg.apache.lucene.util.BytesRef;", NULL, NULL, .constantValue.asLong = 0 },
    { "input_", NULL, 0x12, "Lorg.apache.lucene.store.ByteArrayDataInput;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestSortedInputIterator_$1 = { 2, "", "org.apache.lucene.search.suggest", "SortedInputIterator", 0x8008, 2, methods, 4, fields, 0, NULL, 0, NULL, NULL, "Ljava/lang/Object;Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;" };
  return &_OrgApacheLuceneSearchSuggestSortedInputIterator_$1;
}

@end

void OrgApacheLuceneSearchSuggestSortedInputIterator_$1_initWithOrgApacheLuceneSearchSuggestSortedInputIterator_(OrgApacheLuceneSearchSuggestSortedInputIterator_$1 *self, OrgApacheLuceneSearchSuggestSortedInputIterator *outer$) {
  JreStrongAssign(&self->this$0_, outer$);
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->leftScratch_, new_OrgApacheLuceneUtilBytesRef_init());
  JreStrongAssignAndConsume(&self->rightScratch_, new_OrgApacheLuceneUtilBytesRef_init());
  JreStrongAssignAndConsume(&self->input_, new_OrgApacheLuceneStoreByteArrayDataInput_init());
}

OrgApacheLuceneSearchSuggestSortedInputIterator_$1 *new_OrgApacheLuceneSearchSuggestSortedInputIterator_$1_initWithOrgApacheLuceneSearchSuggestSortedInputIterator_(OrgApacheLuceneSearchSuggestSortedInputIterator *outer$) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestSortedInputIterator_$1, initWithOrgApacheLuceneSearchSuggestSortedInputIterator_, outer$)
}

OrgApacheLuceneSearchSuggestSortedInputIterator_$1 *create_OrgApacheLuceneSearchSuggestSortedInputIterator_$1_initWithOrgApacheLuceneSearchSuggestSortedInputIterator_(OrgApacheLuceneSearchSuggestSortedInputIterator *outer$) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestSortedInputIterator_$1, initWithOrgApacheLuceneSearchSuggestSortedInputIterator_, outer$)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestSortedInputIterator_$1)
