//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./suggest/src/java/org/apache/lucene/search/suggest/document/CompletionFieldsProducer.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/Closeable.h"
#include "java/lang/Throwable.h"
#include "java/util/ArrayList.h"
#include "java/util/Collection.h"
#include "java/util/Collections.h"
#include "java/util/HashMap.h"
#include "java/util/Iterator.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "java/util/Set.h"
#include "org/apache/lucene/codecs/CodecUtil.h"
#include "org/apache/lucene/codecs/FieldsProducer.h"
#include "org/apache/lucene/codecs/PostingsFormat.h"
#include "org/apache/lucene/index/FieldInfo.h"
#include "org/apache/lucene/index/FieldInfos.h"
#include "org/apache/lucene/index/IndexFileNames.h"
#include "org/apache/lucene/index/SegmentInfo.h"
#include "org/apache/lucene/index/SegmentReadState.h"
#include "org/apache/lucene/index/Terms.h"
#include "org/apache/lucene/search/suggest/document/CompletionFieldsProducer.h"
#include "org/apache/lucene/search/suggest/document/CompletionPostingsFormat.h"
#include "org/apache/lucene/search/suggest/document/CompletionTerms.h"
#include "org/apache/lucene/search/suggest/document/CompletionsTermsReader.h"
#include "org/apache/lucene/store/ChecksumIndexInput.h"
#include "org/apache/lucene/store/Directory.h"
#include "org/apache/lucene/store/IOContext.h"
#include "org/apache/lucene/store/IndexInput.h"
#include "org/apache/lucene/util/Accountable.h"
#include "org/apache/lucene/util/Accountables.h"
#include "org/apache/lucene/util/IOUtils.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/search/suggest/document/CompletionFieldsProducer must not be compiled with ARC (-fobjc-arc)"
#endif

@interface OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer () {
 @public
  OrgApacheLuceneCodecsFieldsProducer *delegateFieldsProducer_;
  id<JavaUtilMap> readers_;
  OrgApacheLuceneStoreIndexInput *dictIn_;
}

- (instancetype)initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer:(OrgApacheLuceneCodecsFieldsProducer *)delegateFieldsProducer
                                                          withJavaUtilMap:(id<JavaUtilMap>)readers;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer, delegateFieldsProducer_, OrgApacheLuceneCodecsFieldsProducer *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer, readers_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer, dictIn_, OrgApacheLuceneStoreIndexInput *)

__attribute__((unused)) static void OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *self, OrgApacheLuceneCodecsFieldsProducer *delegateFieldsProducer, id<JavaUtilMap> readers);

__attribute__((unused)) static OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *new_OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_(OrgApacheLuceneCodecsFieldsProducer *delegateFieldsProducer, id<JavaUtilMap> readers) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *create_OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_(OrgApacheLuceneCodecsFieldsProducer *delegateFieldsProducer, id<JavaUtilMap> readers);

@implementation OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer

- (instancetype)initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer:(OrgApacheLuceneCodecsFieldsProducer *)delegateFieldsProducer
                                                          withJavaUtilMap:(id<JavaUtilMap>)readers {
  OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_(self, delegateFieldsProducer, readers);
  return self;
}

- (instancetype)initPackagePrivateWithOrgApacheLuceneIndexSegmentReadState:(OrgApacheLuceneIndexSegmentReadState *)state {
  OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneIndexSegmentReadState_(self, state);
  return self;
}

- (void)close {
  jboolean success = false;
  @try {
    [((OrgApacheLuceneCodecsFieldsProducer *) nil_chk(delegateFieldsProducer_)) close];
    OrgApacheLuceneUtilIOUtils_closeWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ dictIn_ } count:1 type:JavaIoCloseable_class_()]);
    success = true;
  }
  @finally {
    if (success == false) {
      OrgApacheLuceneUtilIOUtils_closeWhileHandlingExceptionWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ delegateFieldsProducer_, dictIn_ } count:2 type:JavaIoCloseable_class_()]);
    }
  }
}

- (void)checkIntegrity {
  [((OrgApacheLuceneCodecsFieldsProducer *) nil_chk(delegateFieldsProducer_)) checkIntegrity];
}

- (OrgApacheLuceneCodecsFieldsProducer *)getMergeInstance {
  return create_OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_(delegateFieldsProducer_, readers_);
}

- (jlong)ramBytesUsed {
  jlong ramBytesUsed = [((OrgApacheLuceneCodecsFieldsProducer *) nil_chk(delegateFieldsProducer_)) ramBytesUsed];
  for (OrgApacheLuceneSearchSuggestDocumentCompletionsTermsReader * __strong reader in nil_chk([((id<JavaUtilMap>) nil_chk(readers_)) values])) {
    ramBytesUsed += [((OrgApacheLuceneSearchSuggestDocumentCompletionsTermsReader *) nil_chk(reader)) ramBytesUsed];
  }
  return ramBytesUsed;
}

- (id<JavaUtilCollection>)getChildResources {
  id<JavaUtilList> accountableList = create_JavaUtilArrayList_init();
  for (id<JavaUtilMap_Entry> __strong readerEntry in nil_chk([((id<JavaUtilMap>) nil_chk(readers_)) entrySet])) {
    [accountableList addWithId:OrgApacheLuceneUtilAccountables_namedAccountableWithNSString_withOrgApacheLuceneUtilAccountable_([((id<JavaUtilMap_Entry>) nil_chk(readerEntry)) getKey], [readerEntry getValue])];
  }
  return JavaUtilCollections_unmodifiableCollectionWithJavaUtilCollection_(accountableList);
}

- (id<JavaUtilIterator>)iterator {
  return [((id<JavaUtilSet>) nil_chk([((id<JavaUtilMap>) nil_chk(readers_)) keySet])) iterator];
}

- (OrgApacheLuceneIndexTerms *)termsWithNSString:(NSString *)field {
  OrgApacheLuceneIndexTerms *terms = JreRetainedLocalValue([((OrgApacheLuceneCodecsFieldsProducer *) nil_chk(delegateFieldsProducer_)) termsWithNSString:field]);
  if (terms == nil) {
    return nil;
  }
  return create_OrgApacheLuceneSearchSuggestDocumentCompletionTerms_initWithOrgApacheLuceneIndexTerms_withOrgApacheLuceneSearchSuggestDocumentCompletionsTermsReader_(terms, [((id<JavaUtilMap>) nil_chk(readers_)) getWithId:field]);
}

- (jint)size {
  return [((id<JavaUtilMap>) nil_chk(readers_)) size];
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf);
}

- (void)dealloc {
  RELEASE_(delegateFieldsProducer_);
  RELEASE_(readers_);
  RELEASE_(dictIn_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x2, -1, 0, -1, 1, -1, -1 },
    { NULL, NULL, 0x0, -1, 2, 3, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, 3, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, 3, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneCodecsFieldsProducer;", 0x1, -1, -1, 3, -1, -1, -1 },
    { NULL, "J", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LJavaUtilCollection;", 0x1, -1, -1, -1, 4, -1, -1 },
    { NULL, "LJavaUtilIterator;", 0x1, -1, -1, -1, 5, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTerms;", 0x1, 6, 7, 3, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer:withJavaUtilMap:);
  methods[1].selector = @selector(initPackagePrivateWithOrgApacheLuceneIndexSegmentReadState:);
  methods[2].selector = @selector(close);
  methods[3].selector = @selector(checkIntegrity);
  methods[4].selector = @selector(getMergeInstance);
  methods[5].selector = @selector(ramBytesUsed);
  methods[6].selector = @selector(getChildResources);
  methods[7].selector = @selector(iterator);
  methods[8].selector = @selector(termsWithNSString:);
  methods[9].selector = @selector(size);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "delegateFieldsProducer_", "LOrgApacheLuceneCodecsFieldsProducer;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "readers_", "LJavaUtilMap;", .constantValue.asLong = 0, 0x2, -1, -1, 8, -1 },
    { "dictIn_", "LOrgApacheLuceneStoreIndexInput;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneCodecsFieldsProducer;LJavaUtilMap;", "(Lorg/apache/lucene/codecs/FieldsProducer;Ljava/util/Map<Ljava/lang/String;Lorg/apache/lucene/search/suggest/document/CompletionsTermsReader;>;)V", "LOrgApacheLuceneIndexSegmentReadState;", "LJavaIoIOException;", "()Ljava/util/Collection<Lorg/apache/lucene/util/Accountable;>;", "()Ljava/util/Iterator<Ljava/lang/String;>;", "terms", "LNSString;", "Ljava/util/Map<Ljava/lang/String;Lorg/apache/lucene/search/suggest/document/CompletionsTermsReader;>;" };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer = { "CompletionFieldsProducer", "org.apache.lucene.search.suggest.document", ptrTable, methods, fields, 7, 0x10, 10, 3, -1, -1, -1, -1, -1 };
  return &_OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer;
}

@end

void OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *self, OrgApacheLuceneCodecsFieldsProducer *delegateFieldsProducer, id<JavaUtilMap> readers) {
  OrgApacheLuceneCodecsFieldsProducer_init(self);
  JreStrongAssign(&self->delegateFieldsProducer_, delegateFieldsProducer);
  JreStrongAssign(&self->readers_, readers);
}

OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *new_OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_(OrgApacheLuceneCodecsFieldsProducer *delegateFieldsProducer, id<JavaUtilMap> readers) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer, initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_, delegateFieldsProducer, readers)
}

OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *create_OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_(OrgApacheLuceneCodecsFieldsProducer *delegateFieldsProducer, id<JavaUtilMap> readers) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer, initPackagePrivateWithOrgApacheLuceneCodecsFieldsProducer_withJavaUtilMap_, delegateFieldsProducer, readers)
}

void OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *self, OrgApacheLuceneIndexSegmentReadState *state) {
  OrgApacheLuceneCodecsFieldsProducer_init(self);
  NSString *indexFile = OrgApacheLuceneIndexIndexFileNames_segmentFileNameWithNSString_withNSString_withNSString_(((OrgApacheLuceneIndexSegmentInfo *) nil_chk(((OrgApacheLuceneIndexSegmentReadState *) nil_chk(state))->segmentInfo_))->name_, state->segmentSuffix_, OrgApacheLuceneSearchSuggestDocumentCompletionPostingsFormat_INDEX_EXTENSION);
  JreStrongAssign(&self->delegateFieldsProducer_, nil);
  jboolean success = false;
  @try {
    OrgApacheLuceneStoreChecksumIndexInput *index = [((OrgApacheLuceneStoreDirectory *) nil_chk(state->directory_)) openChecksumInputWithNSString:indexFile withOrgApacheLuceneStoreIOContext:state->context_];
    JavaLangThrowable *__primaryException1 = nil;
    @try {
      NSString *dictFile = OrgApacheLuceneIndexIndexFileNames_segmentFileNameWithNSString_withNSString_withNSString_(state->segmentInfo_->name_, state->segmentSuffix_, OrgApacheLuceneSearchSuggestDocumentCompletionPostingsFormat_DICT_EXTENSION);
      JreStrongAssign(&self->dictIn_, [state->directory_ openInputWithNSString:dictFile withOrgApacheLuceneStoreIOContext:state->context_]);
      OrgApacheLuceneCodecsCodecUtil_checkIndexHeaderWithOrgApacheLuceneStoreDataInput_withNSString_withInt_withInt_withByteArray_withNSString_(self->dictIn_, OrgApacheLuceneSearchSuggestDocumentCompletionPostingsFormat_CODEC_NAME, OrgApacheLuceneSearchSuggestDocumentCompletionPostingsFormat_COMPLETION_CODEC_VERSION, OrgApacheLuceneSearchSuggestDocumentCompletionPostingsFormat_COMPLETION_VERSION_CURRENT, [state->segmentInfo_ getId], state->segmentSuffix_);
      OrgApacheLuceneCodecsCodecUtil_retrieveChecksumWithOrgApacheLuceneStoreIndexInput_(self->dictIn_);
      OrgApacheLuceneCodecsCodecUtil_checkIndexHeaderWithOrgApacheLuceneStoreDataInput_withNSString_withInt_withInt_withByteArray_withNSString_(index, OrgApacheLuceneSearchSuggestDocumentCompletionPostingsFormat_CODEC_NAME, OrgApacheLuceneSearchSuggestDocumentCompletionPostingsFormat_COMPLETION_CODEC_VERSION, OrgApacheLuceneSearchSuggestDocumentCompletionPostingsFormat_COMPLETION_VERSION_CURRENT, [state->segmentInfo_ getId], state->segmentSuffix_);
      OrgApacheLuceneCodecsPostingsFormat *delegatePostingsFormat = OrgApacheLuceneCodecsPostingsFormat_forNameWithNSString_([((OrgApacheLuceneStoreChecksumIndexInput *) nil_chk(index)) readString]);
      JreStrongAssign(&self->delegateFieldsProducer_, [((OrgApacheLuceneCodecsPostingsFormat *) nil_chk(delegatePostingsFormat)) fieldsProducerWithOrgApacheLuceneIndexSegmentReadState:state]);
      jint numFields = [index readVInt];
      JreStrongAssignAndConsume(&self->readers_, new_JavaUtilHashMap_initWithInt_(numFields));
      for (jint i = 0; i < numFields; i++) {
        jint fieldNumber = [index readVInt];
        jlong offset = [index readVLong];
        jlong minWeight = [index readVLong];
        jlong maxWeight = [index readVLong];
        jbyte type = [index readByte];
        OrgApacheLuceneIndexFieldInfo *fieldInfo = JreRetainedLocalValue([((OrgApacheLuceneIndexFieldInfos *) nil_chk(state->fieldInfos_)) fieldInfoWithInt:fieldNumber]);
        [((id<JavaUtilMap>) nil_chk(self->readers_)) putWithId:((OrgApacheLuceneIndexFieldInfo *) nil_chk(fieldInfo))->name_ withId:create_OrgApacheLuceneSearchSuggestDocumentCompletionsTermsReader_initWithOrgApacheLuceneStoreIndexInput_withLong_withLong_withLong_withByte_(self->dictIn_, offset, minWeight, maxWeight, type)];
      }
      OrgApacheLuceneCodecsCodecUtil_checkFooterWithOrgApacheLuceneStoreChecksumIndexInput_(index);
      success = true;
    }
    @catch (JavaLangThrowable *e) {
      __primaryException1 = e;
      @throw e;
    }
    @finally {
      if (index != nil) {
        if (__primaryException1 != nil) {
          @try {
            [index close];
          }
          @catch (JavaLangThrowable *e) {
            [__primaryException1 addSuppressedWithJavaLangThrowable:e];
          }
        }
        else {
          [index close];
        }
      }
    }
  }
  @finally {
    if (success == false) {
      OrgApacheLuceneUtilIOUtils_closeWhileHandlingExceptionWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ self->delegateFieldsProducer_, self->dictIn_ } count:2 type:JavaIoCloseable_class_()]);
    }
  }
}

OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *new_OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneIndexSegmentReadState *state) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer, initPackagePrivateWithOrgApacheLuceneIndexSegmentReadState_, state)
}

OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer *create_OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer_initPackagePrivateWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneIndexSegmentReadState *state) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer, initPackagePrivateWithOrgApacheLuceneIndexSegmentReadState_, state)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestDocumentCompletionFieldsProducer)
