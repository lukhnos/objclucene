//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./suggest/src/java/org/apache/lucene/search/suggest/document/ContextQuery.java
//

#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/CharSequence.h"
#include "java/lang/Float.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/Integer.h"
#include "java/lang/StringBuilder.h"
#include "java/util/HashMap.h"
#include "java/util/Iterator.h"
#include "java/util/Map.h"
#include "java/util/Set.h"
#include "java/util/TreeSet.h"
#include "org/apache/lucene/index/Term.h"
#include "org/apache/lucene/search/IndexSearcher.h"
#include "org/apache/lucene/search/Weight.h"
#include "org/apache/lucene/search/suggest/BitsProducer.h"
#include "org/apache/lucene/search/suggest/document/CompletionAnalyzer.h"
#include "org/apache/lucene/search/suggest/document/CompletionQuery.h"
#include "org/apache/lucene/search/suggest/document/CompletionWeight.h"
#include "org/apache/lucene/search/suggest/document/ContextQuery.h"
#include "org/apache/lucene/search/suggest/document/ContextSuggestField.h"
#include "org/apache/lucene/util/BytesRef.h"
#include "org/apache/lucene/util/BytesRefBuilder.h"
#include "org/apache/lucene/util/IntsRef.h"
#include "org/apache/lucene/util/IntsRefBuilder.h"
#include "org/apache/lucene/util/automaton/Automata.h"
#include "org/apache/lucene/util/automaton/Automaton.h"
#include "org/apache/lucene/util/automaton/Operations.h"
#include "org/apache/lucene/util/fst/Util.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/search/suggest/document/ContextQuery must not be compiled with ARC (-fobjc-arc)"
#endif

@interface OrgApacheLuceneSearchSuggestDocumentContextQuery () {
 @public
  OrgApacheLuceneUtilIntsRefBuilder *scratch_;
  id<JavaUtilMap> contexts_;
  jboolean matchAllContexts_;
}

+ (OrgApacheLuceneUtilAutomatonAutomaton *)toContextAutomatonWithJavaUtilMap:(id<JavaUtilMap>)contexts
                                                                 withBoolean:(jboolean)matchAllContexts;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentContextQuery, scratch_, OrgApacheLuceneUtilIntsRefBuilder *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentContextQuery, contexts_, id<JavaUtilMap>)

__attribute__((unused)) static OrgApacheLuceneUtilAutomatonAutomaton *OrgApacheLuceneSearchSuggestDocumentContextQuery_toContextAutomatonWithJavaUtilMap_withBoolean_(id<JavaUtilMap> contexts, jboolean matchAllContexts);

/*!
 @brief Holder for context value meta data
 */
@interface OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData : NSObject {
 @public
  /*!
   @brief Boost associated with a
  context value
   */
  jfloat boost_;
  /*!
   @brief flag to indicate whether the context
  value should be treated as an exact
  value or a context prefix
   */
  jboolean exact_;
}

- (instancetype)initWithFloat:(jfloat)boost
                  withBoolean:(jboolean)exact;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData)

__attribute__((unused)) static void OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData_initWithFloat_withBoolean_(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *self, jfloat boost, jboolean exact);

__attribute__((unused)) static OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *new_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData_initWithFloat_withBoolean_(jfloat boost, jboolean exact) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *create_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData_initWithFloat_withBoolean_(jfloat boost, jboolean exact);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData)

@interface OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight : OrgApacheLuceneSearchSuggestDocumentCompletionWeight {
 @public
  id<JavaUtilMap> contextMap_;
  IOSIntArray *contextLengths_;
  OrgApacheLuceneSearchSuggestDocumentCompletionWeight *innerWeight_;
  OrgApacheLuceneUtilBytesRefBuilder *scratch_;
  jfloat currentBoost_;
  id<JavaLangCharSequence> currentContext_;
}

- (instancetype)initWithOrgApacheLuceneSearchSuggestDocumentContextQuery:(OrgApacheLuceneSearchSuggestDocumentContextQuery *)outer$
                 withOrgApacheLuceneSearchSuggestDocumentCompletionQuery:(OrgApacheLuceneSearchSuggestDocumentCompletionQuery *)query
                               withOrgApacheLuceneUtilAutomatonAutomaton:(OrgApacheLuceneUtilAutomatonAutomaton *)automaton
                withOrgApacheLuceneSearchSuggestDocumentCompletionWeight:(OrgApacheLuceneSearchSuggestDocumentCompletionWeight *)innerWeight
                                                         withJavaUtilMap:(id<JavaUtilMap>)contextMap
                                                            withIntArray:(IOSIntArray *)contextLengths;

- (void)setNextMatchWithOrgApacheLuceneUtilIntsRef:(OrgApacheLuceneUtilIntsRef *)pathPrefix;

- (void)setInnerWeightWithOrgApacheLuceneUtilIntsRef:(OrgApacheLuceneUtilIntsRef *)ref
                                             withInt:(jint)offset;

- (id<JavaLangCharSequence>)context;

- (jfloat)boost;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight)

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight, contextMap_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight, contextLengths_, IOSIntArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight, innerWeight_, OrgApacheLuceneSearchSuggestDocumentCompletionWeight *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight, scratch_, OrgApacheLuceneUtilBytesRefBuilder *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight, currentContext_, id<JavaLangCharSequence>)

__attribute__((unused)) static void OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight *self, OrgApacheLuceneSearchSuggestDocumentContextQuery *outer$, OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query, OrgApacheLuceneUtilAutomatonAutomaton *automaton, OrgApacheLuceneSearchSuggestDocumentCompletionWeight *innerWeight, id<JavaUtilMap> contextMap, IOSIntArray *contextLengths);

__attribute__((unused)) static OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight *new_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_(OrgApacheLuceneSearchSuggestDocumentContextQuery *outer$, OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query, OrgApacheLuceneUtilAutomatonAutomaton *automaton, OrgApacheLuceneSearchSuggestDocumentCompletionWeight *innerWeight, id<JavaUtilMap> contextMap, IOSIntArray *contextLengths) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight *create_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_(OrgApacheLuceneSearchSuggestDocumentContextQuery *outer$, OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query, OrgApacheLuceneUtilAutomatonAutomaton *automaton, OrgApacheLuceneSearchSuggestDocumentCompletionWeight *innerWeight, id<JavaUtilMap> contextMap, IOSIntArray *contextLengths);

__attribute__((unused)) static void OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_setInnerWeightWithOrgApacheLuceneUtilIntsRef_withInt_(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight *self, OrgApacheLuceneUtilIntsRef *ref, jint offset);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight)

@implementation OrgApacheLuceneSearchSuggestDocumentContextQuery

- (instancetype)initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery:(OrgApacheLuceneSearchSuggestDocumentCompletionQuery *)query {
  OrgApacheLuceneSearchSuggestDocumentContextQuery_initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery_(self, query);
  return self;
}

- (void)addContextWithJavaLangCharSequence:(id<JavaLangCharSequence>)context {
  [self addContextWithJavaLangCharSequence:context withFloat:1.0f withBoolean:true];
}

- (void)addContextWithJavaLangCharSequence:(id<JavaLangCharSequence>)context
                                 withFloat:(jfloat)boost {
  [self addContextWithJavaLangCharSequence:context withFloat:boost withBoolean:true];
}

- (void)addContextWithJavaLangCharSequence:(id<JavaLangCharSequence>)context
                                 withFloat:(jfloat)boost
                               withBoolean:(jboolean)exact {
  if (boost < 0.0f) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(@"'boost' must be >= 0");
  }
  for (jint i = 0; i < [((id<JavaLangCharSequence>) nil_chk(context)) java_length]; i++) {
    if (OrgApacheLuceneSearchSuggestDocumentContextSuggestField_CONTEXT_SEPARATOR == [context charAtWithInt:i]) {
      @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$@$$$I$", @"Illegal value [", context, @"] UTF-16 codepoint [0x", JavaLangInteger_toHexStringWithInt_((jint) [context charAtWithInt:i]), @"] at position ", i, @" is a reserved character"));
    }
  }
  [((id<JavaUtilMap>) nil_chk(contexts_)) putWithId:OrgApacheLuceneUtilIntsRef_deepCopyOfWithOrgApacheLuceneUtilIntsRef_(OrgApacheLuceneUtilFstUtil_toIntsRefWithOrgApacheLuceneUtilBytesRef_withOrgApacheLuceneUtilIntsRefBuilder_(create_OrgApacheLuceneUtilBytesRef_initWithJavaLangCharSequence_(context), scratch_)) withId:create_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData_initWithFloat_withBoolean_(boost, exact)];
}

- (void)addAllContexts {
  matchAllContexts_ = true;
}

- (NSString *)toStringWithNSString:(NSString *)field {
  JavaLangStringBuilder *buffer = create_JavaLangStringBuilder_init();
  OrgApacheLuceneUtilBytesRefBuilder *scratch = create_OrgApacheLuceneUtilBytesRefBuilder_init();
  for (OrgApacheLuceneUtilIntsRef * __strong context in nil_chk([((id<JavaUtilMap>) nil_chk(contexts_)) keySet])) {
    if ([buffer java_length] != 0) {
      [buffer appendWithNSString:@","];
    }
    else {
      [buffer appendWithNSString:@"contexts"];
      [buffer appendWithNSString:@":["];
    }
    [buffer appendWithNSString:[((OrgApacheLuceneUtilBytesRef *) nil_chk(OrgApacheLuceneUtilFstUtil_toBytesRefWithOrgApacheLuceneUtilIntsRef_withOrgApacheLuceneUtilBytesRefBuilder_(context, scratch))) utf8ToString]];
    OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *metaData = JreRetainedLocalValue([((id<JavaUtilMap>) nil_chk(contexts_)) getWithId:context]);
    if (((OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *) nil_chk(metaData))->exact_ == false) {
      [buffer appendWithNSString:@"*"];
    }
    if (metaData->boost_ != 0) {
      [buffer appendWithNSString:@"^"];
      [buffer appendWithNSString:JavaLangFloat_toStringWithFloat_(metaData->boost_)];
    }
  }
  if ([buffer java_length] != 0) {
    [buffer appendWithNSString:@"]"];
    [buffer appendWithNSString:@","];
  }
  return JreStrcat("$$", [buffer description], [((OrgApacheLuceneSearchSuggestDocumentCompletionQuery *) nil_chk(innerQuery_)) toStringWithNSString:field]);
}

- (OrgApacheLuceneSearchWeight *)createWeightWithOrgApacheLuceneSearchIndexSearcher:(OrgApacheLuceneSearchIndexSearcher *)searcher
                                                                        withBoolean:(jboolean)needsScores {
  OrgApacheLuceneSearchSuggestDocumentCompletionWeight *innerWeight = ((OrgApacheLuceneSearchSuggestDocumentCompletionWeight *) cast_chk([((OrgApacheLuceneSearchSuggestDocumentCompletionQuery *) nil_chk(innerQuery_)) createWeightWithOrgApacheLuceneSearchIndexSearcher:searcher withBoolean:needsScores], [OrgApacheLuceneSearchSuggestDocumentCompletionWeight class]));
  OrgApacheLuceneUtilAutomatonAutomaton *optionalSepLabel = OrgApacheLuceneUtilAutomatonOperations_optionalWithOrgApacheLuceneUtilAutomatonAutomaton_(OrgApacheLuceneUtilAutomatonAutomata_makeCharWithInt_(OrgApacheLuceneSearchSuggestDocumentCompletionAnalyzer_SEP_LABEL));
  OrgApacheLuceneUtilAutomatonAutomaton *prefixAutomaton = OrgApacheLuceneUtilAutomatonOperations_concatenateWithOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneUtilAutomatonAutomaton_(optionalSepLabel, [((OrgApacheLuceneSearchSuggestDocumentCompletionWeight *) nil_chk(innerWeight)) getAutomaton]);
  OrgApacheLuceneUtilAutomatonAutomaton *contextsAutomaton = OrgApacheLuceneUtilAutomatonOperations_concatenateWithOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneUtilAutomatonAutomaton_(OrgApacheLuceneSearchSuggestDocumentContextQuery_toContextAutomatonWithJavaUtilMap_withBoolean_(contexts_, matchAllContexts_), prefixAutomaton);
  contextsAutomaton = OrgApacheLuceneUtilAutomatonOperations_determinizeWithOrgApacheLuceneUtilAutomatonAutomaton_withInt_(contextsAutomaton, OrgApacheLuceneUtilAutomatonOperations_DEFAULT_MAX_DETERMINIZED_STATES);
  id<JavaUtilMap> contextMap = create_JavaUtilHashMap_initWithInt_([((id<JavaUtilMap>) nil_chk(contexts_)) size]);
  JavaUtilTreeSet *contextLengths = create_JavaUtilTreeSet_init();
  for (id<JavaUtilMap_Entry> __strong entry_ in nil_chk([((id<JavaUtilMap>) nil_chk(contexts_)) entrySet])) {
    OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *contextMetaData = JreRetainedLocalValue([((id<JavaUtilMap_Entry>) nil_chk(entry_)) getValue]);
    [contextMap putWithId:[entry_ getKey] withId:JavaLangFloat_valueOfWithFloat_(((OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *) nil_chk(contextMetaData))->boost_)];
    [contextLengths addWithId:JavaLangInteger_valueOfWithInt_(((OrgApacheLuceneUtilIntsRef *) nil_chk([entry_ getKey]))->length_)];
  }
  IOSIntArray *contextLengthArray = [IOSIntArray arrayWithLength:[contextLengths size]];
  id<JavaUtilIterator> iterator = [contextLengths descendingIterator];
  for (jint i = 0; [((id<JavaUtilIterator>) nil_chk(iterator)) hasNext]; i++) {
    *IOSIntArray_GetRef(contextLengthArray, i) = [((JavaLangInteger *) nil_chk([iterator next])) intValue];
  }
  return create_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_(self, self, contextsAutomaton, innerWeight, contextMap, contextLengthArray);
}

+ (OrgApacheLuceneUtilAutomatonAutomaton *)toContextAutomatonWithJavaUtilMap:(id<JavaUtilMap>)contexts
                                                                 withBoolean:(jboolean)matchAllContexts {
  return OrgApacheLuceneSearchSuggestDocumentContextQuery_toContextAutomatonWithJavaUtilMap_withBoolean_(contexts, matchAllContexts);
}

- (void)dealloc {
  RELEASE_(scratch_);
  RELEASE_(contexts_);
  RELEASE_(innerQuery_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 1, 2, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 1, 3, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 1, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LNSString;", 0x1, 5, 6, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneSearchWeight;", 0x1, 7, 8, 9, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilAutomatonAutomaton;", 0xa, 10, 11, -1, 12, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery:);
  methods[1].selector = @selector(addContextWithJavaLangCharSequence:);
  methods[2].selector = @selector(addContextWithJavaLangCharSequence:withFloat:);
  methods[3].selector = @selector(addContextWithJavaLangCharSequence:withFloat:withBoolean:);
  methods[4].selector = @selector(addAllContexts);
  methods[5].selector = @selector(toStringWithNSString:);
  methods[6].selector = @selector(createWeightWithOrgApacheLuceneSearchIndexSearcher:withBoolean:);
  methods[7].selector = @selector(toContextAutomatonWithJavaUtilMap:withBoolean:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "scratch_", "LOrgApacheLuceneUtilIntsRefBuilder;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "contexts_", "LJavaUtilMap;", .constantValue.asLong = 0, 0x2, -1, -1, 13, -1 },
    { "matchAllContexts_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "innerQuery_", "LOrgApacheLuceneSearchSuggestDocumentCompletionQuery;", .constantValue.asLong = 0, 0x4, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneSearchSuggestDocumentCompletionQuery;", "addContext", "LJavaLangCharSequence;", "LJavaLangCharSequence;F", "LJavaLangCharSequence;FZ", "toString", "LNSString;", "createWeight", "LOrgApacheLuceneSearchIndexSearcher;Z", "LJavaIoIOException;", "toContextAutomaton", "LJavaUtilMap;Z", "(Ljava/util/Map<Lorg/apache/lucene/util/IntsRef;Lorg/apache/lucene/search/suggest/document/ContextQuery$ContextMetaData;>;Z)Lorg/apache/lucene/util/automaton/Automaton;", "Ljava/util/Map<Lorg/apache/lucene/util/IntsRef;Lorg/apache/lucene/search/suggest/document/ContextQuery$ContextMetaData;>;", "LOrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData;LOrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight;" };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestDocumentContextQuery = { "ContextQuery", "org.apache.lucene.search.suggest.document", ptrTable, methods, fields, 7, 0x1, 8, 4, -1, 14, -1, -1, -1 };
  return &_OrgApacheLuceneSearchSuggestDocumentContextQuery;
}

@end

void OrgApacheLuceneSearchSuggestDocumentContextQuery_initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery_(OrgApacheLuceneSearchSuggestDocumentContextQuery *self, OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query) {
  OrgApacheLuceneSearchSuggestDocumentCompletionQuery_initWithOrgApacheLuceneIndexTerm_withOrgApacheLuceneSearchSuggestBitsProducer_(self, [((OrgApacheLuceneSearchSuggestDocumentCompletionQuery *) nil_chk(query)) getTerm], [query getFilter]);
  JreStrongAssignAndConsume(&self->scratch_, new_OrgApacheLuceneUtilIntsRefBuilder_init());
  self->matchAllContexts_ = false;
  if ([query isKindOfClass:[OrgApacheLuceneSearchSuggestDocumentContextQuery class]]) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$$", @"'query' parameter must not be of type ", [[self java_getClass] getSimpleName]));
  }
  JreStrongAssign(&self->innerQuery_, query);
  JreStrongAssignAndConsume(&self->contexts_, new_JavaUtilHashMap_init());
}

OrgApacheLuceneSearchSuggestDocumentContextQuery *new_OrgApacheLuceneSearchSuggestDocumentContextQuery_initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery_(OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentContextQuery, initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery_, query)
}

OrgApacheLuceneSearchSuggestDocumentContextQuery *create_OrgApacheLuceneSearchSuggestDocumentContextQuery_initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery_(OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentContextQuery, initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery_, query)
}

OrgApacheLuceneUtilAutomatonAutomaton *OrgApacheLuceneSearchSuggestDocumentContextQuery_toContextAutomatonWithJavaUtilMap_withBoolean_(id<JavaUtilMap> contexts, jboolean matchAllContexts) {
  OrgApacheLuceneSearchSuggestDocumentContextQuery_initialize();
  OrgApacheLuceneUtilAutomatonAutomaton *matchAllAutomaton = OrgApacheLuceneUtilAutomatonOperations_repeatWithOrgApacheLuceneUtilAutomatonAutomaton_(OrgApacheLuceneUtilAutomatonAutomata_makeAnyString());
  OrgApacheLuceneUtilAutomatonAutomaton *sep = OrgApacheLuceneUtilAutomatonAutomata_makeCharWithInt_(OrgApacheLuceneSearchSuggestDocumentContextSuggestField_CONTEXT_SEPARATOR);
  if (matchAllContexts || [((id<JavaUtilMap>) nil_chk(contexts)) size] == 0) {
    return OrgApacheLuceneUtilAutomatonOperations_concatenateWithOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneUtilAutomatonAutomaton_(matchAllAutomaton, sep);
  }
  else {
    OrgApacheLuceneUtilAutomatonAutomaton *contextsAutomaton = nil;
    for (id<JavaUtilMap_Entry> __strong entry_ in nil_chk([((id<JavaUtilMap>) nil_chk(contexts)) entrySet])) {
      OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *contextMetaData = [((id<JavaUtilMap_Entry>) nil_chk(entry_)) getValue];
      OrgApacheLuceneUtilIntsRef *ref = [entry_ getKey];
      OrgApacheLuceneUtilAutomatonAutomaton *contextAutomaton = OrgApacheLuceneUtilAutomatonAutomata_makeStringWithIntArray_withInt_withInt_(((OrgApacheLuceneUtilIntsRef *) nil_chk(ref))->ints_, ref->offset_, ref->length_);
      if (((OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *) nil_chk(contextMetaData))->exact_ == false) {
        contextAutomaton = OrgApacheLuceneUtilAutomatonOperations_concatenateWithOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneUtilAutomatonAutomaton_(contextAutomaton, matchAllAutomaton);
      }
      contextAutomaton = OrgApacheLuceneUtilAutomatonOperations_concatenateWithOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneUtilAutomatonAutomaton_(contextAutomaton, sep);
      if (contextsAutomaton == nil) {
        contextsAutomaton = contextAutomaton;
      }
      else {
        contextsAutomaton = OrgApacheLuceneUtilAutomatonOperations_union__WithOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneUtilAutomatonAutomaton_(contextsAutomaton, contextAutomaton);
      }
    }
    return contextsAutomaton;
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestDocumentContextQuery)

@implementation OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData

- (instancetype)initWithFloat:(jfloat)boost
                  withBoolean:(jboolean)exact {
  OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData_initWithFloat_withBoolean_(self, boost, exact);
  return self;
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x2, -1, 0, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithFloat:withBoolean:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "boost_", "F", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "exact_", "Z", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "FZ", "LOrgApacheLuceneSearchSuggestDocumentContextQuery;" };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData = { "ContextMetaData", "org.apache.lucene.search.suggest.document", ptrTable, methods, fields, 7, 0xa, 1, 2, 1, -1, -1, -1, -1 };
  return &_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData;
}

@end

void OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData_initWithFloat_withBoolean_(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *self, jfloat boost, jboolean exact) {
  NSObject_init(self);
  self->boost_ = boost;
  self->exact_ = exact;
}

OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *new_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData_initWithFloat_withBoolean_(jfloat boost, jboolean exact) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData, initWithFloat_withBoolean_, boost, exact)
}

OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData *create_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData_initWithFloat_withBoolean_(jfloat boost, jboolean exact) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData, initWithFloat_withBoolean_, boost, exact)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextMetaData)

@implementation OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight

- (instancetype)initWithOrgApacheLuceneSearchSuggestDocumentContextQuery:(OrgApacheLuceneSearchSuggestDocumentContextQuery *)outer$
                 withOrgApacheLuceneSearchSuggestDocumentCompletionQuery:(OrgApacheLuceneSearchSuggestDocumentCompletionQuery *)query
                               withOrgApacheLuceneUtilAutomatonAutomaton:(OrgApacheLuceneUtilAutomatonAutomaton *)automaton
                withOrgApacheLuceneSearchSuggestDocumentCompletionWeight:(OrgApacheLuceneSearchSuggestDocumentCompletionWeight *)innerWeight
                                                         withJavaUtilMap:(id<JavaUtilMap>)contextMap
                                                            withIntArray:(IOSIntArray *)contextLengths {
  OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_(self, outer$, query, automaton, innerWeight, contextMap, contextLengths);
  return self;
}

- (void)setNextMatchWithOrgApacheLuceneUtilIntsRef:(OrgApacheLuceneUtilIntsRef *)pathPrefix {
  OrgApacheLuceneUtilIntsRef *ref = JreRetainedLocalValue([((OrgApacheLuceneUtilIntsRef *) nil_chk(pathPrefix)) java_clone]);
  {
    IOSIntArray *a__ = contextLengths_;
    jint const *b__ = ((IOSIntArray *) nil_chk(a__))->buffer_;
    jint const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      jint contextLength = *b__++;
      if (contextLength > pathPrefix->length_) {
        continue;
      }
      ((OrgApacheLuceneUtilIntsRef *) nil_chk(ref))->length_ = contextLength;
      if ([((id<JavaUtilMap>) nil_chk(contextMap_)) containsKeyWithId:ref]) {
        currentBoost_ = [((JavaLangFloat *) nil_chk([contextMap_ getWithId:ref])) floatValue];
        ref->length_ = pathPrefix->length_;
        OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_setInnerWeightWithOrgApacheLuceneUtilIntsRef_withInt_(self, ref, contextLength);
        return;
      }
    }
  }
  ((OrgApacheLuceneUtilIntsRef *) nil_chk(ref))->length_ = pathPrefix->length_;
  currentBoost_ = 0.0f;
  OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_setInnerWeightWithOrgApacheLuceneUtilIntsRef_withInt_(self, ref, 0);
}

- (void)setInnerWeightWithOrgApacheLuceneUtilIntsRef:(OrgApacheLuceneUtilIntsRef *)ref
                                             withInt:(jint)offset {
  OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_setInnerWeightWithOrgApacheLuceneUtilIntsRef_withInt_(self, ref, offset);
}

- (id<JavaLangCharSequence>)context {
  return currentContext_;
}

- (jfloat)boost {
  return currentBoost_ + [((OrgApacheLuceneSearchSuggestDocumentCompletionWeight *) nil_chk(innerWeight_)) boost];
}

- (void)dealloc {
  RELEASE_(contextMap_);
  RELEASE_(contextLengths_);
  RELEASE_(innerWeight_);
  RELEASE_(scratch_);
  RELEASE_(currentContext_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, 1, 2, -1, -1 },
    { NULL, "V", 0x4, 3, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 5, 6, -1, -1, -1, -1 },
    { NULL, "LJavaLangCharSequence;", 0x4, -1, -1, -1, -1, -1, -1 },
    { NULL, "F", 0x4, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneSearchSuggestDocumentContextQuery:withOrgApacheLuceneSearchSuggestDocumentCompletionQuery:withOrgApacheLuceneUtilAutomatonAutomaton:withOrgApacheLuceneSearchSuggestDocumentCompletionWeight:withJavaUtilMap:withIntArray:);
  methods[1].selector = @selector(setNextMatchWithOrgApacheLuceneUtilIntsRef:);
  methods[2].selector = @selector(setInnerWeightWithOrgApacheLuceneUtilIntsRef:withInt:);
  methods[3].selector = @selector(context);
  methods[4].selector = @selector(boost);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "contextMap_", "LJavaUtilMap;", .constantValue.asLong = 0, 0x12, -1, -1, 7, -1 },
    { "contextLengths_", "[I", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "innerWeight_", "LOrgApacheLuceneSearchSuggestDocumentCompletionWeight;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "scratch_", "LOrgApacheLuceneUtilBytesRefBuilder;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "currentBoost_", "F", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "currentContext_", "LJavaLangCharSequence;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneSearchSuggestDocumentContextQuery;LOrgApacheLuceneSearchSuggestDocumentCompletionQuery;LOrgApacheLuceneUtilAutomatonAutomaton;LOrgApacheLuceneSearchSuggestDocumentCompletionWeight;LJavaUtilMap;[I", "LJavaIoIOException;", "(Lorg/apache/lucene/search/suggest/document/CompletionQuery;Lorg/apache/lucene/util/automaton/Automaton;Lorg/apache/lucene/search/suggest/document/CompletionWeight;Ljava/util/Map<Lorg/apache/lucene/util/IntsRef;Ljava/lang/Float;>;[I)V", "setNextMatch", "LOrgApacheLuceneUtilIntsRef;", "setInnerWeight", "LOrgApacheLuceneUtilIntsRef;I", "Ljava/util/Map<Lorg/apache/lucene/util/IntsRef;Ljava/lang/Float;>;", "LOrgApacheLuceneSearchSuggestDocumentContextQuery;" };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight = { "ContextCompletionWeight", "org.apache.lucene.search.suggest.document", ptrTable, methods, fields, 7, 0x2, 5, 6, 8, -1, -1, -1, -1 };
  return &_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight;
}

@end

void OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight *self, OrgApacheLuceneSearchSuggestDocumentContextQuery *outer$, OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query, OrgApacheLuceneUtilAutomatonAutomaton *automaton, OrgApacheLuceneSearchSuggestDocumentCompletionWeight *innerWeight, id<JavaUtilMap> contextMap, IOSIntArray *contextLengths) {
  OrgApacheLuceneSearchSuggestDocumentCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_(self, query, automaton);
  JreStrongAssignAndConsume(&self->scratch_, new_OrgApacheLuceneUtilBytesRefBuilder_init());
  JreStrongAssign(&self->contextMap_, contextMap);
  JreStrongAssign(&self->contextLengths_, contextLengths);
  JreStrongAssign(&self->innerWeight_, innerWeight);
}

OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight *new_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_(OrgApacheLuceneSearchSuggestDocumentContextQuery *outer$, OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query, OrgApacheLuceneUtilAutomatonAutomaton *automaton, OrgApacheLuceneSearchSuggestDocumentCompletionWeight *innerWeight, id<JavaUtilMap> contextMap, IOSIntArray *contextLengths) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight, initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_, outer$, query, automaton, innerWeight, contextMap, contextLengths)
}

OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight *create_OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_(OrgApacheLuceneSearchSuggestDocumentContextQuery *outer$, OrgApacheLuceneSearchSuggestDocumentCompletionQuery *query, OrgApacheLuceneUtilAutomatonAutomaton *automaton, OrgApacheLuceneSearchSuggestDocumentCompletionWeight *innerWeight, id<JavaUtilMap> contextMap, IOSIntArray *contextLengths) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight, initWithOrgApacheLuceneSearchSuggestDocumentContextQuery_withOrgApacheLuceneSearchSuggestDocumentCompletionQuery_withOrgApacheLuceneUtilAutomatonAutomaton_withOrgApacheLuceneSearchSuggestDocumentCompletionWeight_withJavaUtilMap_withIntArray_, outer$, query, automaton, innerWeight, contextMap, contextLengths)
}

void OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight_setInnerWeightWithOrgApacheLuceneUtilIntsRef_withInt_(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight *self, OrgApacheLuceneUtilIntsRef *ref, jint offset) {
  OrgApacheLuceneUtilIntsRefBuilder *refBuilder = create_OrgApacheLuceneUtilIntsRefBuilder_init();
  for (jint i = offset; i < ((OrgApacheLuceneUtilIntsRef *) nil_chk(ref))->length_; i++) {
    if (IOSIntArray_Get(nil_chk(ref->ints_), ref->offset_ + i) == OrgApacheLuceneSearchSuggestDocumentContextSuggestField_CONTEXT_SEPARATOR) {
      if (i > 0) {
        [refBuilder copyIntsWithIntArray:ref->ints_ withInt:ref->offset_ withInt:i];
        JreStrongAssign(&self->currentContext_, [((OrgApacheLuceneUtilBytesRef *) nil_chk(OrgApacheLuceneUtilFstUtil_toBytesRefWithOrgApacheLuceneUtilIntsRef_withOrgApacheLuceneUtilBytesRefBuilder_([refBuilder get], self->scratch_))) utf8ToString]);
      }
      else {
        JreStrongAssign(&self->currentContext_, nil);
      }
      ref->offset_ = ++i;
      JreAssert(ref->offset_ < ref->length_, @"input should not end with the context separator");
      if (IOSIntArray_Get(nil_chk(ref->ints_), i) == OrgApacheLuceneSearchSuggestDocumentCompletionAnalyzer_SEP_LABEL) {
        ref->offset_++;
        JreAssert(ref->offset_ < ref->length_, @"input should not end with a context separator followed by SEP_LABEL");
      }
      ref->length_ = ref->length_ - ref->offset_;
      [refBuilder copyIntsWithIntArray:ref->ints_ withInt:ref->offset_ withInt:ref->length_];
      [((OrgApacheLuceneSearchSuggestDocumentCompletionWeight *) nil_chk(self->innerWeight_)) setNextMatchWithOrgApacheLuceneUtilIntsRef:[refBuilder get]];
      return;
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchSuggestDocumentContextQuery_ContextCompletionWeight)
