//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./join/src/java/org/apache/lucene/search/join/TermsQuery.java
//

#include "IOSClass.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/util/Comparator.h"
#include "org/apache/lucene/index/FilteredTermsEnum.h"
#include "org/apache/lucene/index/Terms.h"
#include "org/apache/lucene/index/TermsEnum.h"
#include "org/apache/lucene/search/MultiTermQuery.h"
#include "org/apache/lucene/search/Query.h"
#include "org/apache/lucene/search/join/TermsQuery.h"
#include "org/apache/lucene/util/AttributeSource.h"
#include "org/apache/lucene/util/BytesRef.h"
#include "org/apache/lucene/util/BytesRefHash.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/search/join/TermsQuery must not be compiled with ARC (-fobjc-arc)"
#endif

@interface OrgApacheLuceneSearchJoinTermsQuery () {
 @public
  OrgApacheLuceneUtilBytesRefHash *terms_;
  IOSIntArray *ords_;
  OrgApacheLuceneSearchQuery *fromQuery_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery, terms_, OrgApacheLuceneUtilBytesRefHash *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery, ords_, IOSIntArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery, fromQuery_, OrgApacheLuceneSearchQuery *)

@interface OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum () {
 @public
  OrgApacheLuceneUtilBytesRefHash *terms_;
  IOSIntArray *ords_;
  jint lastElement_;
  OrgApacheLuceneUtilBytesRef *lastTerm_;
  OrgApacheLuceneUtilBytesRef *spare_;
  id<JavaUtilComparator> comparator_;
  OrgApacheLuceneUtilBytesRef *seekTerm_;
  jint upto_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum, terms_, OrgApacheLuceneUtilBytesRefHash *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum, ords_, IOSIntArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum, lastTerm_, OrgApacheLuceneUtilBytesRef *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum, spare_, OrgApacheLuceneUtilBytesRef *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum, comparator_, id<JavaUtilComparator>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum, seekTerm_, OrgApacheLuceneUtilBytesRef *)

@implementation OrgApacheLuceneSearchJoinTermsQuery

- (instancetype)initPackagePrivateWithNSString:(NSString *)field
                withOrgApacheLuceneSearchQuery:(OrgApacheLuceneSearchQuery *)fromQuery
           withOrgApacheLuceneUtilBytesRefHash:(OrgApacheLuceneUtilBytesRefHash *)terms {
  OrgApacheLuceneSearchJoinTermsQuery_initPackagePrivateWithNSString_withOrgApacheLuceneSearchQuery_withOrgApacheLuceneUtilBytesRefHash_(self, field, fromQuery, terms);
  return self;
}

- (OrgApacheLuceneIndexTermsEnum *)getTermsEnumWithOrgApacheLuceneIndexTerms:(OrgApacheLuceneIndexTerms *)terms
                                      withOrgApacheLuceneUtilAttributeSource:(OrgApacheLuceneUtilAttributeSource *)atts {
  if ([((OrgApacheLuceneUtilBytesRefHash *) nil_chk(self->terms_)) size] == 0) {
    return JreLoadStatic(OrgApacheLuceneIndexTermsEnum, EMPTY);
  }
  return create_OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum_initWithOrgApacheLuceneIndexTermsEnum_withOrgApacheLuceneUtilBytesRefHash_withIntArray_([((OrgApacheLuceneIndexTerms *) nil_chk(terms)) iterator], self->terms_, ords_);
}

- (NSString *)toStringWithNSString:(NSString *)string {
  return JreStrcat("$$C", @"TermsQuery{field=", field_, '}');
}

- (jboolean)isEqual:(id)obj {
  if (JreObjectEqualsEquals(self, obj)) {
    return true;
  }
  if (![super isEqual:obj]) {
    return false;
  }
  if (!JreObjectEqualsEquals([self java_getClass], [nil_chk(obj) java_getClass])) {
    return false;
  }
  OrgApacheLuceneSearchJoinTermsQuery *other = (OrgApacheLuceneSearchJoinTermsQuery *) cast_chk(obj, [OrgApacheLuceneSearchJoinTermsQuery class]);
  if (![((OrgApacheLuceneSearchQuery *) nil_chk(fromQuery_)) isEqual:other->fromQuery_]) {
    return false;
  }
  return true;
}

- (NSUInteger)hash {
  jint prime = 31;
  jint result = ((jint) [super hash]);
  result += prime * ((jint) [((OrgApacheLuceneSearchQuery *) nil_chk(fromQuery_)) hash]);
  return result;
}

- (void)dealloc {
  RELEASE_(terms_);
  RELEASE_(ords_);
  RELEASE_(fromQuery_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTermsEnum;", 0x4, 1, 2, 3, -1, -1, -1 },
    { NULL, "LNSString;", 0x1, 4, 5, -1, -1, -1, -1 },
    { NULL, "Z", 0x1, 6, 7, -1, -1, -1, -1 },
    { NULL, "I", 0x1, 8, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initPackagePrivateWithNSString:withOrgApacheLuceneSearchQuery:withOrgApacheLuceneUtilBytesRefHash:);
  methods[1].selector = @selector(getTermsEnumWithOrgApacheLuceneIndexTerms:withOrgApacheLuceneUtilAttributeSource:);
  methods[2].selector = @selector(toStringWithNSString:);
  methods[3].selector = @selector(isEqual:);
  methods[4].selector = @selector(hash);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "terms_", "LOrgApacheLuceneUtilBytesRefHash;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "ords_", "[I", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "fromQuery_", "LOrgApacheLuceneSearchQuery;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LNSString;LOrgApacheLuceneSearchQuery;LOrgApacheLuceneUtilBytesRefHash;", "getTermsEnum", "LOrgApacheLuceneIndexTerms;LOrgApacheLuceneUtilAttributeSource;", "LJavaIoIOException;", "toString", "LNSString;", "equals", "LNSObject;", "hashCode", "LOrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum;" };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchJoinTermsQuery = { "TermsQuery", "org.apache.lucene.search.join", ptrTable, methods, fields, 7, 0x0, 5, 3, -1, 9, -1, -1, -1 };
  return &_OrgApacheLuceneSearchJoinTermsQuery;
}

@end

void OrgApacheLuceneSearchJoinTermsQuery_initPackagePrivateWithNSString_withOrgApacheLuceneSearchQuery_withOrgApacheLuceneUtilBytesRefHash_(OrgApacheLuceneSearchJoinTermsQuery *self, NSString *field, OrgApacheLuceneSearchQuery *fromQuery, OrgApacheLuceneUtilBytesRefHash *terms) {
  OrgApacheLuceneSearchMultiTermQuery_initWithNSString_(self, field);
  JreStrongAssign(&self->fromQuery_, fromQuery);
  JreStrongAssign(&self->terms_, terms);
  JreStrongAssign(&self->ords_, [((OrgApacheLuceneUtilBytesRefHash *) nil_chk(terms)) sortWithJavaUtilComparator:OrgApacheLuceneUtilBytesRef_getUTF8SortedAsUnicodeComparator()]);
}

OrgApacheLuceneSearchJoinTermsQuery *new_OrgApacheLuceneSearchJoinTermsQuery_initPackagePrivateWithNSString_withOrgApacheLuceneSearchQuery_withOrgApacheLuceneUtilBytesRefHash_(NSString *field, OrgApacheLuceneSearchQuery *fromQuery, OrgApacheLuceneUtilBytesRefHash *terms) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchJoinTermsQuery, initPackagePrivateWithNSString_withOrgApacheLuceneSearchQuery_withOrgApacheLuceneUtilBytesRefHash_, field, fromQuery, terms)
}

OrgApacheLuceneSearchJoinTermsQuery *create_OrgApacheLuceneSearchJoinTermsQuery_initPackagePrivateWithNSString_withOrgApacheLuceneSearchQuery_withOrgApacheLuceneUtilBytesRefHash_(NSString *field, OrgApacheLuceneSearchQuery *fromQuery, OrgApacheLuceneUtilBytesRefHash *terms) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchJoinTermsQuery, initPackagePrivateWithNSString_withOrgApacheLuceneSearchQuery_withOrgApacheLuceneUtilBytesRefHash_, field, fromQuery, terms)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchJoinTermsQuery)

@implementation OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum

- (instancetype)initWithOrgApacheLuceneIndexTermsEnum:(OrgApacheLuceneIndexTermsEnum *)tenum
                  withOrgApacheLuceneUtilBytesRefHash:(OrgApacheLuceneUtilBytesRefHash *)terms
                                         withIntArray:(IOSIntArray *)ords {
  OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum_initWithOrgApacheLuceneIndexTermsEnum_withOrgApacheLuceneUtilBytesRefHash_withIntArray_(self, tenum, terms, ords);
  return self;
}

- (OrgApacheLuceneUtilBytesRef *)nextSeekTermWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)currentTerm {
  OrgApacheLuceneUtilBytesRef *temp = JreRetainedLocalValue(seekTerm_);
  JreStrongAssign(&seekTerm_, nil);
  return temp;
}

- (OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus *)acceptWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)term {
  if ([((id<JavaUtilComparator>) nil_chk(comparator_)) compareWithId:term withId:lastTerm_] > 0) {
    return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, END);
  }
  OrgApacheLuceneUtilBytesRef *currentTerm = JreRetainedLocalValue([((OrgApacheLuceneUtilBytesRefHash *) nil_chk(terms_)) getWithInt:IOSIntArray_Get(nil_chk(ords_), upto_) withOrgApacheLuceneUtilBytesRef:spare_]);
  if ([comparator_ compareWithId:term withId:currentTerm] == 0) {
    if (upto_ == lastElement_) {
      return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, YES);
    }
    else {
      JreStrongAssign(&seekTerm_, [terms_ getWithInt:IOSIntArray_Get(ords_, ++upto_) withOrgApacheLuceneUtilBytesRef:spare_]);
      return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, YES_AND_SEEK);
    }
  }
  else {
    if (upto_ == lastElement_) {
      return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, NO);
    }
    else {
      jint cmp;
      do {
        if (upto_ == lastElement_) {
          return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, NO);
        }
        JreStrongAssign(&seekTerm_, [terms_ getWithInt:IOSIntArray_Get(ords_, ++upto_) withOrgApacheLuceneUtilBytesRef:spare_]);
      }
      while ((cmp = [comparator_ compareWithId:seekTerm_ withId:term]) < 0);
      if (cmp == 0) {
        if (upto_ == lastElement_) {
          return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, YES);
        }
        JreStrongAssign(&seekTerm_, [terms_ getWithInt:IOSIntArray_Get(ords_, ++upto_) withOrgApacheLuceneUtilBytesRef:spare_]);
        return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, YES_AND_SEEK);
      }
      else {
        return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, NO_AND_SEEK);
      }
    }
  }
}

- (void)dealloc {
  RELEASE_(terms_);
  RELEASE_(ords_);
  RELEASE_(lastTerm_);
  RELEASE_(spare_);
  RELEASE_(comparator_);
  RELEASE_(seekTerm_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilBytesRef;", 0x4, 1, 2, 3, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus;", 0x4, 4, 2, 3, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneIndexTermsEnum:withOrgApacheLuceneUtilBytesRefHash:withIntArray:);
  methods[1].selector = @selector(nextSeekTermWithOrgApacheLuceneUtilBytesRef:);
  methods[2].selector = @selector(acceptWithOrgApacheLuceneUtilBytesRef:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "terms_", "LOrgApacheLuceneUtilBytesRefHash;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "ords_", "[I", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "lastElement_", "I", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "lastTerm_", "LOrgApacheLuceneUtilBytesRef;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "spare_", "LOrgApacheLuceneUtilBytesRef;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "comparator_", "LJavaUtilComparator;", .constantValue.asLong = 0, 0x12, -1, -1, 5, -1 },
    { "seekTerm_", "LOrgApacheLuceneUtilBytesRef;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "upto_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneIndexTermsEnum;LOrgApacheLuceneUtilBytesRefHash;[I", "nextSeekTerm", "LOrgApacheLuceneUtilBytesRef;", "LJavaIoIOException;", "accept", "Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;", "LOrgApacheLuceneSearchJoinTermsQuery;" };
  static const J2ObjcClassInfo _OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum = { "SeekingTermSetTermsEnum", "org.apache.lucene.search.join", ptrTable, methods, fields, 7, 0x8, 3, 8, 6, -1, -1, -1, -1 };
  return &_OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum;
}

@end

void OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum_initWithOrgApacheLuceneIndexTermsEnum_withOrgApacheLuceneUtilBytesRefHash_withIntArray_(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum *self, OrgApacheLuceneIndexTermsEnum *tenum, OrgApacheLuceneUtilBytesRefHash *terms, IOSIntArray *ords) {
  OrgApacheLuceneIndexFilteredTermsEnum_initWithOrgApacheLuceneIndexTermsEnum_(self, tenum);
  JreStrongAssignAndConsume(&self->spare_, new_OrgApacheLuceneUtilBytesRef_init());
  self->upto_ = 0;
  JreStrongAssign(&self->terms_, terms);
  JreStrongAssign(&self->ords_, ords);
  JreStrongAssign(&self->comparator_, OrgApacheLuceneUtilBytesRef_getUTF8SortedAsUnicodeComparator());
  self->lastElement_ = [((OrgApacheLuceneUtilBytesRefHash *) nil_chk(terms)) size] - 1;
  JreStrongAssign(&self->lastTerm_, [terms getWithInt:IOSIntArray_Get(nil_chk(ords), self->lastElement_) withOrgApacheLuceneUtilBytesRef:create_OrgApacheLuceneUtilBytesRef_init()]);
  JreStrongAssign(&self->seekTerm_, [terms getWithInt:IOSIntArray_Get(ords, self->upto_) withOrgApacheLuceneUtilBytesRef:self->spare_]);
}

OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum *new_OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum_initWithOrgApacheLuceneIndexTermsEnum_withOrgApacheLuceneUtilBytesRefHash_withIntArray_(OrgApacheLuceneIndexTermsEnum *tenum, OrgApacheLuceneUtilBytesRefHash *terms, IOSIntArray *ords) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum, initWithOrgApacheLuceneIndexTermsEnum_withOrgApacheLuceneUtilBytesRefHash_withIntArray_, tenum, terms, ords)
}

OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum *create_OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum_initWithOrgApacheLuceneIndexTermsEnum_withOrgApacheLuceneUtilBytesRefHash_withIntArray_(OrgApacheLuceneIndexTermsEnum *tenum, OrgApacheLuceneUtilBytesRefHash *terms, IOSIntArray *ords) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum, initWithOrgApacheLuceneIndexTermsEnum_withOrgApacheLuceneUtilBytesRefHash_withIntArray_, tenum, terms, ords)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSearchJoinTermsQuery_SeekingTermSetTermsEnum)
