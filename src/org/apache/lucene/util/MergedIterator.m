//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/util/MergedIterator.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Comparable.h"
#include "java/lang/UnsupportedOperationException.h"
#include "java/util/Iterator.h"
#include "java/util/NoSuchElementException.h"
#include "java/util/function/Consumer.h"
#include "org/apache/lucene/util/MergedIterator.h"
#include "org/apache/lucene/util/PriorityQueue.h"

@class OrgApacheLuceneUtilMergedIterator_TermMergeQueue;

#if __has_feature(objc_arc)
#error "org/apache/lucene/util/MergedIterator must not be compiled with ARC (-fobjc-arc)"
#endif

#pragma clang diagnostic ignored "-Wincomplete-implementation"

@interface OrgApacheLuceneUtilMergedIterator () {
 @public
  id<JavaLangComparable> current_;
  OrgApacheLuceneUtilMergedIterator_TermMergeQueue *queue_;
  IOSObjectArray *top_;
  jboolean removeDuplicates_;
  jint numTop_;
}

- (void)pullTop;

- (void)pushTop;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilMergedIterator, current_, id<JavaLangComparable>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilMergedIterator, queue_, OrgApacheLuceneUtilMergedIterator_TermMergeQueue *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilMergedIterator, top_, IOSObjectArray *)

__attribute__((unused)) static void OrgApacheLuceneUtilMergedIterator_pullTop(OrgApacheLuceneUtilMergedIterator *self);

__attribute__((unused)) static void OrgApacheLuceneUtilMergedIterator_pushTop(OrgApacheLuceneUtilMergedIterator *self);

@interface OrgApacheLuceneUtilMergedIterator_SubIterator : NSObject {
 @public
  id<JavaUtilIterator> iterator_;
  id<JavaLangComparable> current_;
  jint index_;
}

- (instancetype)init;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneUtilMergedIterator_SubIterator)

J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilMergedIterator_SubIterator, iterator_, id<JavaUtilIterator>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilMergedIterator_SubIterator, current_, id<JavaLangComparable>)

__attribute__((unused)) static void OrgApacheLuceneUtilMergedIterator_SubIterator_init(OrgApacheLuceneUtilMergedIterator_SubIterator *self);

__attribute__((unused)) static OrgApacheLuceneUtilMergedIterator_SubIterator *new_OrgApacheLuceneUtilMergedIterator_SubIterator_init(void) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneUtilMergedIterator_SubIterator *create_OrgApacheLuceneUtilMergedIterator_SubIterator_init(void);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneUtilMergedIterator_SubIterator)

@interface OrgApacheLuceneUtilMergedIterator_TermMergeQueue : OrgApacheLuceneUtilPriorityQueue

- (instancetype)initWithInt:(jint)size;

- (jboolean)lessThanWithId:(OrgApacheLuceneUtilMergedIterator_SubIterator *)a
                    withId:(OrgApacheLuceneUtilMergedIterator_SubIterator *)b;

- (OrgApacheLuceneUtilMergedIterator_SubIterator *)pop;

- (OrgApacheLuceneUtilMergedIterator_SubIterator *)top;

- (OrgApacheLuceneUtilMergedIterator_SubIterator *)insertWithOverflowWithId:(OrgApacheLuceneUtilMergedIterator_SubIterator *)arg0;

- (OrgApacheLuceneUtilMergedIterator_SubIterator *)addWithId:(OrgApacheLuceneUtilMergedIterator_SubIterator *)arg0;

- (OrgApacheLuceneUtilMergedIterator_SubIterator *)getSentinelObject;

- (OrgApacheLuceneUtilMergedIterator_SubIterator *)updateTopWithId:(OrgApacheLuceneUtilMergedIterator_SubIterator *)arg0;

- (OrgApacheLuceneUtilMergedIterator_SubIterator *)updateTop;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneUtilMergedIterator_TermMergeQueue)

__attribute__((unused)) static void OrgApacheLuceneUtilMergedIterator_TermMergeQueue_initWithInt_(OrgApacheLuceneUtilMergedIterator_TermMergeQueue *self, jint size);

__attribute__((unused)) static OrgApacheLuceneUtilMergedIterator_TermMergeQueue *new_OrgApacheLuceneUtilMergedIterator_TermMergeQueue_initWithInt_(jint size) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneUtilMergedIterator_TermMergeQueue *create_OrgApacheLuceneUtilMergedIterator_TermMergeQueue_initWithInt_(jint size);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneUtilMergedIterator_TermMergeQueue)

@implementation OrgApacheLuceneUtilMergedIterator

- (instancetype)initWithJavaUtilIteratorArray:(IOSObjectArray *)iterators {
  OrgApacheLuceneUtilMergedIterator_initWithJavaUtilIteratorArray_(self, iterators);
  return self;
}

- (instancetype)initWithBoolean:(jboolean)removeDuplicates
      withJavaUtilIteratorArray:(IOSObjectArray *)iterators {
  OrgApacheLuceneUtilMergedIterator_initWithBoolean_withJavaUtilIteratorArray_(self, removeDuplicates, iterators);
  return self;
}

- (jboolean)hasNext {
  if ([((OrgApacheLuceneUtilMergedIterator_TermMergeQueue *) nil_chk(queue_)) size] > 0) {
    return true;
  }
  for (jint i = 0; i < numTop_; i++) {
    if ([((id<JavaUtilIterator>) nil_chk(((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(IOSObjectArray_Get(nil_chk(top_), i)))->iterator_)) hasNext]) {
      return true;
    }
  }
  return false;
}

- (id<JavaLangComparable>)next {
  OrgApacheLuceneUtilMergedIterator_pushTop(self);
  if ([((OrgApacheLuceneUtilMergedIterator_TermMergeQueue *) nil_chk(queue_)) size] > 0) {
    OrgApacheLuceneUtilMergedIterator_pullTop(self);
  }
  else {
    JreStrongAssign(&current_, nil);
  }
  if (current_ == nil) {
    @throw create_JavaUtilNoSuchElementException_init();
  }
  return current_;
}

- (void)remove {
  @throw create_JavaLangUnsupportedOperationException_init();
}

- (void)pullTop {
  OrgApacheLuceneUtilMergedIterator_pullTop(self);
}

- (void)pushTop {
  OrgApacheLuceneUtilMergedIterator_pushTop(self);
}

- (void)forEachRemainingWithJavaUtilFunctionConsumer:(id<JavaUtilFunctionConsumer>)arg0 {
  JavaUtilIterator_forEachRemainingWithJavaUtilFunctionConsumer_(self, arg0);
}

- (void)dealloc {
  RELEASE_(current_);
  RELEASE_(queue_);
  RELEASE_(top_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x81, -1, 0, -1, 1, -1, -1 },
    { NULL, NULL, 0x81, -1, 2, -1, 3, -1, -1 },
    { NULL, "Z", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LJavaLangComparable;", 0x1, -1, -1, -1, 4, -1, -1 },
    { NULL, "V", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithJavaUtilIteratorArray:);
  methods[1].selector = @selector(initWithBoolean:withJavaUtilIteratorArray:);
  methods[2].selector = @selector(hasNext);
  methods[3].selector = @selector(next);
  methods[4].selector = @selector(remove);
  methods[5].selector = @selector(pullTop);
  methods[6].selector = @selector(pushTop);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "current_", "LJavaLangComparable;", .constantValue.asLong = 0, 0x2, -1, -1, 5, -1 },
    { "queue_", "LOrgApacheLuceneUtilMergedIterator_TermMergeQueue;", .constantValue.asLong = 0, 0x12, -1, -1, 6, -1 },
    { "top_", "[LOrgApacheLuceneUtilMergedIterator_SubIterator;", .constantValue.asLong = 0, 0x12, -1, -1, 7, -1 },
    { "removeDuplicates_", "Z", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "numTop_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "[LJavaUtilIterator;", "([Ljava/util/Iterator<TT;>;)V", "Z[LJavaUtilIterator;", "(Z[Ljava/util/Iterator<TT;>;)V", "()TT;", "TT;", "Lorg/apache/lucene/util/MergedIterator$TermMergeQueue<TT;>;", "[Lorg/apache/lucene/util/MergedIterator$SubIterator<TT;>;", "LOrgApacheLuceneUtilMergedIterator_SubIterator;LOrgApacheLuceneUtilMergedIterator_TermMergeQueue;", "<T::Ljava/lang/Comparable<TT;>;>Ljava/lang/Object;Ljava/util/Iterator<TT;>;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilMergedIterator = { "MergedIterator", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0x11, 7, 5, -1, 8, -1, 9, -1 };
  return &_OrgApacheLuceneUtilMergedIterator;
}

@end

void OrgApacheLuceneUtilMergedIterator_initWithJavaUtilIteratorArray_(OrgApacheLuceneUtilMergedIterator *self, IOSObjectArray *iterators) {
  OrgApacheLuceneUtilMergedIterator_initWithBoolean_withJavaUtilIteratorArray_(self, true, iterators);
}

OrgApacheLuceneUtilMergedIterator *new_OrgApacheLuceneUtilMergedIterator_initWithJavaUtilIteratorArray_(IOSObjectArray *iterators) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilMergedIterator, initWithJavaUtilIteratorArray_, iterators)
}

OrgApacheLuceneUtilMergedIterator *create_OrgApacheLuceneUtilMergedIterator_initWithJavaUtilIteratorArray_(IOSObjectArray *iterators) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilMergedIterator, initWithJavaUtilIteratorArray_, iterators)
}

void OrgApacheLuceneUtilMergedIterator_initWithBoolean_withJavaUtilIteratorArray_(OrgApacheLuceneUtilMergedIterator *self, jboolean removeDuplicates, IOSObjectArray *iterators) {
  NSObject_init(self);
  self->removeDuplicates_ = removeDuplicates;
  JreStrongAssignAndConsume(&self->queue_, new_OrgApacheLuceneUtilMergedIterator_TermMergeQueue_initWithInt_(((IOSObjectArray *) nil_chk(iterators))->size_));
  JreStrongAssignAndConsume(&self->top_, [IOSObjectArray newArrayWithLength:iterators->size_ type:OrgApacheLuceneUtilMergedIterator_SubIterator_class_()]);
  jint index = 0;
  {
    IOSObjectArray *a__ = iterators;
    id<JavaUtilIterator> const *b__ = a__->buffer_;
    id<JavaUtilIterator> const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      id<JavaUtilIterator> iterator = *b__++;
      if ([((id<JavaUtilIterator>) nil_chk(iterator)) hasNext]) {
        OrgApacheLuceneUtilMergedIterator_SubIterator *sub = create_OrgApacheLuceneUtilMergedIterator_SubIterator_init();
        JreStrongAssign(&sub->current_, [iterator next]);
        JreStrongAssign(&sub->iterator_, iterator);
        sub->index_ = index++;
        [self->queue_ addWithId:sub];
      }
    }
  }
}

OrgApacheLuceneUtilMergedIterator *new_OrgApacheLuceneUtilMergedIterator_initWithBoolean_withJavaUtilIteratorArray_(jboolean removeDuplicates, IOSObjectArray *iterators) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilMergedIterator, initWithBoolean_withJavaUtilIteratorArray_, removeDuplicates, iterators)
}

OrgApacheLuceneUtilMergedIterator *create_OrgApacheLuceneUtilMergedIterator_initWithBoolean_withJavaUtilIteratorArray_(jboolean removeDuplicates, IOSObjectArray *iterators) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilMergedIterator, initWithBoolean_withJavaUtilIteratorArray_, removeDuplicates, iterators)
}

void OrgApacheLuceneUtilMergedIterator_pullTop(OrgApacheLuceneUtilMergedIterator *self) {
  JreAssert(self->numTop_ == 0, @"org/apache/lucene/util/MergedIterator.java:113 condition failed: assert numTop == 0;");
  IOSObjectArray_Set(nil_chk(self->top_), self->numTop_++, [((OrgApacheLuceneUtilMergedIterator_TermMergeQueue *) nil_chk(self->queue_)) pop]);
  if (self->removeDuplicates_) {
    while ([self->queue_ size] != 0 && [((id<JavaLangComparable>) nil_chk(((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk([self->queue_ top]))->current_)) isEqual:((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(IOSObjectArray_Get(self->top_, 0)))->current_]) {
      IOSObjectArray_Set(self->top_, self->numTop_++, [self->queue_ pop]);
    }
  }
  JreStrongAssign(&self->current_, ((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(IOSObjectArray_Get(self->top_, 0)))->current_);
}

void OrgApacheLuceneUtilMergedIterator_pushTop(OrgApacheLuceneUtilMergedIterator *self) {
  for (jint i = 0; i < self->numTop_; i++) {
    if ([((id<JavaUtilIterator>) nil_chk(((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(IOSObjectArray_Get(nil_chk(self->top_), i)))->iterator_)) hasNext]) {
      JreStrongAssign(&((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(IOSObjectArray_Get(self->top_, i)))->current_, [((id<JavaUtilIterator>) nil_chk(((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(IOSObjectArray_Get(self->top_, i)))->iterator_)) next]);
      [((OrgApacheLuceneUtilMergedIterator_TermMergeQueue *) nil_chk(self->queue_)) addWithId:IOSObjectArray_Get(self->top_, i)];
    }
    else {
      JreStrongAssign(&((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(IOSObjectArray_Get(self->top_, i)))->current_, nil);
    }
  }
  self->numTop_ = 0;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilMergedIterator)

@implementation OrgApacheLuceneUtilMergedIterator_SubIterator

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneUtilMergedIterator_SubIterator_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)dealloc {
  RELEASE_(iterator_);
  RELEASE_(current_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x2, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "iterator_", "LJavaUtilIterator;", .constantValue.asLong = 0, 0x0, -1, -1, 0, -1 },
    { "current_", "LJavaLangComparable;", .constantValue.asLong = 0, 0x0, -1, -1, 1, -1 },
    { "index_", "I", .constantValue.asLong = 0, 0x0, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "Ljava/util/Iterator<TI;>;", "TI;", "LOrgApacheLuceneUtilMergedIterator;", "<I::Ljava/lang/Comparable<TI;>;>Ljava/lang/Object;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilMergedIterator_SubIterator = { "SubIterator", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0xa, 1, 3, 2, -1, -1, 3, -1 };
  return &_OrgApacheLuceneUtilMergedIterator_SubIterator;
}

@end

void OrgApacheLuceneUtilMergedIterator_SubIterator_init(OrgApacheLuceneUtilMergedIterator_SubIterator *self) {
  NSObject_init(self);
}

OrgApacheLuceneUtilMergedIterator_SubIterator *new_OrgApacheLuceneUtilMergedIterator_SubIterator_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilMergedIterator_SubIterator, init)
}

OrgApacheLuceneUtilMergedIterator_SubIterator *create_OrgApacheLuceneUtilMergedIterator_SubIterator_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilMergedIterator_SubIterator, init)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilMergedIterator_SubIterator)

@implementation OrgApacheLuceneUtilMergedIterator_TermMergeQueue

- (instancetype)initWithInt:(jint)size {
  OrgApacheLuceneUtilMergedIterator_TermMergeQueue_initWithInt_(self, size);
  return self;
}

- (jboolean)lessThanWithId:(OrgApacheLuceneUtilMergedIterator_SubIterator *)a
                    withId:(OrgApacheLuceneUtilMergedIterator_SubIterator *)b {
  jint cmp = [((id<JavaLangComparable>) nil_chk(((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(a))->current_)) compareToWithId:((OrgApacheLuceneUtilMergedIterator_SubIterator *) nil_chk(b))->current_];
  if (cmp != 0) {
    return cmp < 0;
  }
  else {
    return a->index_ < b->index_;
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
    { NULL, "Z", 0x4, 1, 2, -1, 3, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithInt:);
  methods[1].selector = @selector(lessThanWithId:withId:);
  #pragma clang diagnostic pop
  static const void *ptrTable[] = { "I", "lessThan", "LOrgApacheLuceneUtilMergedIterator_SubIterator;LOrgApacheLuceneUtilMergedIterator_SubIterator;", "(Lorg/apache/lucene/util/MergedIterator$SubIterator<TC;>;Lorg/apache/lucene/util/MergedIterator$SubIterator<TC;>;)Z", "LOrgApacheLuceneUtilMergedIterator;", "<C::Ljava/lang/Comparable<TC;>;>Lorg/apache/lucene/util/PriorityQueue<Lorg/apache/lucene/util/MergedIterator$SubIterator<TC;>;>;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilMergedIterator_TermMergeQueue = { "TermMergeQueue", "org.apache.lucene.util", ptrTable, methods, NULL, 7, 0xa, 2, 0, 4, -1, -1, 5, -1 };
  return &_OrgApacheLuceneUtilMergedIterator_TermMergeQueue;
}

@end

void OrgApacheLuceneUtilMergedIterator_TermMergeQueue_initWithInt_(OrgApacheLuceneUtilMergedIterator_TermMergeQueue *self, jint size) {
  OrgApacheLuceneUtilPriorityQueue_initWithInt_(self, size);
}

OrgApacheLuceneUtilMergedIterator_TermMergeQueue *new_OrgApacheLuceneUtilMergedIterator_TermMergeQueue_initWithInt_(jint size) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilMergedIterator_TermMergeQueue, initWithInt_, size)
}

OrgApacheLuceneUtilMergedIterator_TermMergeQueue *create_OrgApacheLuceneUtilMergedIterator_TermMergeQueue_initWithInt_(jint size) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilMergedIterator_TermMergeQueue, initWithInt_, size)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilMergedIterator_TermMergeQueue)
