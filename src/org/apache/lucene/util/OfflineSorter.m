//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/util/OfflineSorter.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/BufferedInputStream.h"
#include "java/io/BufferedOutputStream.h"
#include "java/io/Closeable.h"
#include "java/io/DataInput.h"
#include "java/io/DataInputStream.h"
#include "java/io/DataOutput.h"
#include "java/io/DataOutputStream.h"
#include "java/io/EOFException.h"
#include "java/io/FileInputStream.h"
#include "java/io/FileOutputStream.h"
#include "java/io/IOException.h"
#include "java/lang/Double.h"
#include "java/lang/Exception.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "java/lang/Runtime.h"
#include "java/lang/Short.h"
#include "java/lang/System.h"
#include "java/lang/UnsupportedOperationException.h"
#include "java/util/ArrayList.h"
#include "java/util/Comparator.h"
#include "java/util/List.h"
#include "java/util/Locale.h"
#include "org/apache/lucene/util/BytesRef.h"
#include "org/apache/lucene/util/BytesRefArray.h"
#include "org/apache/lucene/util/BytesRefBuilder.h"
#include "org/apache/lucene/util/BytesRefIterator.h"
#include "org/apache/lucene/util/Counter.h"
#include "org/apache/lucene/util/IOUtils.h"
#include "org/apache/lucene/util/OfflineSorter.h"
#include "org/apache/lucene/util/PriorityQueue.h"
#include "org/lukhnos/portmobile/file/Files.h"
#include "org/lukhnos/portmobile/file/Path.h"
#include "org/lukhnos/portmobile/file/Paths.h"
#include "org/lukhnos/portmobile/file/StandardCopyOption.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/util/OfflineSorter must not be compiled with ARC (-fobjc-arc)"
#endif

#pragma clang diagnostic ignored "-Wincomplete-implementation"

@interface OrgApacheLuceneUtilOfflineSorter () {
 @public
  OrgApacheLuceneUtilOfflineSorter_BufferSize *ramBufferSize_;
  OrgLukhnosPortmobileFilePath *tempDirectory_;
  OrgApacheLuceneUtilCounter *bufferBytesUsed_;
  OrgApacheLuceneUtilBytesRefArray *buffer_;
  OrgApacheLuceneUtilOfflineSorter_SortInfo *sortInfo_;
  jint maxTempFiles_;
  id<JavaUtilComparator> comparator_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilOfflineSorter, ramBufferSize_, OrgApacheLuceneUtilOfflineSorter_BufferSize *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilOfflineSorter, tempDirectory_, OrgLukhnosPortmobileFilePath *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilOfflineSorter, bufferBytesUsed_, OrgApacheLuceneUtilCounter *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilOfflineSorter, buffer_, OrgApacheLuceneUtilBytesRefArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilOfflineSorter, sortInfo_, OrgApacheLuceneUtilOfflineSorter_SortInfo *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilOfflineSorter, comparator_, id<JavaUtilComparator>)

inline NSString *OrgApacheLuceneUtilOfflineSorter_get_MIN_BUFFER_SIZE_MSG(void);
static NSString *OrgApacheLuceneUtilOfflineSorter_MIN_BUFFER_SIZE_MSG = @"At least 0.5MB RAM buffer is needed";
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgApacheLuceneUtilOfflineSorter, MIN_BUFFER_SIZE_MSG, NSString *)

@interface OrgApacheLuceneUtilOfflineSorter_BufferSize ()

- (instancetype)initWithLong:(jlong)bytes;

@end

__attribute__((unused)) static void OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(OrgApacheLuceneUtilOfflineSorter_BufferSize *self, jlong bytes);

__attribute__((unused)) static OrgApacheLuceneUtilOfflineSorter_BufferSize *new_OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(jlong bytes) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneUtilOfflineSorter_BufferSize *create_OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(jlong bytes);

@interface OrgApacheLuceneUtilOfflineSorter_1 : OrgApacheLuceneUtilPriorityQueue {
 @public
  OrgApacheLuceneUtilOfflineSorter *this$0_;
}

- (instancetype)initWithOrgApacheLuceneUtilOfflineSorter:(OrgApacheLuceneUtilOfflineSorter *)outer$
                                                 withInt:(jint)maxSize;

- (jboolean)lessThanWithId:(OrgApacheLuceneUtilOfflineSorter_FileAndTop *)a
                    withId:(OrgApacheLuceneUtilOfflineSorter_FileAndTop *)b;

- (OrgApacheLuceneUtilOfflineSorter_FileAndTop *)pop;

- (OrgApacheLuceneUtilOfflineSorter_FileAndTop *)top;

- (OrgApacheLuceneUtilOfflineSorter_FileAndTop *)insertWithOverflowWithId:(OrgApacheLuceneUtilOfflineSorter_FileAndTop *)arg0;

- (OrgApacheLuceneUtilOfflineSorter_FileAndTop *)addWithId:(OrgApacheLuceneUtilOfflineSorter_FileAndTop *)arg0;

- (OrgApacheLuceneUtilOfflineSorter_FileAndTop *)getSentinelObject;

- (OrgApacheLuceneUtilOfflineSorter_FileAndTop *)updateTopWithId:(OrgApacheLuceneUtilOfflineSorter_FileAndTop *)arg0;

- (OrgApacheLuceneUtilOfflineSorter_FileAndTop *)updateTop;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneUtilOfflineSorter_1)

__attribute__((unused)) static void OrgApacheLuceneUtilOfflineSorter_1_initWithOrgApacheLuceneUtilOfflineSorter_withInt_(OrgApacheLuceneUtilOfflineSorter_1 *self, OrgApacheLuceneUtilOfflineSorter *outer$, jint maxSize);

__attribute__((unused)) static OrgApacheLuceneUtilOfflineSorter_1 *new_OrgApacheLuceneUtilOfflineSorter_1_initWithOrgApacheLuceneUtilOfflineSorter_withInt_(OrgApacheLuceneUtilOfflineSorter *outer$, jint maxSize) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneUtilOfflineSorter_1 *create_OrgApacheLuceneUtilOfflineSorter_1_initWithOrgApacheLuceneUtilOfflineSorter_withInt_(OrgApacheLuceneUtilOfflineSorter *outer$, jint maxSize);

@interface OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter () {
 @public
  id<JavaIoDataOutput> os_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter, os_, id<JavaIoDataOutput>)

@interface OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader () {
 @public
  id<JavaIoDataInput> is_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader, is_, id<JavaIoDataInput>)

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneUtilOfflineSorter)

id<JavaUtilComparator> OrgApacheLuceneUtilOfflineSorter_DEFAULT_COMPARATOR;

@implementation OrgApacheLuceneUtilOfflineSorter

+ (jlong)MB {
  return OrgApacheLuceneUtilOfflineSorter_MB;
}

+ (jlong)GB {
  return OrgApacheLuceneUtilOfflineSorter_GB;
}

+ (jlong)MIN_BUFFER_SIZE_MB {
  return OrgApacheLuceneUtilOfflineSorter_MIN_BUFFER_SIZE_MB;
}

+ (jlong)ABSOLUTE_MIN_SORT_BUFFER_SIZE {
  return OrgApacheLuceneUtilOfflineSorter_ABSOLUTE_MIN_SORT_BUFFER_SIZE;
}

+ (jint)MAX_TEMPFILES {
  return OrgApacheLuceneUtilOfflineSorter_MAX_TEMPFILES;
}

+ (id<JavaUtilComparator>)DEFAULT_COMPARATOR {
  return OrgApacheLuceneUtilOfflineSorter_DEFAULT_COMPARATOR;
}

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneUtilOfflineSorter_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (instancetype)initWithJavaUtilComparator:(id<JavaUtilComparator>)comparator {
  OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_(self, comparator);
  return self;
}

- (instancetype)initWithJavaUtilComparator:(id<JavaUtilComparator>)comparator
withOrgApacheLuceneUtilOfflineSorter_BufferSize:(OrgApacheLuceneUtilOfflineSorter_BufferSize *)ramBufferSize
          withOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)tempDirectory
                                   withInt:(jint)maxTempfiles {
  OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_withOrgApacheLuceneUtilOfflineSorter_BufferSize_withOrgLukhnosPortmobileFilePath_withInt_(self, comparator, ramBufferSize, tempDirectory, maxTempfiles);
  return self;
}

- (OrgApacheLuceneUtilOfflineSorter_SortInfo *)sortWithOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)input
                                                   withOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)output {
  JreStrongAssignAndConsume(&sortInfo_, new_OrgApacheLuceneUtilOfflineSorter_SortInfo_initWithOrgApacheLuceneUtilOfflineSorter_(self));
  sortInfo_->totalTime_ = JavaLangSystem_currentTimeMillis();
  OrgLukhnosPortmobileFileFiles_deleteIfExistsWithOrgLukhnosPortmobileFilePath_(output);
  JavaUtilArrayList *merges = create_JavaUtilArrayList_init();
  jboolean success3 = false;
  @try {
    OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *is = create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithOrgLukhnosPortmobileFilePath_(input);
    jboolean success = false;
    @try {
      jint lines = 0;
      while ((lines = [self readPartitionWithOrgApacheLuceneUtilOfflineSorter_ByteSequencesReader:is]) > 0) {
        [merges addWithId:[self sortPartitionWithInt:lines]];
        ((OrgApacheLuceneUtilOfflineSorter_SortInfo *) nil_chk(sortInfo_))->tempMergeFiles_++;
        sortInfo_->lines_ += lines;
        if ([merges size] == maxTempFiles_) {
          OrgLukhnosPortmobileFilePath *intermediate = OrgLukhnosPortmobileFileFiles_createTempFileWithOrgLukhnosPortmobileFilePath_withNSString_withNSString_(tempDirectory_, @"sort", @"intermediate");
          jboolean success2 = false;
          @try {
            [self mergePartitionsWithJavaUtilList:merges withOrgLukhnosPortmobileFilePath:intermediate];
            success2 = true;
          }
          @finally {
            if (success2) {
              OrgApacheLuceneUtilIOUtils_deleteFilesIfExistWithJavaUtilCollection_(merges);
            }
            else {
              OrgApacheLuceneUtilIOUtils_deleteFilesIgnoringExceptionsWithJavaUtilCollection_(merges);
            }
            [merges clear];
            [merges addWithId:intermediate];
          }
          ((OrgApacheLuceneUtilOfflineSorter_SortInfo *) nil_chk(sortInfo_))->tempMergeFiles_++;
        }
      }
      success = true;
    }
    @finally {
      if (success) OrgApacheLuceneUtilIOUtils_closeWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ is } count:1 type:JavaIoCloseable_class_()]);
      else OrgApacheLuceneUtilIOUtils_closeWhileHandlingExceptionWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ is } count:1 type:JavaIoCloseable_class_()]);
    }
    if ([merges size] == 1) {
      OrgLukhnosPortmobileFilePath *single = JreRetainedLocalValue([merges getWithInt:0]);
      @try {
        OrgLukhnosPortmobileFileFiles_moveWithOrgLukhnosPortmobileFilePath_withOrgLukhnosPortmobileFilePath_withOrgLukhnosPortmobileFileStandardCopyOptionArray_(single, output, [IOSObjectArray arrayWithObjects:(id[]){ JreLoadStatic(OrgLukhnosPortmobileFileStandardCopyOption, ATOMIC_MOVE) } count:1 type:OrgLukhnosPortmobileFileStandardCopyOption_class_()]);
      }
      @catch (JavaIoIOException *e) {
        OrgLukhnosPortmobileFileFiles_copy__WithOrgLukhnosPortmobileFilePath_withOrgLukhnosPortmobileFilePath_withOrgLukhnosPortmobileFileStandardCopyOptionArray_(single, output, [IOSObjectArray arrayWithLength:0 type:OrgLukhnosPortmobileFileStandardCopyOption_class_()]);
      }
      @catch (JavaLangUnsupportedOperationException *e) {
        OrgLukhnosPortmobileFileFiles_copy__WithOrgLukhnosPortmobileFilePath_withOrgLukhnosPortmobileFilePath_withOrgLukhnosPortmobileFileStandardCopyOptionArray_(single, output, [IOSObjectArray arrayWithLength:0 type:OrgLukhnosPortmobileFileStandardCopyOption_class_()]);
      }
    }
    else {
      [self mergePartitionsWithJavaUtilList:merges withOrgLukhnosPortmobileFilePath:output];
    }
    success3 = true;
  }
  @finally {
    if (success3) {
      OrgApacheLuceneUtilIOUtils_deleteFilesIfExistWithJavaUtilCollection_(merges);
    }
    else {
      OrgApacheLuceneUtilIOUtils_deleteFilesIgnoringExceptionsWithJavaUtilCollection_(merges);
      OrgApacheLuceneUtilIOUtils_deleteFilesIgnoringExceptionsWithOrgLukhnosPortmobileFilePathArray_([IOSObjectArray arrayWithObjects:(id[]){ output } count:1 type:OrgLukhnosPortmobileFilePath_class_()]);
    }
  }
  ((OrgApacheLuceneUtilOfflineSorter_SortInfo *) nil_chk(sortInfo_))->totalTime_ = (JavaLangSystem_currentTimeMillis() - ((OrgApacheLuceneUtilOfflineSorter_SortInfo *) nil_chk(sortInfo_))->totalTime_);
  return sortInfo_;
}

+ (OrgLukhnosPortmobileFilePath *)defaultTempDir {
  return OrgApacheLuceneUtilOfflineSorter_defaultTempDir();
}

- (OrgLukhnosPortmobileFilePath *)sortPartitionWithInt:(jint)len {
  OrgApacheLuceneUtilBytesRefArray *data = JreRetainedLocalValue(self->buffer_);
  OrgLukhnosPortmobileFilePath *tempFile = OrgLukhnosPortmobileFileFiles_createTempFileWithOrgLukhnosPortmobileFilePath_withNSString_withNSString_(tempDirectory_, @"sort", @"partition");
  jlong start = JavaLangSystem_currentTimeMillis();
  ((OrgApacheLuceneUtilOfflineSorter_SortInfo *) nil_chk(sortInfo_))->sortTime_ += (JavaLangSystem_currentTimeMillis() - start);
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *out = create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithOrgLukhnosPortmobileFilePath_(tempFile);
  OrgApacheLuceneUtilBytesRef *spare;
  @try {
    id<OrgApacheLuceneUtilBytesRefIterator> iter = JreRetainedLocalValue([((OrgApacheLuceneUtilBytesRefArray *) nil_chk(buffer_)) iteratorWithJavaUtilComparator:comparator_]);
    while ((spare = [((id<OrgApacheLuceneUtilBytesRefIterator>) nil_chk(iter)) next]) != nil) {
      JreAssert(((OrgApacheLuceneUtilBytesRef *) nil_chk(spare))->length_ <= JavaLangShort_MAX_VALUE, @"org/apache/lucene/util/OfflineSorter.java:324 condition failed: assert spare.length <= Short.MAX_VALUE;");
      [out writeWithOrgApacheLuceneUtilBytesRef:spare];
    }
    [out close];
    [((OrgApacheLuceneUtilBytesRefArray *) nil_chk(data)) clear];
    return tempFile;
  }
  @finally {
    OrgApacheLuceneUtilIOUtils_closeWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ out } count:1 type:JavaIoCloseable_class_()]);
  }
}

- (void)mergePartitionsWithJavaUtilList:(id<JavaUtilList>)merges
       withOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)outputFile {
  jlong start = JavaLangSystem_currentTimeMillis();
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *out = create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithOrgLukhnosPortmobileFilePath_(outputFile);
  OrgApacheLuceneUtilPriorityQueue *queue = create_OrgApacheLuceneUtilOfflineSorter_1_initWithOrgApacheLuceneUtilOfflineSorter_withInt_(self, [((id<JavaUtilList>) nil_chk(merges)) size]);
  IOSObjectArray *streams = [IOSObjectArray arrayWithLength:[merges size] type:OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_class_()];
  @try {
    for (jint i = 0; i < [merges size]; i++) {
      IOSObjectArray_SetAndConsume(streams, i, new_OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithOrgLukhnosPortmobileFilePath_([merges getWithInt:i]));
      IOSByteArray *line = [((OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *) nil_chk(IOSObjectArray_Get(streams, i))) read];
      if (line != nil) {
        [queue insertWithOverflowWithId:create_OrgApacheLuceneUtilOfflineSorter_FileAndTop_initWithInt_withByteArray_(i, line)];
      }
    }
    OrgApacheLuceneUtilOfflineSorter_FileAndTop *top;
    while ((top = [queue top]) != nil) {
      [out writeWithByteArray:[((OrgApacheLuceneUtilBytesRefBuilder *) nil_chk(((OrgApacheLuceneUtilOfflineSorter_FileAndTop *) nil_chk(top))->current_)) bytes] withInt:0 withInt:[top->current_ length]];
      if (![((OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *) nil_chk(IOSObjectArray_Get(streams, top->fd_))) readWithOrgApacheLuceneUtilBytesRefBuilder:top->current_]) {
        [queue pop];
      }
      else {
        [queue updateTop];
      }
    }
    ((OrgApacheLuceneUtilOfflineSorter_SortInfo *) nil_chk(sortInfo_))->mergeTime_ += JavaLangSystem_currentTimeMillis() - start;
    ((OrgApacheLuceneUtilOfflineSorter_SortInfo *) nil_chk(sortInfo_))->mergeRounds_++;
  }
  @finally {
    @try {
      OrgApacheLuceneUtilIOUtils_closeWithJavaIoCloseableArray_(streams);
    }
    @finally {
      OrgApacheLuceneUtilIOUtils_closeWithJavaIoCloseableArray_([IOSObjectArray arrayWithObjects:(id[]){ out } count:1 type:JavaIoCloseable_class_()]);
    }
  }
}

- (jint)readPartitionWithOrgApacheLuceneUtilOfflineSorter_ByteSequencesReader:(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *)reader {
  jlong start = JavaLangSystem_currentTimeMillis();
  OrgApacheLuceneUtilBytesRef *scratch = create_OrgApacheLuceneUtilBytesRef_init();
  while ((JreStrongAssign(&scratch->bytes_, [((OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *) nil_chk(reader)) read])) != nil) {
    scratch->length_ = ((IOSByteArray *) nil_chk(scratch->bytes_))->size_;
    [((OrgApacheLuceneUtilBytesRefArray *) nil_chk(buffer_)) appendWithOrgApacheLuceneUtilBytesRef:scratch];
    if (((OrgApacheLuceneUtilOfflineSorter_BufferSize *) nil_chk(ramBufferSize_))->bytes_ < [((OrgApacheLuceneUtilCounter *) nil_chk(bufferBytesUsed_)) get]) {
      break;
    }
  }
  ((OrgApacheLuceneUtilOfflineSorter_SortInfo *) nil_chk(sortInfo_))->readTime_ += (JavaLangSystem_currentTimeMillis() - start);
  return [((OrgApacheLuceneUtilBytesRefArray *) nil_chk(buffer_)) size];
}

- (id<JavaUtilComparator>)getComparator {
  return comparator_;
}

- (void)dealloc {
  RELEASE_(ramBufferSize_);
  RELEASE_(tempDirectory_);
  RELEASE_(bufferBytesUsed_);
  RELEASE_(buffer_);
  RELEASE_(sortInfo_);
  RELEASE_(comparator_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, 0, -1, -1, -1 },
    { NULL, NULL, 0x1, -1, 1, 0, 2, -1, -1 },
    { NULL, NULL, 0x1, -1, 3, -1, 4, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilOfflineSorter_SortInfo;", 0x1, 5, 6, 0, -1, -1, -1 },
    { NULL, "LOrgLukhnosPortmobileFilePath;", 0x9, -1, -1, 0, -1, -1, -1 },
    { NULL, "LOrgLukhnosPortmobileFilePath;", 0x4, 7, 8, 0, -1, -1, -1 },
    { NULL, "V", 0x0, 9, 10, 0, 11, -1, -1 },
    { NULL, "I", 0x0, 12, 13, 0, -1, -1, -1 },
    { NULL, "LJavaUtilComparator;", 0x1, -1, -1, -1, 14, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(initWithJavaUtilComparator:);
  methods[2].selector = @selector(initWithJavaUtilComparator:withOrgApacheLuceneUtilOfflineSorter_BufferSize:withOrgLukhnosPortmobileFilePath:withInt:);
  methods[3].selector = @selector(sortWithOrgLukhnosPortmobileFilePath:withOrgLukhnosPortmobileFilePath:);
  methods[4].selector = @selector(defaultTempDir);
  methods[5].selector = @selector(sortPartitionWithInt:);
  methods[6].selector = @selector(mergePartitionsWithJavaUtilList:withOrgLukhnosPortmobileFilePath:);
  methods[7].selector = @selector(readPartitionWithOrgApacheLuceneUtilOfflineSorter_ByteSequencesReader:);
  methods[8].selector = @selector(getComparator);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "MB", "J", .constantValue.asLong = OrgApacheLuceneUtilOfflineSorter_MB, 0x19, -1, -1, -1, -1 },
    { "GB", "J", .constantValue.asLong = OrgApacheLuceneUtilOfflineSorter_GB, 0x19, -1, -1, -1, -1 },
    { "MIN_BUFFER_SIZE_MB", "J", .constantValue.asLong = OrgApacheLuceneUtilOfflineSorter_MIN_BUFFER_SIZE_MB, 0x19, -1, -1, -1, -1 },
    { "ABSOLUTE_MIN_SORT_BUFFER_SIZE", "J", .constantValue.asLong = OrgApacheLuceneUtilOfflineSorter_ABSOLUTE_MIN_SORT_BUFFER_SIZE, 0x19, -1, -1, -1, -1 },
    { "MIN_BUFFER_SIZE_MSG", "LNSString;", .constantValue.asLong = 0, 0x1a, -1, 15, -1, -1 },
    { "MAX_TEMPFILES", "I", .constantValue.asInt = OrgApacheLuceneUtilOfflineSorter_MAX_TEMPFILES, 0x19, -1, -1, -1, -1 },
    { "ramBufferSize_", "LOrgApacheLuceneUtilOfflineSorter_BufferSize;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "tempDirectory_", "LOrgLukhnosPortmobileFilePath;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "bufferBytesUsed_", "LOrgApacheLuceneUtilCounter;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "buffer_", "LOrgApacheLuceneUtilBytesRefArray;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "sortInfo_", "LOrgApacheLuceneUtilOfflineSorter_SortInfo;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "maxTempFiles_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "comparator_", "LJavaUtilComparator;", .constantValue.asLong = 0, 0x12, -1, -1, 16, -1 },
    { "DEFAULT_COMPARATOR", "LJavaUtilComparator;", .constantValue.asLong = 0, 0x19, -1, 17, 16, -1 },
  };
  static const void *ptrTable[] = { "LJavaIoIOException;", "LJavaUtilComparator;", "(Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;)V", "LJavaUtilComparator;LOrgApacheLuceneUtilOfflineSorter_BufferSize;LOrgLukhnosPortmobileFilePath;I", "(Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;Lorg/apache/lucene/util/OfflineSorter$BufferSize;Lorg/lukhnos/portmobile/file/Path;I)V", "sort", "LOrgLukhnosPortmobileFilePath;LOrgLukhnosPortmobileFilePath;", "sortPartition", "I", "mergePartitions", "LJavaUtilList;LOrgLukhnosPortmobileFilePath;", "(Ljava/util/List<Lorg/lukhnos/portmobile/file/Path;>;Lorg/lukhnos/portmobile/file/Path;)V", "readPartition", "LOrgApacheLuceneUtilOfflineSorter_ByteSequencesReader;", "()Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;", &OrgApacheLuceneUtilOfflineSorter_MIN_BUFFER_SIZE_MSG, "Ljava/util/Comparator<Lorg/apache/lucene/util/BytesRef;>;", &OrgApacheLuceneUtilOfflineSorter_DEFAULT_COMPARATOR, "LOrgApacheLuceneUtilOfflineSorter_BufferSize;LOrgApacheLuceneUtilOfflineSorter_SortInfo;LOrgApacheLuceneUtilOfflineSorter_FileAndTop;LOrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter;LOrgApacheLuceneUtilOfflineSorter_ByteSequencesReader;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilOfflineSorter = { "OfflineSorter", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0x11, 9, 14, -1, 18, -1, -1, -1 };
  return &_OrgApacheLuceneUtilOfflineSorter;
}

+ (void)initialize {
  if (self == [OrgApacheLuceneUtilOfflineSorter class]) {
    JreStrongAssign(&OrgApacheLuceneUtilOfflineSorter_DEFAULT_COMPARATOR, OrgApacheLuceneUtilBytesRef_getUTF8SortedAsUnicodeComparator());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneUtilOfflineSorter)
  }
}

@end

void OrgApacheLuceneUtilOfflineSorter_init(OrgApacheLuceneUtilOfflineSorter *self) {
  OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_withOrgApacheLuceneUtilOfflineSorter_BufferSize_withOrgLukhnosPortmobileFilePath_withInt_(self, OrgApacheLuceneUtilOfflineSorter_DEFAULT_COMPARATOR, OrgApacheLuceneUtilOfflineSorter_BufferSize_automatic(), OrgApacheLuceneUtilOfflineSorter_defaultTempDir(), OrgApacheLuceneUtilOfflineSorter_MAX_TEMPFILES);
}

OrgApacheLuceneUtilOfflineSorter *new_OrgApacheLuceneUtilOfflineSorter_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter, init)
}

OrgApacheLuceneUtilOfflineSorter *create_OrgApacheLuceneUtilOfflineSorter_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter, init)
}

void OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_(OrgApacheLuceneUtilOfflineSorter *self, id<JavaUtilComparator> comparator) {
  OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_withOrgApacheLuceneUtilOfflineSorter_BufferSize_withOrgLukhnosPortmobileFilePath_withInt_(self, comparator, OrgApacheLuceneUtilOfflineSorter_BufferSize_automatic(), OrgApacheLuceneUtilOfflineSorter_defaultTempDir(), OrgApacheLuceneUtilOfflineSorter_MAX_TEMPFILES);
}

OrgApacheLuceneUtilOfflineSorter *new_OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_(id<JavaUtilComparator> comparator) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter, initWithJavaUtilComparator_, comparator)
}

OrgApacheLuceneUtilOfflineSorter *create_OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_(id<JavaUtilComparator> comparator) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter, initWithJavaUtilComparator_, comparator)
}

void OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_withOrgApacheLuceneUtilOfflineSorter_BufferSize_withOrgLukhnosPortmobileFilePath_withInt_(OrgApacheLuceneUtilOfflineSorter *self, id<JavaUtilComparator> comparator, OrgApacheLuceneUtilOfflineSorter_BufferSize *ramBufferSize, OrgLukhnosPortmobileFilePath *tempDirectory, jint maxTempfiles) {
  NSObject_init(self);
  JreStrongAssign(&self->bufferBytesUsed_, OrgApacheLuceneUtilCounter_newCounter());
  JreStrongAssignAndConsume(&self->buffer_, new_OrgApacheLuceneUtilBytesRefArray_initWithOrgApacheLuceneUtilCounter_(self->bufferBytesUsed_));
  if (((OrgApacheLuceneUtilOfflineSorter_BufferSize *) nil_chk(ramBufferSize))->bytes_ < OrgApacheLuceneUtilOfflineSorter_ABSOLUTE_MIN_SORT_BUFFER_SIZE) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$$I", OrgApacheLuceneUtilOfflineSorter_MIN_BUFFER_SIZE_MSG, @": ", ramBufferSize->bytes_));
  }
  if (maxTempfiles < 2) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(@"maxTempFiles must be >= 2");
  }
  JreStrongAssign(&self->ramBufferSize_, ramBufferSize);
  JreStrongAssign(&self->tempDirectory_, tempDirectory);
  self->maxTempFiles_ = maxTempfiles;
  JreStrongAssign(&self->comparator_, comparator);
}

OrgApacheLuceneUtilOfflineSorter *new_OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_withOrgApacheLuceneUtilOfflineSorter_BufferSize_withOrgLukhnosPortmobileFilePath_withInt_(id<JavaUtilComparator> comparator, OrgApacheLuceneUtilOfflineSorter_BufferSize *ramBufferSize, OrgLukhnosPortmobileFilePath *tempDirectory, jint maxTempfiles) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter, initWithJavaUtilComparator_withOrgApacheLuceneUtilOfflineSorter_BufferSize_withOrgLukhnosPortmobileFilePath_withInt_, comparator, ramBufferSize, tempDirectory, maxTempfiles)
}

OrgApacheLuceneUtilOfflineSorter *create_OrgApacheLuceneUtilOfflineSorter_initWithJavaUtilComparator_withOrgApacheLuceneUtilOfflineSorter_BufferSize_withOrgLukhnosPortmobileFilePath_withInt_(id<JavaUtilComparator> comparator, OrgApacheLuceneUtilOfflineSorter_BufferSize *ramBufferSize, OrgLukhnosPortmobileFilePath *tempDirectory, jint maxTempfiles) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter, initWithJavaUtilComparator_withOrgApacheLuceneUtilOfflineSorter_BufferSize_withOrgLukhnosPortmobileFilePath_withInt_, comparator, ramBufferSize, tempDirectory, maxTempfiles)
}

OrgLukhnosPortmobileFilePath *OrgApacheLuceneUtilOfflineSorter_defaultTempDir() {
  OrgApacheLuceneUtilOfflineSorter_initialize();
  NSString *tempDirPath = JavaLangSystem_getPropertyWithNSString_(@"java.io.tmpdir");
  if (tempDirPath == nil) @throw create_JavaIoIOException_initWithNSString_(@"Java has no temporary folder property (java.io.tmpdir)?");
  OrgLukhnosPortmobileFilePath *tempDirectory = OrgLukhnosPortmobileFilePaths_getWithNSString_(tempDirPath);
  if (!OrgLukhnosPortmobileFileFiles_isWritableWithOrgLukhnosPortmobileFilePath_(tempDirectory)) {
    @throw create_JavaIoIOException_initWithNSString_(JreStrcat("$@", @"Java's temporary folder not present or writeable?: ", [((OrgLukhnosPortmobileFilePath *) nil_chk(tempDirectory)) toAbsolutePath]));
  }
  return tempDirectory;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilOfflineSorter)

@implementation OrgApacheLuceneUtilOfflineSorter_BufferSize

- (instancetype)initWithLong:(jlong)bytes {
  OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(self, bytes);
  return self;
}

+ (OrgApacheLuceneUtilOfflineSorter_BufferSize *)megabytesWithLong:(jlong)mb {
  return OrgApacheLuceneUtilOfflineSorter_BufferSize_megabytesWithLong_(mb);
}

+ (OrgApacheLuceneUtilOfflineSorter_BufferSize *)automatic {
  return OrgApacheLuceneUtilOfflineSorter_BufferSize_automatic();
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x2, -1, 0, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilOfflineSorter_BufferSize;", 0x9, 1, 0, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilOfflineSorter_BufferSize;", 0x9, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithLong:);
  methods[1].selector = @selector(megabytesWithLong:);
  methods[2].selector = @selector(automatic);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "bytes_", "I", .constantValue.asLong = 0, 0x10, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "J", "megabytes", "LOrgApacheLuceneUtilOfflineSorter;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilOfflineSorter_BufferSize = { "BufferSize", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0x19, 3, 1, 2, -1, -1, -1, -1 };
  return &_OrgApacheLuceneUtilOfflineSorter_BufferSize;
}

@end

void OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(OrgApacheLuceneUtilOfflineSorter_BufferSize *self, jlong bytes) {
  NSObject_init(self);
  if (bytes > JavaLangInteger_MAX_VALUE) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$J$J", @"Buffer too large for Java (", (JreLongDiv(JavaLangInteger_MAX_VALUE, OrgApacheLuceneUtilOfflineSorter_MB)), @"mb max): ", bytes));
  }
  if (bytes < OrgApacheLuceneUtilOfflineSorter_ABSOLUTE_MIN_SORT_BUFFER_SIZE) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$$J", OrgApacheLuceneUtilOfflineSorter_MIN_BUFFER_SIZE_MSG, @": ", bytes));
  }
  self->bytes_ = (jint) bytes;
}

OrgApacheLuceneUtilOfflineSorter_BufferSize *new_OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(jlong bytes) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter_BufferSize, initWithLong_, bytes)
}

OrgApacheLuceneUtilOfflineSorter_BufferSize *create_OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(jlong bytes) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter_BufferSize, initWithLong_, bytes)
}

OrgApacheLuceneUtilOfflineSorter_BufferSize *OrgApacheLuceneUtilOfflineSorter_BufferSize_megabytesWithLong_(jlong mb) {
  OrgApacheLuceneUtilOfflineSorter_BufferSize_initialize();
  return create_OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(mb * OrgApacheLuceneUtilOfflineSorter_MB);
}

OrgApacheLuceneUtilOfflineSorter_BufferSize *OrgApacheLuceneUtilOfflineSorter_BufferSize_automatic() {
  OrgApacheLuceneUtilOfflineSorter_BufferSize_initialize();
  JavaLangRuntime *rt = JavaLangRuntime_getRuntime();
  jlong max = [((JavaLangRuntime *) nil_chk(rt)) maxMemory];
  jlong total = [rt totalMemory];
  jlong free = [rt freeMemory];
  jlong totalAvailableBytes = max - total + free;
  jlong sortBufferByteSize = JreLongDiv(free, 2);
  jlong minBufferSizeBytes = OrgApacheLuceneUtilOfflineSorter_MIN_BUFFER_SIZE_MB * OrgApacheLuceneUtilOfflineSorter_MB;
  if (sortBufferByteSize < minBufferSizeBytes || totalAvailableBytes > 10 * minBufferSizeBytes) {
    if (JreLongDiv(totalAvailableBytes, 2) > minBufferSizeBytes) {
      sortBufferByteSize = JreLongDiv(totalAvailableBytes, 2);
    }
    else {
      sortBufferByteSize = JavaLangMath_maxWithLong_withLong_(OrgApacheLuceneUtilOfflineSorter_ABSOLUTE_MIN_SORT_BUFFER_SIZE, sortBufferByteSize);
    }
  }
  return create_OrgApacheLuceneUtilOfflineSorter_BufferSize_initWithLong_(JavaLangMath_minWithLong_withLong_((jlong) JavaLangInteger_MAX_VALUE, sortBufferByteSize));
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilOfflineSorter_BufferSize)

@implementation OrgApacheLuceneUtilOfflineSorter_SortInfo

- (instancetype)initWithOrgApacheLuceneUtilOfflineSorter:(OrgApacheLuceneUtilOfflineSorter *)outer$ {
  OrgApacheLuceneUtilOfflineSorter_SortInfo_initWithOrgApacheLuceneUtilOfflineSorter_(self, outer$);
  return self;
}

- (NSString *)description {
  return NSString_java_formatWithJavaUtilLocale_withNSString_withNSObjectArray_(JreLoadStatic(JavaUtilLocale, ROOT), @"time=%.2f sec. total (%.2f reading, %.2f sorting, %.2f merging), lines=%d, temp files=%d, merges=%d, soft ram limit=%.2f MB", [IOSObjectArray arrayWithObjects:(id[]){ JavaLangDouble_valueOfWithDouble_(totalTime_ / 1000.0), JavaLangDouble_valueOfWithDouble_(readTime_ / 1000.0), JavaLangDouble_valueOfWithDouble_(sortTime_ / 1000.0), JavaLangDouble_valueOfWithDouble_(mergeTime_ / 1000.0), JavaLangInteger_valueOfWithInt_(lines_), JavaLangInteger_valueOfWithInt_(tempMergeFiles_), JavaLangInteger_valueOfWithInt_(mergeRounds_), JavaLangDouble_valueOfWithDouble_((jdouble) bufferSize_ / OrgApacheLuceneUtilOfflineSorter_MB) } count:8 type:NSObject_class_()]);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "LNSString;", 0x1, 1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneUtilOfflineSorter:);
  methods[1].selector = @selector(description);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "tempMergeFiles_", "I", .constantValue.asLong = 0, 0x1, -1, -1, -1, -1 },
    { "mergeRounds_", "I", .constantValue.asLong = 0, 0x1, -1, -1, -1, -1 },
    { "lines_", "I", .constantValue.asLong = 0, 0x1, -1, -1, -1, -1 },
    { "mergeTime_", "J", .constantValue.asLong = 0, 0x1, -1, -1, -1, -1 },
    { "sortTime_", "J", .constantValue.asLong = 0, 0x1, -1, -1, -1, -1 },
    { "totalTime_", "J", .constantValue.asLong = 0, 0x1, -1, -1, -1, -1 },
    { "readTime_", "J", .constantValue.asLong = 0, 0x1, -1, -1, -1, -1 },
    { "bufferSize_", "J", .constantValue.asLong = 0, 0x11, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneUtilOfflineSorter;", "toString" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilOfflineSorter_SortInfo = { "SortInfo", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0x1, 2, 8, 0, -1, -1, -1, -1 };
  return &_OrgApacheLuceneUtilOfflineSorter_SortInfo;
}

@end

void OrgApacheLuceneUtilOfflineSorter_SortInfo_initWithOrgApacheLuceneUtilOfflineSorter_(OrgApacheLuceneUtilOfflineSorter_SortInfo *self, OrgApacheLuceneUtilOfflineSorter *outer$) {
  NSObject_init(self);
  self->bufferSize_ = ((OrgApacheLuceneUtilOfflineSorter_BufferSize *) nil_chk(outer$->ramBufferSize_))->bytes_;
}

OrgApacheLuceneUtilOfflineSorter_SortInfo *new_OrgApacheLuceneUtilOfflineSorter_SortInfo_initWithOrgApacheLuceneUtilOfflineSorter_(OrgApacheLuceneUtilOfflineSorter *outer$) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter_SortInfo, initWithOrgApacheLuceneUtilOfflineSorter_, outer$)
}

OrgApacheLuceneUtilOfflineSorter_SortInfo *create_OrgApacheLuceneUtilOfflineSorter_SortInfo_initWithOrgApacheLuceneUtilOfflineSorter_(OrgApacheLuceneUtilOfflineSorter *outer$) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter_SortInfo, initWithOrgApacheLuceneUtilOfflineSorter_, outer$)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilOfflineSorter_SortInfo)

@implementation OrgApacheLuceneUtilOfflineSorter_1

- (instancetype)initWithOrgApacheLuceneUtilOfflineSorter:(OrgApacheLuceneUtilOfflineSorter *)outer$
                                                 withInt:(jint)maxSize {
  OrgApacheLuceneUtilOfflineSorter_1_initWithOrgApacheLuceneUtilOfflineSorter_withInt_(self, outer$, maxSize);
  return self;
}

- (jboolean)lessThanWithId:(OrgApacheLuceneUtilOfflineSorter_FileAndTop *)a
                    withId:(OrgApacheLuceneUtilOfflineSorter_FileAndTop *)b {
  return [((id<JavaUtilComparator>) nil_chk(this$0_->comparator_)) compareWithId:[((OrgApacheLuceneUtilBytesRefBuilder *) nil_chk(((OrgApacheLuceneUtilOfflineSorter_FileAndTop *) nil_chk(a))->current_)) get] withId:[((OrgApacheLuceneUtilOfflineSorter_FileAndTop *) nil_chk(b))->current_ get]] < 0;
}

- (void)dealloc {
  RELEASE_(this$0_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
    { NULL, "Z", 0x4, 1, 2, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneUtilOfflineSorter:withInt:);
  methods[1].selector = @selector(lessThanWithId:withId:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", "LOrgApacheLuceneUtilOfflineSorter;", .constantValue.asLong = 0, 0x1012, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneUtilOfflineSorter;I", "lessThan", "LOrgApacheLuceneUtilOfflineSorter_FileAndTop;LOrgApacheLuceneUtilOfflineSorter_FileAndTop;", "LOrgApacheLuceneUtilOfflineSorter;", "mergePartitionsWithJavaUtilList:withOrgLukhnosPortmobileFilePath:", "Lorg/apache/lucene/util/PriorityQueue<Lorg/apache/lucene/util/OfflineSorter$FileAndTop;>;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilOfflineSorter_1 = { "", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0x8010, 2, 1, 3, -1, 4, 5, -1 };
  return &_OrgApacheLuceneUtilOfflineSorter_1;
}

@end

void OrgApacheLuceneUtilOfflineSorter_1_initWithOrgApacheLuceneUtilOfflineSorter_withInt_(OrgApacheLuceneUtilOfflineSorter_1 *self, OrgApacheLuceneUtilOfflineSorter *outer$, jint maxSize) {
  JreStrongAssign(&self->this$0_, outer$);
  OrgApacheLuceneUtilPriorityQueue_initWithInt_(self, maxSize);
}

OrgApacheLuceneUtilOfflineSorter_1 *new_OrgApacheLuceneUtilOfflineSorter_1_initWithOrgApacheLuceneUtilOfflineSorter_withInt_(OrgApacheLuceneUtilOfflineSorter *outer$, jint maxSize) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter_1, initWithOrgApacheLuceneUtilOfflineSorter_withInt_, outer$, maxSize)
}

OrgApacheLuceneUtilOfflineSorter_1 *create_OrgApacheLuceneUtilOfflineSorter_1_initWithOrgApacheLuceneUtilOfflineSorter_withInt_(OrgApacheLuceneUtilOfflineSorter *outer$, jint maxSize) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter_1, initWithOrgApacheLuceneUtilOfflineSorter_withInt_, outer$, maxSize)
}

@implementation OrgApacheLuceneUtilOfflineSorter_FileAndTop

- (instancetype)initWithInt:(jint)fd
              withByteArray:(IOSByteArray *)firstLine {
  OrgApacheLuceneUtilOfflineSorter_FileAndTop_initWithInt_withByteArray_(self, fd, firstLine);
  return self;
}

- (void)dealloc {
  RELEASE_(current_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithInt:withByteArray:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "fd_", "I", .constantValue.asLong = 0, 0x10, -1, -1, -1, -1 },
    { "current_", "LOrgApacheLuceneUtilBytesRefBuilder;", .constantValue.asLong = 0, 0x10, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "I[B", "LOrgApacheLuceneUtilOfflineSorter;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilOfflineSorter_FileAndTop = { "FileAndTop", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0x8, 1, 2, 1, -1, -1, -1, -1 };
  return &_OrgApacheLuceneUtilOfflineSorter_FileAndTop;
}

@end

void OrgApacheLuceneUtilOfflineSorter_FileAndTop_initWithInt_withByteArray_(OrgApacheLuceneUtilOfflineSorter_FileAndTop *self, jint fd, IOSByteArray *firstLine) {
  NSObject_init(self);
  self->fd_ = fd;
  JreStrongAssignAndConsume(&self->current_, new_OrgApacheLuceneUtilBytesRefBuilder_init());
  [self->current_ copyBytesWithByteArray:firstLine withInt:0 withInt:((IOSByteArray *) nil_chk(firstLine))->size_];
}

OrgApacheLuceneUtilOfflineSorter_FileAndTop *new_OrgApacheLuceneUtilOfflineSorter_FileAndTop_initWithInt_withByteArray_(jint fd, IOSByteArray *firstLine) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter_FileAndTop, initWithInt_withByteArray_, fd, firstLine)
}

OrgApacheLuceneUtilOfflineSorter_FileAndTop *create_OrgApacheLuceneUtilOfflineSorter_FileAndTop_initWithInt_withByteArray_(jint fd, IOSByteArray *firstLine) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter_FileAndTop, initWithInt_withByteArray_, fd, firstLine)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilOfflineSorter_FileAndTop)

@implementation OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter

- (instancetype)initWithOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)path {
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithOrgLukhnosPortmobileFilePath_(self, path);
  return self;
}

- (instancetype)initWithJavaIoDataOutput:(id<JavaIoDataOutput>)os {
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithJavaIoDataOutput_(self, os);
  return self;
}

- (void)writeWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)ref {
  JreAssert(ref != nil, @"org/apache/lucene/util/OfflineSorter.java:441 condition failed: assert ref != null;");
  [self writeWithByteArray:((OrgApacheLuceneUtilBytesRef *) nil_chk(ref))->bytes_ withInt:ref->offset_ withInt:ref->length_];
}

- (void)writeWithByteArray:(IOSByteArray *)bytes {
  [self writeWithByteArray:bytes withInt:0 withInt:((IOSByteArray *) nil_chk(bytes))->size_];
}

- (void)writeWithByteArray:(IOSByteArray *)bytes
                   withInt:(jint)off
                   withInt:(jint)len {
  JreAssert(bytes != nil, @"org/apache/lucene/util/OfflineSorter.java:460 condition failed: assert bytes != null;");
  JreAssert(off >= 0 && off + len <= ((IOSByteArray *) nil_chk(bytes))->size_, @"org/apache/lucene/util/OfflineSorter.java:461 condition failed: assert off >= 0 && off + len <= bytes.length;");
  JreAssert(len >= 0, @"org/apache/lucene/util/OfflineSorter.java:462 condition failed: assert len >= 0;");
  if (len > JavaLangShort_MAX_VALUE) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$S$I", @"len must be <= ", JavaLangShort_MAX_VALUE, @"; got ", len));
  }
  [((id<JavaIoDataOutput>) nil_chk(os_)) writeShortWithInt:len];
  [os_ writeWithByteArray:bytes withInt:off withInt:len];
}

- (void)close {
  if ([JavaIoCloseable_class_() isInstance:os_]) {
    [((id<JavaIoCloseable>) nil_chk(((id<JavaIoCloseable>) cast_check(os_, JavaIoCloseable_class_())))) close];
  }
}

- (void)dealloc {
  RELEASE_(os_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, 1, -1, -1, -1 },
    { NULL, NULL, 0x1, -1, 2, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 3, 4, 1, -1, -1, -1 },
    { NULL, "V", 0x1, 3, 5, 1, -1, -1, -1 },
    { NULL, "V", 0x1, 3, 6, 1, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, 1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgLukhnosPortmobileFilePath:);
  methods[1].selector = @selector(initWithJavaIoDataOutput:);
  methods[2].selector = @selector(writeWithOrgApacheLuceneUtilBytesRef:);
  methods[3].selector = @selector(writeWithByteArray:);
  methods[4].selector = @selector(writeWithByteArray:withInt:withInt:);
  methods[5].selector = @selector(close);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "os_", "LJavaIoDataOutput;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgLukhnosPortmobileFilePath;", "LJavaIoIOException;", "LJavaIoDataOutput;", "write", "LOrgApacheLuceneUtilBytesRef;", "[B", "[BII", "LOrgApacheLuceneUtilOfflineSorter;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter = { "ByteSequencesWriter", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0x9, 6, 1, 7, -1, -1, -1, -1 };
  return &_OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter;
}

@end

void OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithOrgLukhnosPortmobileFilePath_(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *self, OrgLukhnosPortmobileFilePath *path) {
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithJavaIoDataOutput_(self, create_JavaIoDataOutputStream_initWithJavaIoOutputStream_(create_JavaIoBufferedOutputStream_initWithJavaIoOutputStream_(OrgLukhnosPortmobileFileFiles_newOutputStreamWithOrgLukhnosPortmobileFilePath_(path))));
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *new_OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithOrgLukhnosPortmobileFilePath_(OrgLukhnosPortmobileFilePath *path) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter, initWithOrgLukhnosPortmobileFilePath_, path)
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithOrgLukhnosPortmobileFilePath_(OrgLukhnosPortmobileFilePath *path) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter, initWithOrgLukhnosPortmobileFilePath_, path)
}

void OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithJavaIoDataOutput_(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *self, id<JavaIoDataOutput> os) {
  NSObject_init(self);
  JreStrongAssign(&self->os_, os);
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *new_OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithJavaIoDataOutput_(id<JavaIoDataOutput> os) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter, initWithJavaIoDataOutput_, os)
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter *create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter_initWithJavaIoDataOutput_(id<JavaIoDataOutput> os) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter, initWithJavaIoDataOutput_, os)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilOfflineSorter_ByteSequencesWriter)

@implementation OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader

- (instancetype)initWithOrgLukhnosPortmobileFilePath:(OrgLukhnosPortmobileFilePath *)path {
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithOrgLukhnosPortmobileFilePath_(self, path);
  return self;
}

- (instancetype)initWithJavaIoDataInput:(id<JavaIoDataInput>)is {
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithJavaIoDataInput_(self, is);
  return self;
}

- (jboolean)readWithOrgApacheLuceneUtilBytesRefBuilder:(OrgApacheLuceneUtilBytesRefBuilder *)ref {
  jshort length;
  @try {
    length = [((id<JavaIoDataInput>) nil_chk(is_)) readShort];
  }
  @catch (JavaIoEOFException *e) {
    return false;
  }
  [((OrgApacheLuceneUtilBytesRefBuilder *) nil_chk(ref)) growWithInt:length];
  [ref setLengthWithInt:length];
  [is_ readFullyWithByteArray:[ref bytes] withInt:0 withInt:length];
  return true;
}

- (IOSByteArray *)read {
  jshort length;
  @try {
    length = [((id<JavaIoDataInput>) nil_chk(is_)) readShort];
  }
  @catch (JavaIoEOFException *e) {
    return nil;
  }
  JreAssert(length >= 0, JreStrcat("$S", @"Sanity: sequence length < 0: ", length));
  IOSByteArray *result = [IOSByteArray arrayWithLength:length];
  [is_ readFullyWithByteArray:result];
  return result;
}

- (void)close {
  if ([JavaIoCloseable_class_() isInstance:is_]) {
    [((id<JavaIoCloseable>) nil_chk(((id<JavaIoCloseable>) cast_check(is_, JavaIoCloseable_class_())))) close];
  }
}

- (void)dealloc {
  RELEASE_(is_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, 1, -1, -1, -1 },
    { NULL, NULL, 0x1, -1, 2, -1, -1, -1, -1 },
    { NULL, "Z", 0x1, 3, 4, 1, -1, -1, -1 },
    { NULL, "[B", 0x1, -1, -1, 1, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, 1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgLukhnosPortmobileFilePath:);
  methods[1].selector = @selector(initWithJavaIoDataInput:);
  methods[2].selector = @selector(readWithOrgApacheLuceneUtilBytesRefBuilder:);
  methods[3].selector = @selector(read);
  methods[4].selector = @selector(close);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "is_", "LJavaIoDataInput;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgLukhnosPortmobileFilePath;", "LJavaIoIOException;", "LJavaIoDataInput;", "read", "LOrgApacheLuceneUtilBytesRefBuilder;", "LOrgApacheLuceneUtilOfflineSorter;" };
  static const J2ObjcClassInfo _OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader = { "ByteSequencesReader", "org.apache.lucene.util", ptrTable, methods, fields, 7, 0x9, 5, 1, 5, -1, -1, -1, -1 };
  return &_OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader;
}

@end

void OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithOrgLukhnosPortmobileFilePath_(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *self, OrgLukhnosPortmobileFilePath *path) {
  OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithJavaIoDataInput_(self, create_JavaIoDataInputStream_initWithJavaIoInputStream_(create_JavaIoBufferedInputStream_initWithJavaIoInputStream_(OrgLukhnosPortmobileFileFiles_newInputStreamWithOrgLukhnosPortmobileFilePath_(path))));
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *new_OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithOrgLukhnosPortmobileFilePath_(OrgLukhnosPortmobileFilePath *path) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader, initWithOrgLukhnosPortmobileFilePath_, path)
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithOrgLukhnosPortmobileFilePath_(OrgLukhnosPortmobileFilePath *path) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader, initWithOrgLukhnosPortmobileFilePath_, path)
}

void OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithJavaIoDataInput_(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *self, id<JavaIoDataInput> is) {
  NSObject_init(self);
  JreStrongAssign(&self->is_, is);
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *new_OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithJavaIoDataInput_(id<JavaIoDataInput> is) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader, initWithJavaIoDataInput_, is)
}

OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader *create_OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader_initWithJavaIoDataInput_(id<JavaIoDataInput> is) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader, initWithJavaIoDataInput_, is)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneUtilOfflineSorter_ByteSequencesReader)
