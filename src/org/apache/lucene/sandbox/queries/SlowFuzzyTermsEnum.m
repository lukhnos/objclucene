//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./sandbox/src/java/org/apache/lucene/sandbox/queries/SlowFuzzyTermsEnum.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/Deprecated.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "java/lang/System.h"
#include "java/lang/annotation/Annotation.h"
#include "org/apache/lucene/index/FilteredTermsEnum.h"
#include "org/apache/lucene/index/Term.h"
#include "org/apache/lucene/index/Terms.h"
#include "org/apache/lucene/index/TermsEnum.h"
#include "org/apache/lucene/sandbox/queries/SlowFuzzyTermsEnum.h"
#include "org/apache/lucene/search/BoostAttribute.h"
#include "org/apache/lucene/search/FuzzyTermsEnum.h"
#include "org/apache/lucene/util/AttributeSource.h"
#include "org/apache/lucene/util/BytesRef.h"
#include "org/apache/lucene/util/IntsRefBuilder.h"
#include "org/apache/lucene/util/StringHelper.h"
#include "org/apache/lucene/util/UnicodeUtil.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/sandbox/queries/SlowFuzzyTermsEnum must not be compiled with ARC (-fobjc-arc)"
#endif

__attribute__((unused)) static IOSObjectArray *OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum__Annotations$0(void);

/*!
 @brief Implement fuzzy enumeration with linear brute force.
 */
@interface OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum : OrgApacheLuceneIndexFilteredTermsEnum {
 @public
  OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *this$0_;
  IOSIntArray *d_;
  IOSIntArray *p_;
  IOSIntArray *text_;
  id<OrgApacheLuceneSearchBoostAttribute> boostAtt_;
  OrgApacheLuceneUtilBytesRef *prefixBytesRef_;
  OrgApacheLuceneUtilIntsRefBuilder *utf32_;
}

/*!
 @brief Constructor for enumeration of all terms from specified <code>reader</code> which share a prefix of
  length <code>prefixLength</code> with <code>term</code> and which have a fuzzy similarity &gt;
  <code>minSimilarity</code>.
 <p>
  After calling the constructor the enumeration is already pointing to the first 
  valid term if such a term exists.
 @throw IOExceptionIf there is a low-level I/O error.
 */
- (instancetype)initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum:(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *)outer$;

/*!
 @brief <p>The termCompare method in FuzzyTermEnum uses Levenshtein distance to 
  calculate the distance between the given term and the comparing term.
 </p>
  <p>If the minSimilarity is &gt;= 1.0, this uses the maxEdits as the comparison.
  Otherwise, this method uses the following logic to calculate similarity. 
 @code

    similarity = 1 - ((float)distance / (float) (prefixLength + Math.min(textlen, targetlen)));   
   
@endcode
  where distance is the Levenshtein distance for the two words. 
 </p>
 */
- (OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus *)acceptWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)term;

/*!
 @brief <p>calcDistance returns the Levenshtein distance between the query term
  and the target term.
 </p>
   
 <p>Embedded within this algorithm is a fail-fast Levenshtein distance
  algorithm.  The fail-fast algorithm differs from the standard Levenshtein
  distance algorithm in that it is aborted if it is discovered that the
  minimum distance between the words is greater than some threshold. 
 <p>Levenshtein distance (also known as edit distance) is a measure of similarity
  between two strings where the distance is measured as the number of character
  deletions, insertions or substitutions required to transform one string to
  the other string.
 @param target the target word or phrase
 @param offset the offset at which to start the comparison
 @param length the length of what's left of the string to compare
 @return the number of edits or Integer.MIN_VALUE if the edit distance is
  greater than maxDistance.
 */
- (jint)calcDistanceWithIntArray:(IOSIntArray *)target
                         withInt:(jint)offset
                         withInt:(jint)length;

- (jfloat)calcSimilarityWithInt:(jint)edits
                        withInt:(jint)m
                        withInt:(jint)n;

/*!
 @brief The max Distance is the maximum Levenshtein distance for the text
  compared to some other value that results in score that is
  better than the minimum similarity.
 @param m the length of the "other value"
 @return the maximum levenshtein distance that we care about
 */
- (jint)calculateMaxDistanceWithInt:(jint)m;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum)

J2OBJC_FIELD_SETTER(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum, d_, IOSIntArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum, p_, IOSIntArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum, text_, IOSIntArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum, boostAtt_, id<OrgApacheLuceneSearchBoostAttribute>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum, prefixBytesRef_, OrgApacheLuceneUtilBytesRef *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum, utf32_, OrgApacheLuceneUtilIntsRefBuilder *)

__attribute__((unused)) static void OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *self, OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *outer$);

__attribute__((unused)) static OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *new_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *outer$) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *create_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *outer$);

__attribute__((unused)) static jint OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calcDistanceWithIntArray_withInt_withInt_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *self, IOSIntArray *target, jint offset, jint length);

__attribute__((unused)) static jfloat OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calcSimilarityWithInt_withInt_withInt_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *self, jint edits, jint m, jint n);

__attribute__((unused)) static jint OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calculateMaxDistanceWithInt_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *self, jint m);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum)

@implementation OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum

- (instancetype)initWithOrgApacheLuceneIndexTerms:(OrgApacheLuceneIndexTerms *)terms
           withOrgApacheLuceneUtilAttributeSource:(OrgApacheLuceneUtilAttributeSource *)atts
                     withOrgApacheLuceneIndexTerm:(OrgApacheLuceneIndexTerm *)term
                                        withFloat:(jfloat)minSimilarity
                                          withInt:(jint)prefixLength {
  OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_initWithOrgApacheLuceneIndexTerms_withOrgApacheLuceneUtilAttributeSource_withOrgApacheLuceneIndexTerm_withFloat_withInt_(self, terms, atts, term, minSimilarity, prefixLength);
  return self;
}

- (void)maxEditDistanceChangedWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)lastTerm
                                                      withInt:(jint)maxEdits
                                                  withBoolean:(jboolean)init_ {
  OrgApacheLuceneIndexTermsEnum *newEnum = JreRetainedLocalValue([self getAutomatonEnumWithInt:maxEdits withOrgApacheLuceneUtilBytesRef:lastTerm]);
  if (newEnum != nil) {
    [self setEnumWithOrgApacheLuceneIndexTermsEnum:newEnum];
  }
  else if (init_) {
    [self setEnumWithOrgApacheLuceneIndexTermsEnum:create_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_(self)];
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, 1, -1, -1, -1 },
    { NULL, "V", 0x4, 2, 3, 1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneIndexTerms:withOrgApacheLuceneUtilAttributeSource:withOrgApacheLuceneIndexTerm:withFloat:withInt:);
  methods[1].selector = @selector(maxEditDistanceChangedWithOrgApacheLuceneUtilBytesRef:withInt:withBoolean:);
  #pragma clang diagnostic pop
  static const void *ptrTable[] = { "LOrgApacheLuceneIndexTerms;LOrgApacheLuceneUtilAttributeSource;LOrgApacheLuceneIndexTerm;FI", "LJavaIoIOException;", "maxEditDistanceChanged", "LOrgApacheLuceneUtilBytesRef;IZ", "LOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum;", (void *)&OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum__Annotations$0 };
  static const J2ObjcClassInfo _OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum = { "SlowFuzzyTermsEnum", "org.apache.lucene.sandbox.queries", ptrTable, methods, NULL, 7, 0x11, 2, 0, -1, 4, -1, -1, 5 };
  return &_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum;
}

@end

void OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_initWithOrgApacheLuceneIndexTerms_withOrgApacheLuceneUtilAttributeSource_withOrgApacheLuceneIndexTerm_withFloat_withInt_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *self, OrgApacheLuceneIndexTerms *terms, OrgApacheLuceneUtilAttributeSource *atts, OrgApacheLuceneIndexTerm *term, jfloat minSimilarity, jint prefixLength) {
  OrgApacheLuceneSearchFuzzyTermsEnum_initWithOrgApacheLuceneIndexTerms_withOrgApacheLuceneUtilAttributeSource_withOrgApacheLuceneIndexTerm_withFloat_withInt_withBoolean_(self, terms, atts, term, minSimilarity, prefixLength, false);
}

OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *new_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_initWithOrgApacheLuceneIndexTerms_withOrgApacheLuceneUtilAttributeSource_withOrgApacheLuceneIndexTerm_withFloat_withInt_(OrgApacheLuceneIndexTerms *terms, OrgApacheLuceneUtilAttributeSource *atts, OrgApacheLuceneIndexTerm *term, jfloat minSimilarity, jint prefixLength) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum, initWithOrgApacheLuceneIndexTerms_withOrgApacheLuceneUtilAttributeSource_withOrgApacheLuceneIndexTerm_withFloat_withInt_, terms, atts, term, minSimilarity, prefixLength)
}

OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *create_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_initWithOrgApacheLuceneIndexTerms_withOrgApacheLuceneUtilAttributeSource_withOrgApacheLuceneIndexTerm_withFloat_withInt_(OrgApacheLuceneIndexTerms *terms, OrgApacheLuceneUtilAttributeSource *atts, OrgApacheLuceneIndexTerm *term, jfloat minSimilarity, jint prefixLength) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum, initWithOrgApacheLuceneIndexTerms_withOrgApacheLuceneUtilAttributeSource_withOrgApacheLuceneIndexTerm_withFloat_withInt_, terms, atts, term, minSimilarity, prefixLength)
}

IOSObjectArray *OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum__Annotations$0() {
  return [IOSObjectArray arrayWithObjects:(id[]){ create_JavaLangDeprecated() } count:1 type:JavaLangAnnotationAnnotation_class_()];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum)

@implementation OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum

- (instancetype)initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum:(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *)outer$ {
  OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_(self, outer$);
  return self;
}

- (OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus *)acceptWithOrgApacheLuceneUtilBytesRef:(OrgApacheLuceneUtilBytesRef *)term {
  if (OrgApacheLuceneUtilStringHelper_startsWithWithOrgApacheLuceneUtilBytesRef_withOrgApacheLuceneUtilBytesRef_(term, prefixBytesRef_)) {
    [((OrgApacheLuceneUtilIntsRefBuilder *) nil_chk(utf32_)) copyUTF8BytesWithOrgApacheLuceneUtilBytesRef:term];
    jint distance = OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calcDistanceWithIntArray_withInt_withInt_(self, [utf32_ ints], this$0_->realPrefixLength_, [utf32_ length] - this$0_->realPrefixLength_);
    if (distance == JavaLangInteger_MIN_VALUE) {
      return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, NO);
    }
    if (this$0_->raw_ == true && distance > this$0_->maxEdits_) {
      return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, NO);
    }
    jfloat similarity = OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calcSimilarityWithInt_withInt_withInt_(self, distance, ([utf32_ length] - this$0_->realPrefixLength_), ((IOSIntArray *) nil_chk(text_))->size_);
    if (this$0_->raw_ == true || (this$0_->raw_ == false && similarity > this$0_->minSimilarity_)) {
      [((id<OrgApacheLuceneSearchBoostAttribute>) nil_chk(boostAtt_)) setBoostWithFloat:(similarity - this$0_->minSimilarity_) * this$0_->scale_factor_];
      return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, YES);
    }
    else {
      return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, NO);
    }
  }
  else {
    return JreLoadEnum(OrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus, END);
  }
}

- (jint)calcDistanceWithIntArray:(IOSIntArray *)target
                         withInt:(jint)offset
                         withInt:(jint)length {
  return OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calcDistanceWithIntArray_withInt_withInt_(self, target, offset, length);
}

- (jfloat)calcSimilarityWithInt:(jint)edits
                        withInt:(jint)m
                        withInt:(jint)n {
  return OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calcSimilarityWithInt_withInt_withInt_(self, edits, m, n);
}

- (jint)calculateMaxDistanceWithInt:(jint)m {
  return OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calculateMaxDistanceWithInt_(self, m);
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(d_);
  RELEASE_(p_);
  RELEASE_(text_);
  RELEASE_(boostAtt_);
  RELEASE_(prefixBytesRef_);
  RELEASE_(utf32_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, 1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexFilteredTermsEnum_AcceptStatus;", 0x14, 2, 3, -1, -1, -1, -1 },
    { NULL, "I", 0x12, 4, 5, -1, -1, -1, -1 },
    { NULL, "F", 0x2, 6, 7, -1, -1, -1, -1 },
    { NULL, "I", 0x2, 8, 9, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum:);
  methods[1].selector = @selector(acceptWithOrgApacheLuceneUtilBytesRef:);
  methods[2].selector = @selector(calcDistanceWithIntArray:withInt:withInt:);
  methods[3].selector = @selector(calcSimilarityWithInt:withInt:withInt:);
  methods[4].selector = @selector(calculateMaxDistanceWithInt:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", "LOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum;", .constantValue.asLong = 0, 0x1012, -1, -1, -1, -1 },
    { "d_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "p_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "text_", "[I", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "boostAtt_", "LOrgApacheLuceneSearchBoostAttribute;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "prefixBytesRef_", "LOrgApacheLuceneUtilBytesRef;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "utf32_", "LOrgApacheLuceneUtilIntsRefBuilder;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum;", "LJavaIoIOException;", "accept", "LOrgApacheLuceneUtilBytesRef;", "calcDistance", "[III", "calcSimilarity", "III", "calculateMaxDistance", "I" };
  static const J2ObjcClassInfo _OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum = { "LinearFuzzyTermsEnum", "org.apache.lucene.sandbox.queries", ptrTable, methods, fields, 7, 0x2, 5, 7, 0, -1, -1, -1, -1 };
  return &_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum;
}

@end

void OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *self, OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *outer$) {
  JreStrongAssign(&self->this$0_, outer$);
  OrgApacheLuceneIndexFilteredTermsEnum_initWithOrgApacheLuceneIndexTermsEnum_(self, [((OrgApacheLuceneIndexTerms *) nil_chk(outer$->terms_)) iterator]);
  JreStrongAssign(&self->boostAtt_, [((OrgApacheLuceneUtilAttributeSource *) nil_chk([self attributes])) addAttributeWithIOSClass:OrgApacheLuceneSearchBoostAttribute_class_()]);
  JreStrongAssignAndConsume(&self->utf32_, new_OrgApacheLuceneUtilIntsRefBuilder_init());
  JreStrongAssignAndConsume(&self->text_, [IOSIntArray newArrayWithLength:outer$->termLength_ - outer$->realPrefixLength_]);
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(outer$->termText_, outer$->realPrefixLength_, self->text_, 0, self->text_->size_);
  NSString *prefix = OrgApacheLuceneUtilUnicodeUtil_newStringWithIntArray_withInt_withInt_(outer$->termText_, 0, outer$->realPrefixLength_);
  JreStrongAssignAndConsume(&self->prefixBytesRef_, new_OrgApacheLuceneUtilBytesRef_initWithJavaLangCharSequence_(prefix));
  JreStrongAssignAndConsume(&self->d_, [IOSIntArray newArrayWithLength:self->text_->size_ + 1]);
  JreStrongAssignAndConsume(&self->p_, [IOSIntArray newArrayWithLength:self->text_->size_ + 1]);
  [self setInitialSeekTermWithOrgApacheLuceneUtilBytesRef:self->prefixBytesRef_];
}

OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *new_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *outer$) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum, initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_, outer$)
}

OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *create_OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum *outer$) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum, initWithOrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_, outer$)
}

jint OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calcDistanceWithIntArray_withInt_withInt_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *self, IOSIntArray *target, jint offset, jint length) {
  jint m = length;
  jint n = ((IOSIntArray *) nil_chk(self->text_))->size_;
  if (n == 0) {
    return m;
  }
  if (m == 0) {
    return n;
  }
  jint maxDistance = OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calculateMaxDistanceWithInt_(self, m);
  if (maxDistance < JavaLangMath_absWithInt_(m - n)) {
    return JavaLangInteger_MIN_VALUE;
  }
  for (jint i = 0; i <= n; ++i) {
    *IOSIntArray_GetRef(nil_chk(self->p_), i) = i;
  }
  for (jint j = 1; j <= m; ++j) {
    jint bestPossibleEditDistance = m;
    jint t_j = IOSIntArray_Get(nil_chk(target), offset + j - 1);
    *IOSIntArray_GetRef(nil_chk(self->d_), 0) = j;
    for (jint i = 1; i <= n; ++i) {
      if (t_j != IOSIntArray_Get(self->text_, i - 1)) {
        *IOSIntArray_GetRef(nil_chk(self->d_), i) = JavaLangMath_minWithInt_withInt_(JavaLangMath_minWithInt_withInt_(IOSIntArray_Get(self->d_, i - 1), IOSIntArray_Get(nil_chk(self->p_), i)), IOSIntArray_Get(nil_chk(self->p_), i - 1)) + 1;
      }
      else {
        *IOSIntArray_GetRef(nil_chk(self->d_), i) = JavaLangMath_minWithInt_withInt_(JavaLangMath_minWithInt_withInt_(IOSIntArray_Get(self->d_, i - 1) + 1, IOSIntArray_Get(nil_chk(self->p_), i) + 1), IOSIntArray_Get(nil_chk(self->p_), i - 1));
      }
      bestPossibleEditDistance = JavaLangMath_minWithInt_withInt_(bestPossibleEditDistance, IOSIntArray_Get(nil_chk(self->d_), i));
    }
    if (j > maxDistance && bestPossibleEditDistance > maxDistance) {
      return JavaLangInteger_MIN_VALUE;
    }
    IOSIntArray *_d = self->p_;
    JreStrongAssign(&self->p_, self->d_);
    JreStrongAssign(&self->d_, _d);
  }
  return IOSIntArray_Get(nil_chk(self->p_), n);
}

jfloat OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calcSimilarityWithInt_withInt_withInt_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *self, jint edits, jint m, jint n) {
  return 1.0f - ((jfloat) edits / (jfloat) (self->this$0_->realPrefixLength_ + JavaLangMath_minWithInt_withInt_(n, m)));
}

jint OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum_calculateMaxDistanceWithInt_(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum *self, jint m) {
  return self->this$0_->raw_ ? self->this$0_->maxEdits_ : JavaLangMath_minWithInt_withInt_(self->this$0_->maxEdits_, JreFpToInt(((1 - self->this$0_->minSimilarity_) * (JavaLangMath_minWithInt_withInt_(((IOSIntArray *) nil_chk(self->text_))->size_, m) + self->this$0_->realPrefixLength_))));
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneSandboxQueriesSlowFuzzyTermsEnum_LinearFuzzyTermsEnum)
