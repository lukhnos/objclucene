//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./analysis/common/src/java/org/apache/lucene/analysis/synonym/SynonymMap.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/io/Reader.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "java/lang/System.h"
#include "java/lang/Throwable.h"
#include "java/util/ArrayList.h"
#include "java/util/Arrays.h"
#include "java/util/Comparator.h"
#include "java/util/HashMap.h"
#include "java/util/HashSet.h"
#include "java/util/Set.h"
#include "org/apache/lucene/analysis/Analyzer.h"
#include "org/apache/lucene/analysis/TokenStream.h"
#include "org/apache/lucene/analysis/synonym/SynonymMap.h"
#include "org/apache/lucene/analysis/tokenattributes/CharTermAttribute.h"
#include "org/apache/lucene/analysis/tokenattributes/PositionIncrementAttribute.h"
#include "org/apache/lucene/store/ByteArrayDataOutput.h"
#include "org/apache/lucene/util/BytesRef.h"
#include "org/apache/lucene/util/BytesRefBuilder.h"
#include "org/apache/lucene/util/BytesRefHash.h"
#include "org/apache/lucene/util/CharsRef.h"
#include "org/apache/lucene/util/CharsRefBuilder.h"
#include "org/apache/lucene/util/IntsRef.h"
#include "org/apache/lucene/util/IntsRefBuilder.h"
#include "org/apache/lucene/util/fst/Builder.h"
#include "org/apache/lucene/util/fst/ByteSequenceOutputs.h"
#include "org/apache/lucene/util/fst/FST.h"
#include "org/apache/lucene/util/fst/Util.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/analysis/synonym/SynonymMap must not be compiled with ARC (-fobjc-arc)"
#endif

@interface OrgApacheLuceneAnalysisSynonymSynonymMap_Builder () {
 @public
  JavaUtilHashMap *workingSet_;
  OrgApacheLuceneUtilBytesRefHash *words_;
  OrgApacheLuceneUtilBytesRefBuilder *utf8Scratch_;
  jint maxHorizontalContext_;
  jboolean dedup_;
}

/*!
 @brief only used for asserting!
 */
- (jboolean)hasHolesWithOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)chars;

- (void)addWithOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)input
                                   withInt:(jint)numInputWords
           withOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)output
                                   withInt:(jint)numOutputWords
                               withBoolean:(jboolean)includeOrig;

- (jint)countWordsWithOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)chars;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder, workingSet_, JavaUtilHashMap *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder, words_, OrgApacheLuceneUtilBytesRefHash *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder, utf8Scratch_, OrgApacheLuceneUtilBytesRefBuilder *)

__attribute__((unused)) static jboolean OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_hasHolesWithOrgApacheLuceneUtilCharsRef_(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *self, OrgApacheLuceneUtilCharsRef *chars);

__attribute__((unused)) static void OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_addWithOrgApacheLuceneUtilCharsRef_withInt_withOrgApacheLuceneUtilCharsRef_withInt_withBoolean_(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *self, OrgApacheLuceneUtilCharsRef *input, jint numInputWords, OrgApacheLuceneUtilCharsRef *output, jint numOutputWords, jboolean includeOrig);

__attribute__((unused)) static jint OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_countWordsWithOrgApacheLuceneUtilCharsRef_(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *self, OrgApacheLuceneUtilCharsRef *chars);

@interface OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry : NSObject {
 @public
  jboolean includeOrig_;
  JavaUtilArrayList *ords_;
}

- (instancetype)init;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry)

J2OBJC_FIELD_SETTER(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry, ords_, JavaUtilArrayList *)

__attribute__((unused)) static void OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry_init(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *self);

__attribute__((unused)) static OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *new_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry_init(void) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *create_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry_init(void);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry)

@interface OrgApacheLuceneAnalysisSynonymSynonymMap_Parser () {
 @public
  OrgApacheLuceneAnalysisAnalyzer *analyzer_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneAnalysisSynonymSynonymMap_Parser, analyzer_, OrgApacheLuceneAnalysisAnalyzer *)

@implementation OrgApacheLuceneAnalysisSynonymSynonymMap

+ (jchar)WORD_SEPARATOR {
  return OrgApacheLuceneAnalysisSynonymSynonymMap_WORD_SEPARATOR;
}

- (instancetype)initWithOrgApacheLuceneUtilFstFST:(OrgApacheLuceneUtilFstFST *)fst
              withOrgApacheLuceneUtilBytesRefHash:(OrgApacheLuceneUtilBytesRefHash *)words
                                          withInt:(jint)maxHorizontalContext {
  OrgApacheLuceneAnalysisSynonymSynonymMap_initWithOrgApacheLuceneUtilFstFST_withOrgApacheLuceneUtilBytesRefHash_withInt_(self, fst, words, maxHorizontalContext);
  return self;
}

- (void)dealloc {
  RELEASE_(fst_);
  RELEASE_(words_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, 1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneUtilFstFST:withOrgApacheLuceneUtilBytesRefHash:withInt:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "WORD_SEPARATOR", "C", .constantValue.asUnichar = OrgApacheLuceneAnalysisSynonymSynonymMap_WORD_SEPARATOR, 0x19, -1, -1, -1, -1 },
    { "fst_", "LOrgApacheLuceneUtilFstFST;", .constantValue.asLong = 0, 0x11, -1, -1, 2, -1 },
    { "words_", "LOrgApacheLuceneUtilBytesRefHash;", .constantValue.asLong = 0, 0x11, -1, -1, -1, -1 },
    { "maxHorizontalContext_", "I", .constantValue.asLong = 0, 0x11, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneUtilFstFST;LOrgApacheLuceneUtilBytesRefHash;I", "(Lorg/apache/lucene/util/fst/FST<Lorg/apache/lucene/util/BytesRef;>;Lorg/apache/lucene/util/BytesRefHash;I)V", "Lorg/apache/lucene/util/fst/FST<Lorg/apache/lucene/util/BytesRef;>;", "LOrgApacheLuceneAnalysisSynonymSynonymMap_Builder;LOrgApacheLuceneAnalysisSynonymSynonymMap_Parser;" };
  static const J2ObjcClassInfo _OrgApacheLuceneAnalysisSynonymSynonymMap = { "SynonymMap", "org.apache.lucene.analysis.synonym", ptrTable, methods, fields, 7, 0x1, 1, 4, -1, 3, -1, -1, -1 };
  return &_OrgApacheLuceneAnalysisSynonymSynonymMap;
}

@end

void OrgApacheLuceneAnalysisSynonymSynonymMap_initWithOrgApacheLuceneUtilFstFST_withOrgApacheLuceneUtilBytesRefHash_withInt_(OrgApacheLuceneAnalysisSynonymSynonymMap *self, OrgApacheLuceneUtilFstFST *fst, OrgApacheLuceneUtilBytesRefHash *words, jint maxHorizontalContext) {
  NSObject_init(self);
  JreStrongAssign(&self->fst_, fst);
  JreStrongAssign(&self->words_, words);
  self->maxHorizontalContext_ = maxHorizontalContext;
}

OrgApacheLuceneAnalysisSynonymSynonymMap *new_OrgApacheLuceneAnalysisSynonymSynonymMap_initWithOrgApacheLuceneUtilFstFST_withOrgApacheLuceneUtilBytesRefHash_withInt_(OrgApacheLuceneUtilFstFST *fst, OrgApacheLuceneUtilBytesRefHash *words, jint maxHorizontalContext) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneAnalysisSynonymSynonymMap, initWithOrgApacheLuceneUtilFstFST_withOrgApacheLuceneUtilBytesRefHash_withInt_, fst, words, maxHorizontalContext)
}

OrgApacheLuceneAnalysisSynonymSynonymMap *create_OrgApacheLuceneAnalysisSynonymSynonymMap_initWithOrgApacheLuceneUtilFstFST_withOrgApacheLuceneUtilBytesRefHash_withInt_(OrgApacheLuceneUtilFstFST *fst, OrgApacheLuceneUtilBytesRefHash *words, jint maxHorizontalContext) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneAnalysisSynonymSynonymMap, initWithOrgApacheLuceneUtilFstFST_withOrgApacheLuceneUtilBytesRefHash_withInt_, fst, words, maxHorizontalContext)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneAnalysisSynonymSynonymMap)

@implementation OrgApacheLuceneAnalysisSynonymSynonymMap_Builder

- (instancetype)initWithBoolean:(jboolean)dedup {
  OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_initWithBoolean_(self, dedup);
  return self;
}

+ (OrgApacheLuceneUtilCharsRef *)joinWithNSStringArray:(IOSObjectArray *)words
                withOrgApacheLuceneUtilCharsRefBuilder:(OrgApacheLuceneUtilCharsRefBuilder *)reuse {
  return OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_joinWithNSStringArray_withOrgApacheLuceneUtilCharsRefBuilder_(words, reuse);
}

- (jboolean)hasHolesWithOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)chars {
  return OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_hasHolesWithOrgApacheLuceneUtilCharsRef_(self, chars);
}

- (void)addWithOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)input
                                   withInt:(jint)numInputWords
           withOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)output
                                   withInt:(jint)numOutputWords
                               withBoolean:(jboolean)includeOrig {
  OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_addWithOrgApacheLuceneUtilCharsRef_withInt_withOrgApacheLuceneUtilCharsRef_withInt_withBoolean_(self, input, numInputWords, output, numOutputWords, includeOrig);
}

- (jint)countWordsWithOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)chars {
  return OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_countWordsWithOrgApacheLuceneUtilCharsRef_(self, chars);
}

- (void)addWithOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)input
           withOrgApacheLuceneUtilCharsRef:(OrgApacheLuceneUtilCharsRef *)output
                               withBoolean:(jboolean)includeOrig {
  OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_addWithOrgApacheLuceneUtilCharsRef_withInt_withOrgApacheLuceneUtilCharsRef_withInt_withBoolean_(self, input, OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_countWordsWithOrgApacheLuceneUtilCharsRef_(self, input), output, OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_countWordsWithOrgApacheLuceneUtilCharsRef_(self, output), includeOrig);
}

- (OrgApacheLuceneAnalysisSynonymSynonymMap *)build {
  OrgApacheLuceneUtilFstByteSequenceOutputs *outputs = OrgApacheLuceneUtilFstByteSequenceOutputs_getSingleton();
  OrgApacheLuceneUtilFstBuilder *builder = create_OrgApacheLuceneUtilFstBuilder_initWithOrgApacheLuceneUtilFstFST_INPUT_TYPE_withOrgApacheLuceneUtilFstOutputs_(JreLoadEnum(OrgApacheLuceneUtilFstFST_INPUT_TYPE, BYTE4), outputs);
  OrgApacheLuceneUtilBytesRefBuilder *scratch = create_OrgApacheLuceneUtilBytesRefBuilder_init();
  OrgApacheLuceneStoreByteArrayDataOutput *scratchOutput = create_OrgApacheLuceneStoreByteArrayDataOutput_init();
  id<JavaUtilSet> dedupSet;
  if (dedup_) {
    dedupSet = create_JavaUtilHashSet_init();
  }
  else {
    dedupSet = nil;
  }
  IOSByteArray *spare = [IOSByteArray arrayWithLength:5];
  id<JavaUtilSet> keys = JreRetainedLocalValue([((JavaUtilHashMap *) nil_chk(workingSet_)) keySet]);
  IOSObjectArray *sortedKeys = [((id<JavaUtilSet>) nil_chk(keys)) toArrayWithNSObjectArray:[IOSObjectArray arrayWithLength:[keys size] type:OrgApacheLuceneUtilCharsRef_class_()]];
  JavaUtilArrays_sortWithNSObjectArray_withJavaUtilComparator_(sortedKeys, OrgApacheLuceneUtilCharsRef_getUTF16SortedAsUTF8Comparator());
  OrgApacheLuceneUtilIntsRefBuilder *scratchIntsRef = create_OrgApacheLuceneUtilIntsRefBuilder_init();
  for (jint keyIdx = 0; keyIdx < ((IOSObjectArray *) nil_chk(sortedKeys))->size_; keyIdx++) {
    OrgApacheLuceneUtilCharsRef *input = IOSObjectArray_Get(sortedKeys, keyIdx);
    OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *output = JreRetainedLocalValue([workingSet_ getWithId:input]);
    jint numEntries = [((JavaUtilArrayList *) nil_chk(((OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *) nil_chk(output))->ords_)) size];
    jint estimatedSize = 5 + numEntries * 5;
    [scratch growWithInt:estimatedSize];
    [scratchOutput resetWithByteArray:[scratch bytes]];
    jint count = 0;
    for (jint i = 0; i < numEntries; i++) {
      if (dedupSet != nil) {
        JavaLangInteger *ent = [((JavaUtilArrayList *) nil_chk(output->ords_)) getWithInt:i];
        if ([dedupSet containsWithId:ent]) {
          continue;
        }
        [dedupSet addWithId:ent];
      }
      [scratchOutput writeVIntWithInt:[((JavaLangInteger *) nil_chk([((JavaUtilArrayList *) nil_chk(output->ords_)) getWithInt:i])) intValue]];
      count++;
    }
    jint pos = [scratchOutput getPosition];
    [scratchOutput writeVIntWithInt:(JreLShift32(count, 1)) | (output->includeOrig_ ? 0 : 1)];
    jint pos2 = [scratchOutput getPosition];
    jint vIntLen = pos2 - pos;
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_([scratch bytes], pos, spare, 0, vIntLen);
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_([scratch bytes], 0, [scratch bytes], vIntLen, pos);
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(spare, 0, [scratch bytes], 0, vIntLen);
    if (dedupSet != nil) {
      [dedupSet clear];
    }
    [scratch setLengthWithInt:[scratchOutput getPosition]];
    [builder addWithOrgApacheLuceneUtilIntsRef:OrgApacheLuceneUtilFstUtil_toUTF32WithJavaLangCharSequence_withOrgApacheLuceneUtilIntsRefBuilder_(input, scratchIntsRef) withId:[scratch toBytesRef]];
  }
  OrgApacheLuceneUtilFstFST *fst = JreRetainedLocalValue([builder finish]);
  return create_OrgApacheLuceneAnalysisSynonymSynonymMap_initWithOrgApacheLuceneUtilFstFST_withOrgApacheLuceneUtilBytesRefHash_withInt_(fst, words_, maxHorizontalContext_);
}

- (void)dealloc {
  RELEASE_(workingSet_);
  RELEASE_(words_);
  RELEASE_(utf8Scratch_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilCharsRef;", 0x9, 1, 2, -1, -1, -1, -1 },
    { NULL, "Z", 0x2, 3, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 5, 6, -1, -1, -1, -1 },
    { NULL, "I", 0x2, 7, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 5, 8, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneAnalysisSynonymSynonymMap;", 0x1, -1, -1, 9, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithBoolean:);
  methods[1].selector = @selector(joinWithNSStringArray:withOrgApacheLuceneUtilCharsRefBuilder:);
  methods[2].selector = @selector(hasHolesWithOrgApacheLuceneUtilCharsRef:);
  methods[3].selector = @selector(addWithOrgApacheLuceneUtilCharsRef:withInt:withOrgApacheLuceneUtilCharsRef:withInt:withBoolean:);
  methods[4].selector = @selector(countWordsWithOrgApacheLuceneUtilCharsRef:);
  methods[5].selector = @selector(addWithOrgApacheLuceneUtilCharsRef:withOrgApacheLuceneUtilCharsRef:withBoolean:);
  methods[6].selector = @selector(build);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "workingSet_", "LJavaUtilHashMap;", .constantValue.asLong = 0, 0x12, -1, -1, 10, -1 },
    { "words_", "LOrgApacheLuceneUtilBytesRefHash;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "utf8Scratch_", "LOrgApacheLuceneUtilBytesRefBuilder;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "maxHorizontalContext_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "dedup_", "Z", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "Z", "join", "[LNSString;LOrgApacheLuceneUtilCharsRefBuilder;", "hasHoles", "LOrgApacheLuceneUtilCharsRef;", "add", "LOrgApacheLuceneUtilCharsRef;ILOrgApacheLuceneUtilCharsRef;IZ", "countWords", "LOrgApacheLuceneUtilCharsRef;LOrgApacheLuceneUtilCharsRef;Z", "LJavaIoIOException;", "Ljava/util/HashMap<Lorg/apache/lucene/util/CharsRef;Lorg/apache/lucene/analysis/synonym/SynonymMap$Builder$MapEntry;>;", "LOrgApacheLuceneAnalysisSynonymSynonymMap;", "LOrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry;" };
  static const J2ObjcClassInfo _OrgApacheLuceneAnalysisSynonymSynonymMap_Builder = { "Builder", "org.apache.lucene.analysis.synonym", ptrTable, methods, fields, 7, 0x9, 7, 5, 11, 12, -1, -1, -1 };
  return &_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder;
}

@end

void OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_initWithBoolean_(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *self, jboolean dedup) {
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->workingSet_, new_JavaUtilHashMap_init());
  JreStrongAssignAndConsume(&self->words_, new_OrgApacheLuceneUtilBytesRefHash_init());
  JreStrongAssignAndConsume(&self->utf8Scratch_, new_OrgApacheLuceneUtilBytesRefBuilder_init());
  self->dedup_ = dedup;
}

OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *new_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_initWithBoolean_(jboolean dedup) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder, initWithBoolean_, dedup)
}

OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *create_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_initWithBoolean_(jboolean dedup) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder, initWithBoolean_, dedup)
}

OrgApacheLuceneUtilCharsRef *OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_joinWithNSStringArray_withOrgApacheLuceneUtilCharsRefBuilder_(IOSObjectArray *words, OrgApacheLuceneUtilCharsRefBuilder *reuse) {
  OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_initialize();
  jint upto = 0;
  IOSCharArray *buffer = [((OrgApacheLuceneUtilCharsRefBuilder *) nil_chk(reuse)) chars];
  {
    IOSObjectArray *a__ = words;
    NSString * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    NSString * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      NSString *word = *b__++;
      jint wordLen = [((NSString *) nil_chk(word)) java_length];
      jint needed = (0 == upto ? wordLen : 1 + upto + wordLen);
      if (needed > ((IOSCharArray *) nil_chk(buffer))->size_) {
        [reuse growWithInt:needed];
        buffer = [reuse chars];
      }
      if (upto > 0) {
        *IOSCharArray_GetRef(nil_chk(buffer), upto++) = OrgApacheLuceneAnalysisSynonymSynonymMap_WORD_SEPARATOR;
      }
      [word java_getChars:0 sourceEnd:wordLen destination:buffer destinationBegin:upto];
      upto += wordLen;
    }
  }
  [reuse setLengthWithInt:upto];
  return [reuse get];
}

jboolean OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_hasHolesWithOrgApacheLuceneUtilCharsRef_(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *self, OrgApacheLuceneUtilCharsRef *chars) {
  jint end = ((OrgApacheLuceneUtilCharsRef *) nil_chk(chars))->offset_ + chars->length_;
  for (jint idx = chars->offset_ + 1; idx < end; idx++) {
    if (IOSCharArray_Get(nil_chk(chars->chars_), idx) == OrgApacheLuceneAnalysisSynonymSynonymMap_WORD_SEPARATOR && IOSCharArray_Get(chars->chars_, idx - 1) == OrgApacheLuceneAnalysisSynonymSynonymMap_WORD_SEPARATOR) {
      return true;
    }
  }
  if (IOSCharArray_Get(nil_chk(chars->chars_), chars->offset_) == 0x0000) {
    return true;
  }
  if (IOSCharArray_Get(chars->chars_, chars->offset_ + chars->length_ - 1) == 0x0000) {
    return true;
  }
  return false;
}

void OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_addWithOrgApacheLuceneUtilCharsRef_withInt_withOrgApacheLuceneUtilCharsRef_withInt_withBoolean_(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *self, OrgApacheLuceneUtilCharsRef *input, jint numInputWords, OrgApacheLuceneUtilCharsRef *output, jint numOutputWords, jboolean includeOrig) {
  if (numInputWords <= 0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$IC", @"numInputWords must be > 0 (got ", numInputWords, ')'));
  }
  if (((OrgApacheLuceneUtilCharsRef *) nil_chk(input))->length_ <= 0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$IC", @"input.length must be > 0 (got ", input->length_, ')'));
  }
  if (numOutputWords <= 0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$IC", @"numOutputWords must be > 0 (got ", numOutputWords, ')'));
  }
  if (((OrgApacheLuceneUtilCharsRef *) nil_chk(output))->length_ <= 0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$IC", @"output.length must be > 0 (got ", output->length_, ')'));
  }
  JreAssert(!OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_hasHolesWithOrgApacheLuceneUtilCharsRef_(self, input), JreStrcat("$@", @"input has holes: ", input));
  JreAssert(!OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_hasHolesWithOrgApacheLuceneUtilCharsRef_(self, output), JreStrcat("$@", @"output has holes: ", output));
  [((OrgApacheLuceneUtilBytesRefBuilder *) nil_chk(self->utf8Scratch_)) copyCharsWithCharArray:output->chars_ withInt:output->offset_ withInt:output->length_];
  jint ord = [((OrgApacheLuceneUtilBytesRefHash *) nil_chk(self->words_)) addWithOrgApacheLuceneUtilBytesRef:[self->utf8Scratch_ get]];
  if (ord < 0) {
    ord = (-ord) - 1;
  }
  else {
  }
  OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *e = JreRetainedLocalValue([((JavaUtilHashMap *) nil_chk(self->workingSet_)) getWithId:input]);
  if (e == nil) {
    e = create_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry_init();
    [self->workingSet_ putWithId:OrgApacheLuceneUtilCharsRef_deepCopyOfWithOrgApacheLuceneUtilCharsRef_(input) withId:e];
  }
  [((JavaUtilArrayList *) nil_chk(e->ords_)) addWithId:JavaLangInteger_valueOfWithInt_(ord)];
  e->includeOrig_ |= includeOrig;
  self->maxHorizontalContext_ = JavaLangMath_maxWithInt_withInt_(self->maxHorizontalContext_, numInputWords);
  self->maxHorizontalContext_ = JavaLangMath_maxWithInt_withInt_(self->maxHorizontalContext_, numOutputWords);
}

jint OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_countWordsWithOrgApacheLuceneUtilCharsRef_(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder *self, OrgApacheLuceneUtilCharsRef *chars) {
  jint wordCount = 1;
  jint upto = ((OrgApacheLuceneUtilCharsRef *) nil_chk(chars))->offset_;
  jint limit = chars->offset_ + chars->length_;
  while (upto < limit) {
    if (IOSCharArray_Get(nil_chk(chars->chars_), upto++) == OrgApacheLuceneAnalysisSynonymSynonymMap_WORD_SEPARATOR) {
      wordCount++;
    }
  }
  return wordCount;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder)

@implementation OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)dealloc {
  RELEASE_(ords_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x2, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "includeOrig_", "Z", .constantValue.asLong = 0, 0x0, -1, -1, -1, -1 },
    { "ords_", "LJavaUtilArrayList;", .constantValue.asLong = 0, 0x0, -1, -1, 0, -1 },
  };
  static const void *ptrTable[] = { "Ljava/util/ArrayList<Ljava/lang/Integer;>;", "LOrgApacheLuceneAnalysisSynonymSynonymMap_Builder;" };
  static const J2ObjcClassInfo _OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry = { "MapEntry", "org.apache.lucene.analysis.synonym", ptrTable, methods, fields, 7, 0xa, 1, 2, 1, -1, -1, -1, -1 };
  return &_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry;
}

@end

void OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry_init(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *self) {
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->ords_, new_JavaUtilArrayList_init());
}

OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *new_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry, init)
}

OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry *create_OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry, init)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_MapEntry)

@implementation OrgApacheLuceneAnalysisSynonymSynonymMap_Parser

- (instancetype)initWithBoolean:(jboolean)dedup
withOrgApacheLuceneAnalysisAnalyzer:(OrgApacheLuceneAnalysisAnalyzer *)analyzer {
  OrgApacheLuceneAnalysisSynonymSynonymMap_Parser_initWithBoolean_withOrgApacheLuceneAnalysisAnalyzer_(self, dedup, analyzer);
  return self;
}

- (void)parseWithJavaIoReader:(JavaIoReader *)inArg {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
}

- (OrgApacheLuceneUtilCharsRef *)analyzeWithNSString:(NSString *)text
              withOrgApacheLuceneUtilCharsRefBuilder:(OrgApacheLuceneUtilCharsRefBuilder *)reuse {
  {
    OrgApacheLuceneAnalysisTokenStream *ts = [((OrgApacheLuceneAnalysisAnalyzer *) nil_chk(analyzer_)) tokenStreamWithNSString:@"" withNSString:text];
    JavaLangThrowable *__primaryException1 = nil;
    @try {
      id<OrgApacheLuceneAnalysisTokenattributesCharTermAttribute> termAtt = JreRetainedLocalValue([((OrgApacheLuceneAnalysisTokenStream *) nil_chk(ts)) addAttributeWithIOSClass:OrgApacheLuceneAnalysisTokenattributesCharTermAttribute_class_()]);
      id<OrgApacheLuceneAnalysisTokenattributesPositionIncrementAttribute> posIncAtt = JreRetainedLocalValue([ts addAttributeWithIOSClass:OrgApacheLuceneAnalysisTokenattributesPositionIncrementAttribute_class_()]);
      [ts reset];
      [((OrgApacheLuceneUtilCharsRefBuilder *) nil_chk(reuse)) clear];
      while ([ts incrementToken]) {
        jint length = [((id<OrgApacheLuceneAnalysisTokenattributesCharTermAttribute>) nil_chk(termAtt)) java_length];
        if (length == 0) {
          @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$$$", @"term: ", text, @" analyzed to a zero-length token"));
        }
        if ([((id<OrgApacheLuceneAnalysisTokenattributesPositionIncrementAttribute>) nil_chk(posIncAtt)) getPositionIncrement] != 1) {
          @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$$$", @"term: ", text, @" analyzed to a token with posinc != 1"));
        }
        [reuse growWithInt:[reuse length] + length + 1];
        jint end = [reuse length];
        if ([reuse length] > 0) {
          [reuse setCharAtWithInt:end++ withChar:OrgApacheLuceneAnalysisSynonymSynonymMap_WORD_SEPARATOR];
          [reuse setLengthWithInt:[reuse length] + 1];
        }
        JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_([termAtt buffer], 0, [reuse chars], end, length);
        [reuse setLengthWithInt:[reuse length] + length];
      }
      [ts end];
    }
    @catch (JavaLangThrowable *e) {
      __primaryException1 = e;
      @throw e;
    }
    @finally {
      if (ts != nil) {
        if (__primaryException1 != nil) {
          @try {
            [ts close];
          }
          @catch (JavaLangThrowable *e) {
            [__primaryException1 addSuppressedWithJavaLangThrowable:e];
          }
        }
        else {
          [ts close];
        }
      }
    }
  }
  if ([((OrgApacheLuceneUtilCharsRefBuilder *) nil_chk(reuse)) length] == 0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$$$", @"term: ", text, @" was completely eliminated by analyzer"));
  }
  return [reuse get];
}

- (void)dealloc {
  RELEASE_(analyzer_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "V", 0x401, 1, 2, 3, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilCharsRef;", 0x1, 4, 5, 6, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithBoolean:withOrgApacheLuceneAnalysisAnalyzer:);
  methods[1].selector = @selector(parseWithJavaIoReader:);
  methods[2].selector = @selector(analyzeWithNSString:withOrgApacheLuceneUtilCharsRefBuilder:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "analyzer_", "LOrgApacheLuceneAnalysisAnalyzer;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "ZLOrgApacheLuceneAnalysisAnalyzer;", "parse", "LJavaIoReader;", "LJavaIoIOException;LJavaTextParseException;", "analyze", "LNSString;LOrgApacheLuceneUtilCharsRefBuilder;", "LJavaIoIOException;", "LOrgApacheLuceneAnalysisSynonymSynonymMap;" };
  static const J2ObjcClassInfo _OrgApacheLuceneAnalysisSynonymSynonymMap_Parser = { "Parser", "org.apache.lucene.analysis.synonym", ptrTable, methods, fields, 7, 0x409, 3, 1, 7, -1, -1, -1, -1 };
  return &_OrgApacheLuceneAnalysisSynonymSynonymMap_Parser;
}

@end

void OrgApacheLuceneAnalysisSynonymSynonymMap_Parser_initWithBoolean_withOrgApacheLuceneAnalysisAnalyzer_(OrgApacheLuceneAnalysisSynonymSynonymMap_Parser *self, jboolean dedup, OrgApacheLuceneAnalysisAnalyzer *analyzer) {
  OrgApacheLuceneAnalysisSynonymSynonymMap_Builder_initWithBoolean_(self, dedup);
  JreStrongAssign(&self->analyzer_, analyzer);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneAnalysisSynonymSynonymMap_Parser)
