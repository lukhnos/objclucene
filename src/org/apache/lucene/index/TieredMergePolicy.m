//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/index/TieredMergePolicy.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/Boolean.h"
#include "java/lang/Double.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/Long.h"
#include "java/lang/Math.h"
#include "java/lang/RuntimeException.h"
#include "java/lang/StringBuilder.h"
#include "java/util/ArrayList.h"
#include "java/util/Collection.h"
#include "java/util/Collections.h"
#include "java/util/Comparator.h"
#include "java/util/HashSet.h"
#include "java/util/List.h"
#include "java/util/Locale.h"
#include "java/util/Map.h"
#include "java/util/function/Function.h"
#include "java/util/function/ToDoubleFunction.h"
#include "java/util/function/ToIntFunction.h"
#include "java/util/function/ToLongFunction.h"
#include "org/apache/lucene/index/IndexWriter.h"
#include "org/apache/lucene/index/MergePolicy.h"
#include "org/apache/lucene/index/MergeTrigger.h"
#include "org/apache/lucene/index/SegmentCommitInfo.h"
#include "org/apache/lucene/index/SegmentInfo.h"
#include "org/apache/lucene/index/SegmentInfos.h"
#include "org/apache/lucene/index/TieredMergePolicy.h"
#include "org/apache/lucene/util/InfoStream.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/index/TieredMergePolicy must not be compiled with ARC (-fobjc-arc)"
#endif

#pragma clang diagnostic ignored "-Wprotocol"

@interface OrgApacheLuceneIndexTieredMergePolicy () {
 @public
  jint maxMergeAtOnce_;
  jlong maxMergedSegmentBytes_;
  jint maxMergeAtOnceExplicit_;
  jlong floorSegmentBytes_;
  jdouble segsPerTier_;
  jdouble forceMergeDeletesPctAllowed_;
  jdouble reclaimDeletesWeight_;
}

- (jlong)floorSizeWithLong:(jlong)bytes;

- (jboolean)verboseWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer;

- (void)messageWithNSString:(NSString *)message
withOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer;

@end

__attribute__((unused)) static jlong OrgApacheLuceneIndexTieredMergePolicy_floorSizeWithLong_(OrgApacheLuceneIndexTieredMergePolicy *self, jlong bytes);

__attribute__((unused)) static jboolean OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy *self, OrgApacheLuceneIndexIndexWriter *writer);

__attribute__((unused)) static void OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy *self, NSString *message, OrgApacheLuceneIndexIndexWriter *writer);

@interface OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending : NSObject < JavaUtilComparator > {
 @public
  OrgApacheLuceneIndexTieredMergePolicy *this$0_;
  OrgApacheLuceneIndexIndexWriter *writer_;
}

- (instancetype)initWithOrgApacheLuceneIndexTieredMergePolicy:(OrgApacheLuceneIndexTieredMergePolicy *)outer$
                          withOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer;

- (jint)compareWithId:(OrgApacheLuceneIndexSegmentCommitInfo *)o1
               withId:(OrgApacheLuceneIndexSegmentCommitInfo *)o2;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending)

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending, writer_, OrgApacheLuceneIndexIndexWriter *)

__attribute__((unused)) static void OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending *self, OrgApacheLuceneIndexTieredMergePolicy *outer$, OrgApacheLuceneIndexIndexWriter *writer);

__attribute__((unused)) static OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending *new_OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy *outer$, OrgApacheLuceneIndexIndexWriter *writer) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending *create_OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy *outer$, OrgApacheLuceneIndexIndexWriter *writer);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending)

@interface OrgApacheLuceneIndexTieredMergePolicy_1 : OrgApacheLuceneIndexTieredMergePolicy_MergeScore {
 @public
  jdouble val$finalMergeScore_;
  jdouble val$skew_;
  jdouble val$nonDelRatio_;
}

- (instancetype)initWithDouble:(jdouble)capture$0
                    withDouble:(jdouble)capture$1
                    withDouble:(jdouble)capture$2;

- (jdouble)getScore;

- (NSString *)getExplanation;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneIndexTieredMergePolicy_1)

__attribute__((unused)) static void OrgApacheLuceneIndexTieredMergePolicy_1_initWithDouble_withDouble_withDouble_(OrgApacheLuceneIndexTieredMergePolicy_1 *self, jdouble capture$0, jdouble capture$1, jdouble capture$2);

__attribute__((unused)) static OrgApacheLuceneIndexTieredMergePolicy_1 *new_OrgApacheLuceneIndexTieredMergePolicy_1_initWithDouble_withDouble_withDouble_(jdouble capture$0, jdouble capture$1, jdouble capture$2) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneIndexTieredMergePolicy_1 *create_OrgApacheLuceneIndexTieredMergePolicy_1_initWithDouble_withDouble_withDouble_(jdouble capture$0, jdouble capture$1, jdouble capture$2);

@implementation OrgApacheLuceneIndexTieredMergePolicy

+ (jdouble)DEFAULT_NO_CFS_RATIO {
  return OrgApacheLuceneIndexTieredMergePolicy_DEFAULT_NO_CFS_RATIO;
}

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneIndexTieredMergePolicy_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (OrgApacheLuceneIndexTieredMergePolicy *)setMaxMergeAtOnceWithInt:(jint)v {
  if (v < 2) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$IC", @"maxMergeAtOnce must be > 1 (got ", v, ')'));
  }
  maxMergeAtOnce_ = v;
  return self;
}

- (jint)getMaxMergeAtOnce {
  return maxMergeAtOnce_;
}

- (OrgApacheLuceneIndexTieredMergePolicy *)setMaxMergeAtOnceExplicitWithInt:(jint)v {
  if (v < 2) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$IC", @"maxMergeAtOnceExplicit must be > 1 (got ", v, ')'));
  }
  maxMergeAtOnceExplicit_ = v;
  return self;
}

- (jint)getMaxMergeAtOnceExplicit {
  return maxMergeAtOnceExplicit_;
}

- (OrgApacheLuceneIndexTieredMergePolicy *)setMaxMergedSegmentMBWithDouble:(jdouble)v {
  if (v < 0.0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$DC", @"maxMergedSegmentMB must be >=0 (got ", v, ')'));
  }
  JreTimesAssignDoubleD(&v, 1024 * 1024);
  maxMergedSegmentBytes_ = v > JavaLangLong_MAX_VALUE ? JavaLangLong_MAX_VALUE : JreFpToLong(v);
  return self;
}

- (jdouble)getMaxMergedSegmentMB {
  return maxMergedSegmentBytes_ / 1024 / 1024.;
}

- (OrgApacheLuceneIndexTieredMergePolicy *)setReclaimDeletesWeightWithDouble:(jdouble)v {
  if (v < 0.0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$DC", @"reclaimDeletesWeight must be >= 0.0 (got ", v, ')'));
  }
  reclaimDeletesWeight_ = v;
  return self;
}

- (jdouble)getReclaimDeletesWeight {
  return reclaimDeletesWeight_;
}

- (OrgApacheLuceneIndexTieredMergePolicy *)setFloorSegmentMBWithDouble:(jdouble)v {
  if (v <= 0.0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$DC", @"floorSegmentMB must be >= 0.0 (got ", v, ')'));
  }
  JreTimesAssignDoubleD(&v, 1024 * 1024);
  floorSegmentBytes_ = v > JavaLangLong_MAX_VALUE ? JavaLangLong_MAX_VALUE : JreFpToLong(v);
  return self;
}

- (jdouble)getFloorSegmentMB {
  return floorSegmentBytes_ / (1024 * 1024.);
}

- (OrgApacheLuceneIndexTieredMergePolicy *)setForceMergeDeletesPctAllowedWithDouble:(jdouble)v {
  if (v < 0.0 || v > 100.0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$DC", @"forceMergeDeletesPctAllowed must be between 0.0 and 100.0 inclusive (got ", v, ')'));
  }
  forceMergeDeletesPctAllowed_ = v;
  return self;
}

- (jdouble)getForceMergeDeletesPctAllowed {
  return forceMergeDeletesPctAllowed_;
}

- (OrgApacheLuceneIndexTieredMergePolicy *)setSegmentsPerTierWithDouble:(jdouble)v {
  if (v < 2.0) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$DC", @"segmentsPerTier must be >= 2.0 (got ", v, ')'));
  }
  segsPerTier_ = v;
  return self;
}

- (jdouble)getSegmentsPerTier {
  return segsPerTier_;
}

- (OrgApacheLuceneIndexMergePolicy_MergeSpecification *)findMergesWithOrgApacheLuceneIndexMergeTrigger:(OrgApacheLuceneIndexMergeTrigger *)mergeTrigger
                                                                  withOrgApacheLuceneIndexSegmentInfos:(OrgApacheLuceneIndexSegmentInfos *)infos
                                                                   withOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
    OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$I$", @"findMerges: ", [((OrgApacheLuceneIndexSegmentInfos *) nil_chk(infos)) size], @" segments"), writer);
  }
  if ([((OrgApacheLuceneIndexSegmentInfos *) nil_chk(infos)) size] == 0) {
    return nil;
  }
  id<JavaUtilCollection> merging = [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) getMergingSegments];
  id<JavaUtilCollection> toBeMerged = create_JavaUtilHashSet_init();
  id<JavaUtilList> infosSorted = create_JavaUtilArrayList_initWithJavaUtilCollection_([infos asList]);
  JavaUtilCollections_sortWithJavaUtilList_withJavaUtilComparator_(infosSorted, create_OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(self, writer));
  jlong totIndexBytes = 0;
  jlong minSegmentBytes = JavaLangLong_MAX_VALUE;
  for (OrgApacheLuceneIndexSegmentCommitInfo * __strong info in infosSorted) {
    jlong segBytes = [self sizeWithOrgApacheLuceneIndexSegmentCommitInfo:info withOrgApacheLuceneIndexIndexWriter:writer];
    if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
      NSString *extra = [((id<JavaUtilCollection>) nil_chk(merging)) containsWithId:info] ? @" [merging]" : @"";
      if (segBytes >= maxMergedSegmentBytes_ / 2.0) {
        JreStrAppend(&extra, "$", @" [skip: too large]");
      }
      else if (segBytes < floorSegmentBytes_) {
        JreStrAppend(&extra, "$", @" [floored]");
      }
      OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$$$$$$", @"  seg=", [writer segStringWithOrgApacheLuceneIndexSegmentCommitInfo:info], @" size=", NSString_java_formatWithJavaUtilLocale_withNSString_withNSObjectArray_(JreLoadStatic(JavaUtilLocale, ROOT), @"%.3f", [IOSObjectArray arrayWithObjects:(id[]){ JavaLangDouble_valueOfWithDouble_(segBytes / 1024 / 1024.) } count:1 type:NSObject_class_()]), @" MB", extra), writer);
    }
    minSegmentBytes = JavaLangMath_minWithLong_withLong_(segBytes, minSegmentBytes);
    totIndexBytes += segBytes;
  }
  jint tooBigCount = 0;
  while (tooBigCount < [infosSorted size]) {
    jlong segBytes = [self sizeWithOrgApacheLuceneIndexSegmentCommitInfo:[infosSorted getWithInt:tooBigCount] withOrgApacheLuceneIndexIndexWriter:writer];
    if (segBytes < maxMergedSegmentBytes_ / 2.0) {
      break;
    }
    totIndexBytes -= segBytes;
    tooBigCount++;
  }
  minSegmentBytes = OrgApacheLuceneIndexTieredMergePolicy_floorSizeWithLong_(self, minSegmentBytes);
  jlong levelSize = minSegmentBytes;
  jlong bytesLeft = totIndexBytes;
  jdouble allowedSegCount = 0;
  while (true) {
    jdouble segCountLevel = bytesLeft / (jdouble) levelSize;
    if (segCountLevel < segsPerTier_) {
      JrePlusAssignDoubleD(&allowedSegCount, JavaLangMath_ceilWithDouble_(segCountLevel));
      break;
    }
    JrePlusAssignDoubleD(&allowedSegCount, segsPerTier_);
    JreMinusAssignLongD(&bytesLeft, segsPerTier_ * levelSize);
    levelSize *= maxMergeAtOnce_;
  }
  jint allowedSegCountInt = JreFpToInt(allowedSegCount);
  OrgApacheLuceneIndexMergePolicy_MergeSpecification *spec = nil;
  while (true) {
    jlong mergingBytes = 0;
    id<JavaUtilList> eligible = create_JavaUtilArrayList_init();
    for (jint idx = tooBigCount; idx < [infosSorted size]; idx++) {
      OrgApacheLuceneIndexSegmentCommitInfo *info = [infosSorted getWithInt:idx];
      if ([((id<JavaUtilCollection>) nil_chk(merging)) containsWithId:info]) {
        mergingBytes += [self sizeWithOrgApacheLuceneIndexSegmentCommitInfo:info withOrgApacheLuceneIndexIndexWriter:writer];
      }
      else if (![toBeMerged containsWithId:info]) {
        [eligible addWithId:info];
      }
    }
    jboolean maxMergeIsRunning = mergingBytes >= maxMergedSegmentBytes_;
    if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
      OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$I$I$I$I", @"  allowedSegmentCount=", allowedSegCountInt, @" vs count=", [infosSorted size], @" (eligible count=", [eligible size], @") tooBigCount=", tooBigCount), writer);
    }
    if ([eligible size] == 0) {
      return spec;
    }
    if ([eligible size] > allowedSegCountInt) {
      OrgApacheLuceneIndexTieredMergePolicy_MergeScore *bestScore = nil;
      id<JavaUtilList> best = nil;
      jboolean bestTooLarge = false;
      jlong bestMergeBytes = 0;
      for (jint startIdx = 0; startIdx <= [eligible size] - maxMergeAtOnce_; startIdx++) {
        jlong totAfterMergeBytes = 0;
        id<JavaUtilList> candidate = create_JavaUtilArrayList_init();
        jboolean hitTooLarge = false;
        for (jint idx = startIdx; idx < [eligible size] && [candidate size] < maxMergeAtOnce_; idx++) {
          OrgApacheLuceneIndexSegmentCommitInfo *info = [eligible getWithInt:idx];
          jlong segBytes = [self sizeWithOrgApacheLuceneIndexSegmentCommitInfo:info withOrgApacheLuceneIndexIndexWriter:writer];
          if (totAfterMergeBytes + segBytes > maxMergedSegmentBytes_) {
            hitTooLarge = true;
            continue;
          }
          [candidate addWithId:info];
          totAfterMergeBytes += segBytes;
        }
        JreAssert([candidate size] > 0, @"org/apache/lucene/index/TieredMergePolicy.java:409 condition failed: assert candidate.size() > 0;");
        OrgApacheLuceneIndexTieredMergePolicy_MergeScore *score = [self scoreWithJavaUtilList:candidate withBoolean:hitTooLarge withLong:mergingBytes withOrgApacheLuceneIndexIndexWriter:writer];
        if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
          OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$$$DC$$Z$$", @"  maybe=", [writer segStringWithJavaLangIterable:candidate], @" score=", [((OrgApacheLuceneIndexTieredMergePolicy_MergeScore *) nil_chk(score)) getScore], ' ', [score getExplanation], @" tooLarge=", hitTooLarge, @" size=", NSString_java_formatWithJavaUtilLocale_withNSString_withNSObjectArray_(JreLoadStatic(JavaUtilLocale, ROOT), @"%.3f MB", [IOSObjectArray arrayWithObjects:(id[]){ JavaLangDouble_valueOfWithDouble_(totAfterMergeBytes / 1024. / 1024.) } count:1 type:NSObject_class_()])), writer);
        }
        if ((bestScore == nil || [((OrgApacheLuceneIndexTieredMergePolicy_MergeScore *) nil_chk(score)) getScore] < [bestScore getScore]) && (!hitTooLarge || !maxMergeIsRunning)) {
          best = candidate;
          bestScore = score;
          bestTooLarge = hitTooLarge;
          bestMergeBytes = totAfterMergeBytes;
        }
      }
      if (best != nil) {
        if (spec == nil) {
          spec = create_OrgApacheLuceneIndexMergePolicy_MergeSpecification_init();
        }
        OrgApacheLuceneIndexMergePolicy_OneMerge *merge = create_OrgApacheLuceneIndexMergePolicy_OneMerge_initWithJavaUtilList_(best);
        [spec addWithOrgApacheLuceneIndexMergePolicy_OneMerge:merge];
        for (OrgApacheLuceneIndexSegmentCommitInfo * __strong info in nil_chk(merge->segments_)) {
          [toBeMerged addWithId:info];
        }
        if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
          OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$$$$$$C$$", @"  add merge=", [writer segStringWithJavaLangIterable:merge->segments_], @" size=", NSString_java_formatWithJavaUtilLocale_withNSString_withNSObjectArray_(JreLoadStatic(JavaUtilLocale, ROOT), @"%.3f MB", [IOSObjectArray arrayWithObjects:(id[]){ JavaLangDouble_valueOfWithDouble_(bestMergeBytes / 1024. / 1024.) } count:1 type:NSObject_class_()]), @" score=", NSString_java_formatWithJavaUtilLocale_withNSString_withNSObjectArray_(JreLoadStatic(JavaUtilLocale, ROOT), @"%.3f", [IOSObjectArray arrayWithObjects:(id[]){ JavaLangDouble_valueOfWithDouble_([((OrgApacheLuceneIndexTieredMergePolicy_MergeScore *) nil_chk(bestScore)) getScore]) } count:1 type:NSObject_class_()]), ' ', [bestScore getExplanation], (bestTooLarge ? @" [max merge]" : @"")), writer);
        }
      }
      else {
        return spec;
      }
    }
    else {
      return spec;
    }
  }
}

- (OrgApacheLuceneIndexTieredMergePolicy_MergeScore *)scoreWithJavaUtilList:(id<JavaUtilList>)candidate
                                                                withBoolean:(jboolean)hitTooLarge
                                                                   withLong:(jlong)mergingBytes
                                        withOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  jlong totBeforeMergeBytes = 0;
  jlong totAfterMergeBytes = 0;
  jlong totAfterMergeBytesFloored = 0;
  for (OrgApacheLuceneIndexSegmentCommitInfo * __strong info in nil_chk(candidate)) {
    jlong segBytes = [self sizeWithOrgApacheLuceneIndexSegmentCommitInfo:info withOrgApacheLuceneIndexIndexWriter:writer];
    totAfterMergeBytes += segBytes;
    totAfterMergeBytesFloored += OrgApacheLuceneIndexTieredMergePolicy_floorSizeWithLong_(self, segBytes);
    totBeforeMergeBytes += [((OrgApacheLuceneIndexSegmentCommitInfo *) nil_chk(info)) sizeInBytes];
  }
  jdouble skew;
  if (hitTooLarge) {
    skew = 1.0 / maxMergeAtOnce_;
  }
  else {
    skew = ((jdouble) OrgApacheLuceneIndexTieredMergePolicy_floorSizeWithLong_(self, [self sizeWithOrgApacheLuceneIndexSegmentCommitInfo:[candidate getWithInt:0] withOrgApacheLuceneIndexIndexWriter:writer])) / totAfterMergeBytesFloored;
  }
  jdouble mergeScore = skew;
  JreTimesAssignDoubleD(&mergeScore, JavaLangMath_powWithDouble_withDouble_(totAfterMergeBytes, 0.05));
  jdouble nonDelRatio = ((jdouble) totAfterMergeBytes) / totBeforeMergeBytes;
  JreTimesAssignDoubleD(&mergeScore, JavaLangMath_powWithDouble_withDouble_(nonDelRatio, reclaimDeletesWeight_));
  jdouble finalMergeScore = mergeScore;
  return create_OrgApacheLuceneIndexTieredMergePolicy_1_initWithDouble_withDouble_withDouble_(finalMergeScore, skew, nonDelRatio);
}

- (OrgApacheLuceneIndexMergePolicy_MergeSpecification *)findForcedMergesWithOrgApacheLuceneIndexSegmentInfos:(OrgApacheLuceneIndexSegmentInfos *)infos
                                                                                                     withInt:(jint)maxSegmentCount
                                                                                             withJavaUtilMap:(id<JavaUtilMap>)segmentsToMerge
                                                                         withOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
    OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$I$$$@", @"findForcedMerges maxSegmentCount=", maxSegmentCount, @" infos=", [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) segStringWithJavaLangIterable:infos], @" segmentsToMerge=", segmentsToMerge), writer);
  }
  id<JavaUtilList> eligible = create_JavaUtilArrayList_init();
  jboolean forceMergeRunning = false;
  id<JavaUtilCollection> merging = [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) getMergingSegments];
  jboolean segmentIsOriginal = false;
  for (OrgApacheLuceneIndexSegmentCommitInfo * __strong info in nil_chk(infos)) {
    JavaLangBoolean *isOriginal = [((id<JavaUtilMap>) nil_chk(segmentsToMerge)) getWithId:info];
    if (isOriginal != nil) {
      segmentIsOriginal = [isOriginal booleanValue];
      if (![((id<JavaUtilCollection>) nil_chk(merging)) containsWithId:info]) {
        [eligible addWithId:info];
      }
      else {
        forceMergeRunning = true;
      }
    }
  }
  if ([eligible size] == 0) {
    return nil;
  }
  if ((maxSegmentCount > 1 && [eligible size] <= maxSegmentCount) || (maxSegmentCount == 1 && [eligible size] == 1 && (!segmentIsOriginal || [self isMergedWithOrgApacheLuceneIndexSegmentInfos:infos withOrgApacheLuceneIndexSegmentCommitInfo:[eligible getWithInt:0] withOrgApacheLuceneIndexIndexWriter:writer]))) {
    if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
      OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, @"already merged", writer);
    }
    return nil;
  }
  JavaUtilCollections_sortWithJavaUtilList_withJavaUtilComparator_(eligible, create_OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(self, writer));
  if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
    OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$@", @"eligible=", eligible), writer);
    OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$Z", @"forceMergeRunning=", forceMergeRunning), writer);
  }
  jint end = [eligible size];
  OrgApacheLuceneIndexMergePolicy_MergeSpecification *spec = nil;
  while (end >= maxMergeAtOnceExplicit_ + maxSegmentCount - 1) {
    if (spec == nil) {
      spec = create_OrgApacheLuceneIndexMergePolicy_MergeSpecification_init();
    }
    OrgApacheLuceneIndexMergePolicy_OneMerge *merge = create_OrgApacheLuceneIndexMergePolicy_OneMerge_initWithJavaUtilList_([eligible subListWithInt:end - maxMergeAtOnceExplicit_ withInt:end]);
    if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
      OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$$", @"add merge=", [writer segStringWithJavaLangIterable:merge->segments_]), writer);
    }
    [spec addWithOrgApacheLuceneIndexMergePolicy_OneMerge:merge];
    end -= maxMergeAtOnceExplicit_;
  }
  if (spec == nil && !forceMergeRunning) {
    jint numToMerge = end - maxSegmentCount + 1;
    OrgApacheLuceneIndexMergePolicy_OneMerge *merge = create_OrgApacheLuceneIndexMergePolicy_OneMerge_initWithJavaUtilList_([eligible subListWithInt:end - numToMerge withInt:end]);
    if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
      OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$$", @"add final merge=", [merge segString]), writer);
    }
    spec = create_OrgApacheLuceneIndexMergePolicy_MergeSpecification_init();
    [spec addWithOrgApacheLuceneIndexMergePolicy_OneMerge:merge];
  }
  return spec;
}

- (OrgApacheLuceneIndexMergePolicy_MergeSpecification *)findForcedDeletesMergesWithOrgApacheLuceneIndexSegmentInfos:(OrgApacheLuceneIndexSegmentInfos *)infos
                                                                                withOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
    OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$$$D", @"findForcedDeletesMerges infos=", [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) segStringWithJavaLangIterable:infos], @" forceMergeDeletesPctAllowed=", forceMergeDeletesPctAllowed_), writer);
  }
  id<JavaUtilList> eligible = create_JavaUtilArrayList_init();
  id<JavaUtilCollection> merging = [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) getMergingSegments];
  for (OrgApacheLuceneIndexSegmentCommitInfo * __strong info in nil_chk(infos)) {
    jdouble pctDeletes = 100. * ((jdouble) [writer numDeletedDocsWithOrgApacheLuceneIndexSegmentCommitInfo:info]) / [((OrgApacheLuceneIndexSegmentInfo *) nil_chk(((OrgApacheLuceneIndexSegmentCommitInfo *) nil_chk(info))->info_)) maxDoc];
    if (pctDeletes > forceMergeDeletesPctAllowed_ && ![((id<JavaUtilCollection>) nil_chk(merging)) containsWithId:info]) {
      [eligible addWithId:info];
    }
  }
  if ([eligible size] == 0) {
    return nil;
  }
  JavaUtilCollections_sortWithJavaUtilList_withJavaUtilComparator_(eligible, create_OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(self, writer));
  if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
    OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$@", @"eligible=", eligible), writer);
  }
  jint start = 0;
  OrgApacheLuceneIndexMergePolicy_MergeSpecification *spec = nil;
  while (start < [eligible size]) {
    jint end = JavaLangMath_minWithInt_withInt_(start + maxMergeAtOnceExplicit_, [eligible size]);
    if (spec == nil) {
      spec = create_OrgApacheLuceneIndexMergePolicy_MergeSpecification_init();
    }
    OrgApacheLuceneIndexMergePolicy_OneMerge *merge = create_OrgApacheLuceneIndexMergePolicy_OneMerge_initWithJavaUtilList_([eligible subListWithInt:start withInt:end]);
    if (OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer)) {
      OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, JreStrcat("$$", @"add merge=", [writer segStringWithJavaLangIterable:merge->segments_]), writer);
    }
    [spec addWithOrgApacheLuceneIndexMergePolicy_OneMerge:merge];
    start = end;
  }
  return spec;
}

- (jlong)floorSizeWithLong:(jlong)bytes {
  return OrgApacheLuceneIndexTieredMergePolicy_floorSizeWithLong_(self, bytes);
}

- (jboolean)verboseWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  return OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(self, writer);
}

- (void)messageWithNSString:(NSString *)message
withOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(self, message, writer);
}

- (NSString *)description {
  JavaLangStringBuilder *sb = create_JavaLangStringBuilder_initWithNSString_(JreStrcat("C$$", '[', [[self java_getClass] getSimpleName], @": "));
  [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@"maxMergeAtOnce="])) appendWithInt:maxMergeAtOnce_])) appendWithNSString:@", "];
  [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@"maxMergeAtOnceExplicit="])) appendWithInt:maxMergeAtOnceExplicit_])) appendWithNSString:@", "];
  [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@"maxMergedSegmentMB="])) appendWithDouble:maxMergedSegmentBytes_ / 1024 / 1024.])) appendWithNSString:@", "];
  [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@"floorSegmentMB="])) appendWithDouble:floorSegmentBytes_ / 1024 / 1024.])) appendWithNSString:@", "];
  [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@"forceMergeDeletesPctAllowed="])) appendWithDouble:forceMergeDeletesPctAllowed_])) appendWithNSString:@", "];
  [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@"segmentsPerTier="])) appendWithDouble:segsPerTier_])) appendWithNSString:@", "];
  [((JavaLangStringBuilder *) nil_chk([((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@"maxCFSSegmentSizeMB="])) appendWithDouble:[self getMaxCFSSegmentSizeMB]])) appendWithNSString:@", "];
  [((JavaLangStringBuilder *) nil_chk([sb appendWithNSString:@"noCFSRatio="])) appendWithDouble:noCFSRatio_];
  return [sb description];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTieredMergePolicy;", 0x1, 0, 1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTieredMergePolicy;", 0x1, 2, 1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTieredMergePolicy;", 0x1, 3, 4, -1, -1, -1, -1 },
    { NULL, "D", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTieredMergePolicy;", 0x1, 5, 4, -1, -1, -1, -1 },
    { NULL, "D", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTieredMergePolicy;", 0x1, 6, 4, -1, -1, -1, -1 },
    { NULL, "D", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTieredMergePolicy;", 0x1, 7, 4, -1, -1, -1, -1 },
    { NULL, "D", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTieredMergePolicy;", 0x1, 8, 4, -1, -1, -1, -1 },
    { NULL, "D", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexMergePolicy_MergeSpecification;", 0x1, 9, 10, 11, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexTieredMergePolicy_MergeScore;", 0x4, 12, 13, 11, 14, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexMergePolicy_MergeSpecification;", 0x1, 15, 16, 11, 17, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexMergePolicy_MergeSpecification;", 0x1, 18, 19, 11, -1, -1, -1 },
    { NULL, "J", 0x2, 20, 21, -1, -1, -1, -1 },
    { NULL, "Z", 0x2, 22, 23, -1, -1, -1, -1 },
    { NULL, "V", 0x2, 24, 25, -1, -1, -1, -1 },
    { NULL, "LNSString;", 0x1, 26, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(setMaxMergeAtOnceWithInt:);
  methods[2].selector = @selector(getMaxMergeAtOnce);
  methods[3].selector = @selector(setMaxMergeAtOnceExplicitWithInt:);
  methods[4].selector = @selector(getMaxMergeAtOnceExplicit);
  methods[5].selector = @selector(setMaxMergedSegmentMBWithDouble:);
  methods[6].selector = @selector(getMaxMergedSegmentMB);
  methods[7].selector = @selector(setReclaimDeletesWeightWithDouble:);
  methods[8].selector = @selector(getReclaimDeletesWeight);
  methods[9].selector = @selector(setFloorSegmentMBWithDouble:);
  methods[10].selector = @selector(getFloorSegmentMB);
  methods[11].selector = @selector(setForceMergeDeletesPctAllowedWithDouble:);
  methods[12].selector = @selector(getForceMergeDeletesPctAllowed);
  methods[13].selector = @selector(setSegmentsPerTierWithDouble:);
  methods[14].selector = @selector(getSegmentsPerTier);
  methods[15].selector = @selector(findMergesWithOrgApacheLuceneIndexMergeTrigger:withOrgApacheLuceneIndexSegmentInfos:withOrgApacheLuceneIndexIndexWriter:);
  methods[16].selector = @selector(scoreWithJavaUtilList:withBoolean:withLong:withOrgApacheLuceneIndexIndexWriter:);
  methods[17].selector = @selector(findForcedMergesWithOrgApacheLuceneIndexSegmentInfos:withInt:withJavaUtilMap:withOrgApacheLuceneIndexIndexWriter:);
  methods[18].selector = @selector(findForcedDeletesMergesWithOrgApacheLuceneIndexSegmentInfos:withOrgApacheLuceneIndexIndexWriter:);
  methods[19].selector = @selector(floorSizeWithLong:);
  methods[20].selector = @selector(verboseWithOrgApacheLuceneIndexIndexWriter:);
  methods[21].selector = @selector(messageWithNSString:withOrgApacheLuceneIndexIndexWriter:);
  methods[22].selector = @selector(description);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "DEFAULT_NO_CFS_RATIO", "D", .constantValue.asDouble = OrgApacheLuceneIndexTieredMergePolicy_DEFAULT_NO_CFS_RATIO, 0x19, -1, -1, -1, -1 },
    { "maxMergeAtOnce_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "maxMergedSegmentBytes_", "J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "maxMergeAtOnceExplicit_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "floorSegmentBytes_", "J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "segsPerTier_", "D", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "forceMergeDeletesPctAllowed_", "D", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "reclaimDeletesWeight_", "D", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "setMaxMergeAtOnce", "I", "setMaxMergeAtOnceExplicit", "setMaxMergedSegmentMB", "D", "setReclaimDeletesWeight", "setFloorSegmentMB", "setForceMergeDeletesPctAllowed", "setSegmentsPerTier", "findMerges", "LOrgApacheLuceneIndexMergeTrigger;LOrgApacheLuceneIndexSegmentInfos;LOrgApacheLuceneIndexIndexWriter;", "LJavaIoIOException;", "score", "LJavaUtilList;ZJLOrgApacheLuceneIndexIndexWriter;", "(Ljava/util/List<Lorg/apache/lucene/index/SegmentCommitInfo;>;ZJLorg/apache/lucene/index/IndexWriter;)Lorg/apache/lucene/index/TieredMergePolicy$MergeScore;", "findForcedMerges", "LOrgApacheLuceneIndexSegmentInfos;ILJavaUtilMap;LOrgApacheLuceneIndexIndexWriter;", "(Lorg/apache/lucene/index/SegmentInfos;ILjava/util/Map<Lorg/apache/lucene/index/SegmentCommitInfo;Ljava/lang/Boolean;>;Lorg/apache/lucene/index/IndexWriter;)Lorg/apache/lucene/index/MergePolicy$MergeSpecification;", "findForcedDeletesMerges", "LOrgApacheLuceneIndexSegmentInfos;LOrgApacheLuceneIndexIndexWriter;", "floorSize", "J", "verbose", "LOrgApacheLuceneIndexIndexWriter;", "message", "LNSString;LOrgApacheLuceneIndexIndexWriter;", "toString", "LOrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending;LOrgApacheLuceneIndexTieredMergePolicy_MergeScore;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexTieredMergePolicy = { "TieredMergePolicy", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x1, 23, 8, -1, 27, -1, -1, -1 };
  return &_OrgApacheLuceneIndexTieredMergePolicy;
}

@end

void OrgApacheLuceneIndexTieredMergePolicy_init(OrgApacheLuceneIndexTieredMergePolicy *self) {
  OrgApacheLuceneIndexMergePolicy_initWithDouble_withLong_(self, OrgApacheLuceneIndexTieredMergePolicy_DEFAULT_NO_CFS_RATIO, OrgApacheLuceneIndexMergePolicy_DEFAULT_MAX_CFS_SEGMENT_SIZE);
  self->maxMergeAtOnce_ = 10;
  self->maxMergedSegmentBytes_ = 5 * 1024 * 1024 * 1024LL;
  self->maxMergeAtOnceExplicit_ = 30;
  self->floorSegmentBytes_ = 2 * 1024 * 1024LL;
  self->segsPerTier_ = 10.0;
  self->forceMergeDeletesPctAllowed_ = 10.0;
  self->reclaimDeletesWeight_ = 2.0;
}

OrgApacheLuceneIndexTieredMergePolicy *new_OrgApacheLuceneIndexTieredMergePolicy_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexTieredMergePolicy, init)
}

OrgApacheLuceneIndexTieredMergePolicy *create_OrgApacheLuceneIndexTieredMergePolicy_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexTieredMergePolicy, init)
}

jlong OrgApacheLuceneIndexTieredMergePolicy_floorSizeWithLong_(OrgApacheLuceneIndexTieredMergePolicy *self, jlong bytes) {
  return JavaLangMath_maxWithLong_withLong_(self->floorSegmentBytes_, bytes);
}

jboolean OrgApacheLuceneIndexTieredMergePolicy_verboseWithOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy *self, OrgApacheLuceneIndexIndexWriter *writer) {
  return writer != nil && [((OrgApacheLuceneUtilInfoStream *) nil_chk(writer->infoStream_)) isEnabledWithNSString:@"TMP"];
}

void OrgApacheLuceneIndexTieredMergePolicy_messageWithNSString_withOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy *self, NSString *message, OrgApacheLuceneIndexIndexWriter *writer) {
  [((OrgApacheLuceneUtilInfoStream *) nil_chk(((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer))->infoStream_)) messageWithNSString:@"TMP" withNSString:message];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexTieredMergePolicy)

@implementation OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending

- (instancetype)initWithOrgApacheLuceneIndexTieredMergePolicy:(OrgApacheLuceneIndexTieredMergePolicy *)outer$
                          withOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(self, outer$, writer);
  return self;
}

- (jint)compareWithId:(OrgApacheLuceneIndexSegmentCommitInfo *)o1
               withId:(OrgApacheLuceneIndexSegmentCommitInfo *)o2 {
  @try {
    jlong sz1 = [this$0_ sizeWithOrgApacheLuceneIndexSegmentCommitInfo:o1 withOrgApacheLuceneIndexIndexWriter:writer_];
    jlong sz2 = [this$0_ sizeWithOrgApacheLuceneIndexSegmentCommitInfo:o2 withOrgApacheLuceneIndexIndexWriter:writer_];
    if (sz1 > sz2) {
      return -1;
    }
    else if (sz2 > sz1) {
      return 1;
    }
    else {
      return [((NSString *) nil_chk(((OrgApacheLuceneIndexSegmentInfo *) nil_chk(((OrgApacheLuceneIndexSegmentCommitInfo *) nil_chk(o1))->info_))->name_)) compareToWithId:((OrgApacheLuceneIndexSegmentCommitInfo *) nil_chk(o2))->info_->name_];
    }
  }
  @catch (JavaIoIOException *ioe) {
    @throw create_JavaLangRuntimeException_initWithJavaLangThrowable_(ioe);
  }
}

- (id<JavaUtilComparator>)reversed {
  return JavaUtilComparator_reversed(self);
}

- (id<JavaUtilComparator>)thenComparingWithJavaUtilComparator:(id<JavaUtilComparator>)arg0 {
  return JavaUtilComparator_thenComparingWithJavaUtilComparator_(self, arg0);
}

- (id<JavaUtilComparator>)thenComparingWithJavaUtilFunctionFunction:(id<JavaUtilFunctionFunction>)arg0
                                             withJavaUtilComparator:(id<JavaUtilComparator>)arg1 {
  return JavaUtilComparator_thenComparingWithJavaUtilFunctionFunction_withJavaUtilComparator_(self, arg0, arg1);
}

- (id<JavaUtilComparator>)thenComparingWithJavaUtilFunctionFunction:(id<JavaUtilFunctionFunction>)arg0 {
  return JavaUtilComparator_thenComparingWithJavaUtilFunctionFunction_(self, arg0);
}

- (id<JavaUtilComparator>)thenComparingIntWithJavaUtilFunctionToIntFunction:(id<JavaUtilFunctionToIntFunction>)arg0 {
  return JavaUtilComparator_thenComparingIntWithJavaUtilFunctionToIntFunction_(self, arg0);
}

- (id<JavaUtilComparator>)thenComparingLongWithJavaUtilFunctionToLongFunction:(id<JavaUtilFunctionToLongFunction>)arg0 {
  return JavaUtilComparator_thenComparingLongWithJavaUtilFunctionToLongFunction_(self, arg0);
}

- (id<JavaUtilComparator>)thenComparingDoubleWithJavaUtilFunctionToDoubleFunction:(id<JavaUtilFunctionToDoubleFunction>)arg0 {
  return JavaUtilComparator_thenComparingDoubleWithJavaUtilFunctionToDoubleFunction_(self, arg0);
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(writer_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
    { NULL, "I", 0x1, 1, 2, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneIndexTieredMergePolicy:withOrgApacheLuceneIndexIndexWriter:);
  methods[1].selector = @selector(compareWithId:withId:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", "LOrgApacheLuceneIndexTieredMergePolicy;", .constantValue.asLong = 0, 0x1012, -1, -1, -1, -1 },
    { "writer_", "LOrgApacheLuceneIndexIndexWriter;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneIndexTieredMergePolicy;LOrgApacheLuceneIndexIndexWriter;", "compare", "LOrgApacheLuceneIndexSegmentCommitInfo;LOrgApacheLuceneIndexSegmentCommitInfo;", "LOrgApacheLuceneIndexTieredMergePolicy;", "Ljava/lang/Object;Ljava/util/Comparator<Lorg/apache/lucene/index/SegmentCommitInfo;>;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending = { "SegmentByteSizeDescending", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x2, 2, 2, 3, -1, -1, 4, -1 };
  return &_OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending;
}

@end

void OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending *self, OrgApacheLuceneIndexTieredMergePolicy *outer$, OrgApacheLuceneIndexIndexWriter *writer) {
  JreStrongAssign(&self->this$0_, outer$);
  NSObject_init(self);
  JreStrongAssign(&self->writer_, writer);
}

OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending *new_OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy *outer$, OrgApacheLuceneIndexIndexWriter *writer) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending, initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_, outer$, writer)
}

OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending *create_OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending_initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexTieredMergePolicy *outer$, OrgApacheLuceneIndexIndexWriter *writer) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending, initWithOrgApacheLuceneIndexTieredMergePolicy_withOrgApacheLuceneIndexIndexWriter_, outer$, writer)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexTieredMergePolicy_SegmentByteSizeDescending)

@implementation OrgApacheLuceneIndexTieredMergePolicy_MergeScore

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneIndexTieredMergePolicy_MergeScore_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (jdouble)getScore {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (NSString *)getExplanation {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x4, -1, -1, -1, -1, -1, -1 },
    { NULL, "D", 0x400, -1, -1, -1, -1, -1, -1 },
    { NULL, "LNSString;", 0x400, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(getScore);
  methods[2].selector = @selector(getExplanation);
  #pragma clang diagnostic pop
  static const void *ptrTable[] = { "LOrgApacheLuceneIndexTieredMergePolicy;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexTieredMergePolicy_MergeScore = { "MergeScore", "org.apache.lucene.index", ptrTable, methods, NULL, 7, 0x40c, 3, 0, 0, -1, -1, -1, -1 };
  return &_OrgApacheLuceneIndexTieredMergePolicy_MergeScore;
}

@end

void OrgApacheLuceneIndexTieredMergePolicy_MergeScore_init(OrgApacheLuceneIndexTieredMergePolicy_MergeScore *self) {
  NSObject_init(self);
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexTieredMergePolicy_MergeScore)

@implementation OrgApacheLuceneIndexTieredMergePolicy_1

- (instancetype)initWithDouble:(jdouble)capture$0
                    withDouble:(jdouble)capture$1
                    withDouble:(jdouble)capture$2 {
  OrgApacheLuceneIndexTieredMergePolicy_1_initWithDouble_withDouble_withDouble_(self, capture$0, capture$1, capture$2);
  return self;
}

- (jdouble)getScore {
  return val$finalMergeScore_;
}

- (NSString *)getExplanation {
  return JreStrcat("$$$$", @"skew=", NSString_java_formatWithJavaUtilLocale_withNSString_withNSObjectArray_(JreLoadStatic(JavaUtilLocale, ROOT), @"%.3f", [IOSObjectArray arrayWithObjects:(id[]){ JavaLangDouble_valueOfWithDouble_(val$skew_) } count:1 type:NSObject_class_()]), @" nonDelRatio=", NSString_java_formatWithJavaUtilLocale_withNSString_withNSObjectArray_(JreLoadStatic(JavaUtilLocale, ROOT), @"%.3f", [IOSObjectArray arrayWithObjects:(id[]){ JavaLangDouble_valueOfWithDouble_(val$nonDelRatio_) } count:1 type:NSObject_class_()]));
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
    { NULL, "D", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LNSString;", 0x1, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithDouble:withDouble:withDouble:);
  methods[1].selector = @selector(getScore);
  methods[2].selector = @selector(getExplanation);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "val$finalMergeScore_", "D", .constantValue.asLong = 0, 0x1012, -1, -1, -1, -1 },
    { "val$skew_", "D", .constantValue.asLong = 0, 0x1012, -1, -1, -1, -1 },
    { "val$nonDelRatio_", "D", .constantValue.asLong = 0, 0x1012, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "DDD", "LOrgApacheLuceneIndexTieredMergePolicy;", "scoreWithJavaUtilList:withBoolean:withLong:withOrgApacheLuceneIndexIndexWriter:" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexTieredMergePolicy_1 = { "", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x8010, 3, 3, 1, -1, 2, -1, -1 };
  return &_OrgApacheLuceneIndexTieredMergePolicy_1;
}

@end

void OrgApacheLuceneIndexTieredMergePolicy_1_initWithDouble_withDouble_withDouble_(OrgApacheLuceneIndexTieredMergePolicy_1 *self, jdouble capture$0, jdouble capture$1, jdouble capture$2) {
  self->val$finalMergeScore_ = capture$0;
  self->val$skew_ = capture$1;
  self->val$nonDelRatio_ = capture$2;
  OrgApacheLuceneIndexTieredMergePolicy_MergeScore_init(self);
}

OrgApacheLuceneIndexTieredMergePolicy_1 *new_OrgApacheLuceneIndexTieredMergePolicy_1_initWithDouble_withDouble_withDouble_(jdouble capture$0, jdouble capture$1, jdouble capture$2) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexTieredMergePolicy_1, initWithDouble_withDouble_withDouble_, capture$0, capture$1, capture$2)
}

OrgApacheLuceneIndexTieredMergePolicy_1 *create_OrgApacheLuceneIndexTieredMergePolicy_1_initWithDouble_withDouble_withDouble_(jdouble capture$0, jdouble capture$1, jdouble capture$2) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexTieredMergePolicy_1, initWithDouble_withDouble_withDouble_, capture$0, capture$1, capture$2)
}
