//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/index/DocumentsWriter.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/Double.h"
#include "java/lang/Iterable.h"
#include "java/lang/Thread.h"
#include "java/util/Collection.h"
#include "java/util/Collections.h"
#include "java/util/List.h"
#include "java/util/Locale.h"
#include "java/util/Queue.h"
#include "java/util/Set.h"
#include "java/util/concurrent/ConcurrentLinkedQueue.h"
#include "java/util/concurrent/atomic/AtomicInteger.h"
#include "java/util/concurrent/atomic/AtomicLong.h"
#include "org/apache/lucene/analysis/Analyzer.h"
#include "org/apache/lucene/index/AbortingException.h"
#include "org/apache/lucene/index/BufferedUpdatesStream.h"
#include "org/apache/lucene/index/DocumentsWriter.h"
#include "org/apache/lucene/index/DocumentsWriterDeleteQueue.h"
#include "org/apache/lucene/index/DocumentsWriterFlushControl.h"
#include "org/apache/lucene/index/DocumentsWriterFlushQueue.h"
#include "org/apache/lucene/index/DocumentsWriterPerThread.h"
#include "org/apache/lucene/index/DocumentsWriterPerThreadPool.h"
#include "org/apache/lucene/index/FieldInfos.h"
#include "org/apache/lucene/index/FlushPolicy.h"
#include "org/apache/lucene/index/IndexWriter.h"
#include "org/apache/lucene/index/IndexWriterConfig.h"
#include "org/apache/lucene/index/LiveIndexWriterConfig.h"
#include "org/apache/lucene/index/SegmentInfo.h"
#include "org/apache/lucene/index/Term.h"
#include "org/apache/lucene/store/AlreadyClosedException.h"
#include "org/apache/lucene/store/Directory.h"
#include "org/apache/lucene/util/InfoStream.h"

@interface OrgApacheLuceneIndexDocumentsWriter () {
 @public
  OrgApacheLuceneStoreDirectory *directoryOrig_;
  OrgApacheLuceneStoreDirectory *directory_;
  volatile_jboolean closed_;
  OrgApacheLuceneUtilInfoStream *infoStream_;
  OrgApacheLuceneIndexLiveIndexWriterConfig *config_;
  JavaUtilConcurrentAtomicAtomicInteger *numDocsInRAM_;
  OrgApacheLuceneIndexDocumentsWriterFlushQueue *ticketQueue_;
  volatile_jboolean pendingChangesInCurrentFullFlush_;
  __unsafe_unretained OrgApacheLuceneIndexIndexWriter *writer_;
  id<JavaUtilQueue> events_;
  volatile_id currentFullFlushDelQueue_;
}

- (jboolean)applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:(OrgApacheLuceneIndexDocumentsWriterDeleteQueue *)deleteQueue;

- (void)ensureOpen;

/*!
 @brief Returns how many documents were aborted.
 */
- (jint)abortThreadStateWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:(OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *)perThread;

- (jboolean)preUpdate;

- (jboolean)postUpdateWithOrgApacheLuceneIndexDocumentsWriterPerThread:(OrgApacheLuceneIndexDocumentsWriterPerThread *)flushingDWPT
                                                           withBoolean:(jboolean)hasEvents;

- (void)ensureInitializedWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:(OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *)state;

- (jboolean)doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread:(OrgApacheLuceneIndexDocumentsWriterPerThread *)flushingDWPT;

- (jboolean)setFlushingDeleteQueueWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:(OrgApacheLuceneIndexDocumentsWriterDeleteQueue *)session;

- (void)putEventWithOrgApacheLuceneIndexIndexWriter_Event:(id<OrgApacheLuceneIndexIndexWriter_Event>)event;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter, directoryOrig_, OrgApacheLuceneStoreDirectory *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter, directory_, OrgApacheLuceneStoreDirectory *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter, infoStream_, OrgApacheLuceneUtilInfoStream *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter, config_, OrgApacheLuceneIndexLiveIndexWriterConfig *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter, numDocsInRAM_, JavaUtilConcurrentAtomicAtomicInteger *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter, ticketQueue_, OrgApacheLuceneIndexDocumentsWriterFlushQueue *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter, events_, id<JavaUtilQueue>)
J2OBJC_VOLATILE_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter, currentFullFlushDelQueue_, OrgApacheLuceneIndexDocumentsWriterDeleteQueue *)

__attribute__((unused)) static jboolean OrgApacheLuceneIndexDocumentsWriter_applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterDeleteQueue *deleteQueue);

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriter_ensureOpen(OrgApacheLuceneIndexDocumentsWriter *self);

__attribute__((unused)) static jint OrgApacheLuceneIndexDocumentsWriter_abortThreadStateWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *perThread);

__attribute__((unused)) static jboolean OrgApacheLuceneIndexDocumentsWriter_preUpdate(OrgApacheLuceneIndexDocumentsWriter *self);

__attribute__((unused)) static jboolean OrgApacheLuceneIndexDocumentsWriter_postUpdateWithOrgApacheLuceneIndexDocumentsWriterPerThread_withBoolean_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterPerThread *flushingDWPT, jboolean hasEvents);

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriter_ensureInitializedWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *state);

__attribute__((unused)) static jboolean OrgApacheLuceneIndexDocumentsWriter_doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterPerThread *flushingDWPT);

__attribute__((unused)) static jboolean OrgApacheLuceneIndexDocumentsWriter_setFlushingDeleteQueueWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterDeleteQueue *session);

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(OrgApacheLuceneIndexDocumentsWriter *self, id<OrgApacheLuceneIndexIndexWriter_Event> event);

@interface OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent () {
 @public
  jint instCount_;
}

- (instancetype)init;

@end

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_init(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent *self);

__attribute__((unused)) static OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent *new_OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_init() NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent *create_OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_init();

@interface OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent () {
 @public
  jint instCount_;
}

- (instancetype)init;

@end

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_init(OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent *self);

__attribute__((unused)) static OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent *new_OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_init() NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent *create_OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_init();

@interface OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent () {
 @public
  jint instCount_;
}

- (instancetype)init;

@end

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_init(OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent *self);

__attribute__((unused)) static OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent *new_OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_init() NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent *create_OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_init();

@interface OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent () {
 @public
  OrgApacheLuceneIndexSegmentInfo *info_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent, info_, OrgApacheLuceneIndexSegmentInfo *)

@interface OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent () {
 @public
  id<JavaUtilCollection> files_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent, files_, id<JavaUtilCollection>)

@implementation OrgApacheLuceneIndexDocumentsWriter

- (instancetype)initWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer
          withOrgApacheLuceneIndexLiveIndexWriterConfig:(OrgApacheLuceneIndexLiveIndexWriterConfig *)config
                      withOrgApacheLuceneStoreDirectory:(OrgApacheLuceneStoreDirectory *)directoryOrig
                      withOrgApacheLuceneStoreDirectory:(OrgApacheLuceneStoreDirectory *)directory {
  OrgApacheLuceneIndexDocumentsWriter_initWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexLiveIndexWriterConfig_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneStoreDirectory_(self, writer, config, directoryOrig, directory);
  return self;
}

- (jboolean)deleteQueriesWithOrgApacheLuceneSearchQueryArray:(IOSObjectArray *)queries {
  @synchronized(self) {
    OrgApacheLuceneIndexDocumentsWriterDeleteQueue *deleteQueue = JreLoadVolatileId(&self->deleteQueue_);
    [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(deleteQueue)) addDeleteWithOrgApacheLuceneSearchQueryArray:queries];
    [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) doOnDelete];
    return OrgApacheLuceneIndexDocumentsWriter_applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, deleteQueue);
  }
}

- (jboolean)deleteTermsWithOrgApacheLuceneIndexTermArray:(IOSObjectArray *)terms {
  @synchronized(self) {
    OrgApacheLuceneIndexDocumentsWriterDeleteQueue *deleteQueue = JreLoadVolatileId(&self->deleteQueue_);
    [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(deleteQueue)) addDeleteWithOrgApacheLuceneIndexTermArray:terms];
    [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) doOnDelete];
    return OrgApacheLuceneIndexDocumentsWriter_applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, deleteQueue);
  }
}

- (jboolean)updateDocValuesWithOrgApacheLuceneIndexDocValuesUpdateArray:(IOSObjectArray *)updates {
  @synchronized(self) {
    OrgApacheLuceneIndexDocumentsWriterDeleteQueue *deleteQueue = JreLoadVolatileId(&self->deleteQueue_);
    [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(deleteQueue)) addDocValuesUpdatesWithOrgApacheLuceneIndexDocValuesUpdateArray:updates];
    [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) doOnDelete];
    return OrgApacheLuceneIndexDocumentsWriter_applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, deleteQueue);
  }
}

- (OrgApacheLuceneIndexDocumentsWriterDeleteQueue *)currentDeleteSession {
  return JreLoadVolatileId(&deleteQueue_);
}

- (jboolean)applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:(OrgApacheLuceneIndexDocumentsWriterDeleteQueue *)deleteQueue {
  return OrgApacheLuceneIndexDocumentsWriter_applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, deleteQueue);
}

- (jint)purgeBufferWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer
                                           withBoolean:(jboolean)forced {
  if (forced) {
    return [((OrgApacheLuceneIndexDocumentsWriterFlushQueue *) nil_chk(ticketQueue_)) forcePurgeWithOrgApacheLuceneIndexIndexWriter:writer];
  }
  else {
    return [((OrgApacheLuceneIndexDocumentsWriterFlushQueue *) nil_chk(ticketQueue_)) tryPurgeWithOrgApacheLuceneIndexIndexWriter:writer];
  }
}

- (jint)getNumDocs {
  return [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(numDocsInRAM_)) get];
}

- (void)ensureOpen {
  OrgApacheLuceneIndexDocumentsWriter_ensureOpen(self);
}

- (void)abortWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  @synchronized(self) {
    JreAssert((!JavaLangThread_holdsLockWithId_(writer)), (@"IndexWriter lock should never be hold when aborting"));
    jboolean success = false;
    @try {
      [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(JreLoadVolatileId(&deleteQueue_))) clear];
      if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(infoStream_)) isEnabledWithNSString:@"DW"]) {
        [infoStream_ messageWithNSString:@"DW" withNSString:@"abort"];
      }
      jint limit = [((OrgApacheLuceneIndexDocumentsWriterPerThreadPool *) nil_chk(perThreadPool_)) getActiveThreadStateCount];
      for (jint i = 0; i < limit; i++) {
        OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *perThread = [perThreadPool_ getThreadStateWithInt:i];
        [((OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *) nil_chk(perThread)) lock];
        @try {
          OrgApacheLuceneIndexDocumentsWriter_abortThreadStateWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(self, perThread);
        }
        @finally {
          [perThread unlock];
        }
      }
      [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) abortPendingFlushes];
      [flushControl_ waitForFlush];
      success = true;
    }
    @finally {
      if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(infoStream_)) isEnabledWithNSString:@"DW"]) {
        [infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$Z", @"done abort success=", success)];
      }
    }
  }
}

- (jlong)lockAndAbortAllWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)indexWriter {
  @synchronized(self) {
    JreAssert(([((OrgApacheLuceneIndexIndexWriter *) nil_chk(indexWriter)) holdsFullFlushLock]), (@"org/apache/lucene/index/DocumentsWriter.java:239 condition failed: assert indexWriter.holdsFullFlushLock();"));
    if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(infoStream_)) isEnabledWithNSString:@"DW"]) {
      [infoStream_ messageWithNSString:@"DW" withNSString:@"lockAndAbortAll"];
    }
    jlong abortedDocCount = 0;
    jboolean success = false;
    @try {
      [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(JreLoadVolatileId(&deleteQueue_))) clear];
      jint limit = [((OrgApacheLuceneIndexDocumentsWriterPerThreadPool *) nil_chk(perThreadPool_)) getMaxThreadStates];
      [perThreadPool_ setAbort];
      for (jint i = 0; i < limit; i++) {
        OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *perThread = [perThreadPool_ getThreadStateWithInt:i];
        [((OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *) nil_chk(perThread)) lock];
        abortedDocCount += OrgApacheLuceneIndexDocumentsWriter_abortThreadStateWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(self, perThread);
      }
      [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(JreLoadVolatileId(&deleteQueue_))) clear];
      [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) abortPendingFlushes];
      [flushControl_ waitForFlush];
      success = true;
      return abortedDocCount;
    }
    @finally {
      if ([infoStream_ isEnabledWithNSString:@"DW"]) {
        [infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$Z", @"finished lockAndAbortAll success=", success)];
      }
      if (success == false) {
        [self unlockAllAfterAbortAllWithOrgApacheLuceneIndexIndexWriter:indexWriter];
      }
    }
  }
}

- (jint)abortThreadStateWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:(OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *)perThread {
  return OrgApacheLuceneIndexDocumentsWriter_abortThreadStateWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(self, perThread);
}

- (void)unlockAllAfterAbortAllWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)indexWriter {
  @synchronized(self) {
    JreAssert(([((OrgApacheLuceneIndexIndexWriter *) nil_chk(indexWriter)) holdsFullFlushLock]), (@"org/apache/lucene/index/DocumentsWriter.java:290 condition failed: assert indexWriter.holdsFullFlushLock();"));
    if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(infoStream_)) isEnabledWithNSString:@"DW"]) {
      [infoStream_ messageWithNSString:@"DW" withNSString:@"unlockAll"];
    }
    jint limit = [((OrgApacheLuceneIndexDocumentsWriterPerThreadPool *) nil_chk(perThreadPool_)) getMaxThreadStates];
    [perThreadPool_ clearAbort];
    for (jint i = 0; i < limit; i++) {
      @try {
        OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *perThread = [perThreadPool_ getThreadStateWithInt:i];
        if ([((OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *) nil_chk(perThread)) isHeldByCurrentThread]) {
          [perThread unlock];
        }
      }
      @catch (NSException *e) {
        if ([infoStream_ isEnabledWithNSString:@"DW"]) {
          [infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$I$$", @"unlockAll: could not unlock state: ", i, @" msg:", [((NSException *) nil_chk(e)) getMessage])];
        }
      }
    }
  }
}

- (jboolean)anyChanges {
  jboolean anyChanges = [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(numDocsInRAM_)) get] != 0 || [self anyDeletions] || [((OrgApacheLuceneIndexDocumentsWriterFlushQueue *) nil_chk(ticketQueue_)) hasTickets] || JreLoadVolatileBoolean(&pendingChangesInCurrentFullFlush_);
  if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(infoStream_)) isEnabledWithNSString:@"DW"] && anyChanges) {
    [infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$I$Z$Z$Z", @"anyChanges? numDocsInRam=", [numDocsInRAM_ get], @" deletes=", [self anyDeletions], @" hasTickets:", [((OrgApacheLuceneIndexDocumentsWriterFlushQueue *) nil_chk(ticketQueue_)) hasTickets], @" pendingChangesInFullFlush: ", JreLoadVolatileBoolean(&pendingChangesInCurrentFullFlush_))];
  }
  return anyChanges;
}

- (jint)getBufferedDeleteTermsSize {
  return [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(JreLoadVolatileId(&deleteQueue_))) getBufferedUpdatesTermsSize];
}

- (jint)getNumBufferedDeleteTerms {
  return [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(JreLoadVolatileId(&deleteQueue_))) numGlobalTermDeletes];
}

- (jboolean)anyDeletions {
  return [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(JreLoadVolatileId(&deleteQueue_))) anyChanges];
}

- (void)close {
  JreAssignVolatileBoolean(&closed_, true);
  [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) setClosed];
}

- (jboolean)preUpdate {
  return OrgApacheLuceneIndexDocumentsWriter_preUpdate(self);
}

- (jboolean)postUpdateWithOrgApacheLuceneIndexDocumentsWriterPerThread:(OrgApacheLuceneIndexDocumentsWriterPerThread *)flushingDWPT
                                                           withBoolean:(jboolean)hasEvents {
  return OrgApacheLuceneIndexDocumentsWriter_postUpdateWithOrgApacheLuceneIndexDocumentsWriterPerThread_withBoolean_(self, flushingDWPT, hasEvents);
}

- (void)ensureInitializedWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:(OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *)state {
  OrgApacheLuceneIndexDocumentsWriter_ensureInitializedWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(self, state);
}

- (jboolean)updateDocumentsWithJavaLangIterable:(id<JavaLangIterable>)docs
            withOrgApacheLuceneAnalysisAnalyzer:(OrgApacheLuceneAnalysisAnalyzer *)analyzer
                   withOrgApacheLuceneIndexTerm:(OrgApacheLuceneIndexTerm *)delTerm {
  jboolean hasEvents = OrgApacheLuceneIndexDocumentsWriter_preUpdate(self);
  OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *perThread = [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) obtainAndLock];
  OrgApacheLuceneIndexDocumentsWriterPerThread *flushingDWPT;
  @try {
    OrgApacheLuceneIndexDocumentsWriter_ensureOpen(self);
    OrgApacheLuceneIndexDocumentsWriter_ensureInitializedWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(self, perThread);
    JreAssert(([((OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *) nil_chk(perThread)) isInitialized]), (@"org/apache/lucene/index/DocumentsWriter.java:413 condition failed: assert perThread.isInitialized();"));
    OrgApacheLuceneIndexDocumentsWriterPerThread *dwpt = perThread->dwpt_;
    jint dwptNumDocs = [((OrgApacheLuceneIndexDocumentsWriterPerThread *) nil_chk(dwpt)) getNumDocsInRAM];
    @try {
      [dwpt updateDocumentsWithJavaLangIterable:docs withOrgApacheLuceneAnalysisAnalyzer:analyzer withOrgApacheLuceneIndexTerm:delTerm];
    }
    @catch (OrgApacheLuceneIndexAbortingException *ae) {
      [flushControl_ doOnAbortWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:perThread];
      [dwpt abort];
      @throw ae;
    }
    @finally {
      [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(numDocsInRAM_)) addAndGetWithInt:[dwpt getNumDocsInRAM] - dwptNumDocs];
    }
    jboolean isUpdate = delTerm != nil;
    flushingDWPT = [flushControl_ doAfterDocumentWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:perThread withBoolean:isUpdate];
  }
  @finally {
    [((OrgApacheLuceneIndexDocumentsWriterPerThreadPool *) nil_chk(perThreadPool_)) release__WithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:perThread];
  }
  return OrgApacheLuceneIndexDocumentsWriter_postUpdateWithOrgApacheLuceneIndexDocumentsWriterPerThread_withBoolean_(self, flushingDWPT, hasEvents);
}

- (jboolean)updateDocumentWithJavaLangIterable:(id<JavaLangIterable>)doc
           withOrgApacheLuceneAnalysisAnalyzer:(OrgApacheLuceneAnalysisAnalyzer *)analyzer
                  withOrgApacheLuceneIndexTerm:(OrgApacheLuceneIndexTerm *)delTerm {
  jboolean hasEvents = OrgApacheLuceneIndexDocumentsWriter_preUpdate(self);
  OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *perThread = [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) obtainAndLock];
  OrgApacheLuceneIndexDocumentsWriterPerThread *flushingDWPT;
  @try {
    OrgApacheLuceneIndexDocumentsWriter_ensureOpen(self);
    OrgApacheLuceneIndexDocumentsWriter_ensureInitializedWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(self, perThread);
    JreAssert(([((OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *) nil_chk(perThread)) isInitialized]), (@"org/apache/lucene/index/DocumentsWriter.java:450 condition failed: assert perThread.isInitialized();"));
    OrgApacheLuceneIndexDocumentsWriterPerThread *dwpt = perThread->dwpt_;
    jint dwptNumDocs = [((OrgApacheLuceneIndexDocumentsWriterPerThread *) nil_chk(dwpt)) getNumDocsInRAM];
    @try {
      [dwpt updateDocumentWithJavaLangIterable:doc withOrgApacheLuceneAnalysisAnalyzer:analyzer withOrgApacheLuceneIndexTerm:delTerm];
    }
    @catch (OrgApacheLuceneIndexAbortingException *ae) {
      [flushControl_ doOnAbortWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:perThread];
      [dwpt abort];
      @throw ae;
    }
    @finally {
      [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(numDocsInRAM_)) addAndGetWithInt:[dwpt getNumDocsInRAM] - dwptNumDocs];
    }
    jboolean isUpdate = delTerm != nil;
    flushingDWPT = [flushControl_ doAfterDocumentWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:perThread withBoolean:isUpdate];
  }
  @finally {
    [((OrgApacheLuceneIndexDocumentsWriterPerThreadPool *) nil_chk(perThreadPool_)) release__WithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:perThread];
  }
  return OrgApacheLuceneIndexDocumentsWriter_postUpdateWithOrgApacheLuceneIndexDocumentsWriterPerThread_withBoolean_(self, flushingDWPT, hasEvents);
}

- (jboolean)doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread:(OrgApacheLuceneIndexDocumentsWriterPerThread *)flushingDWPT {
  return OrgApacheLuceneIndexDocumentsWriter_doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread_(self, flushingDWPT);
}

- (void)subtractFlushedNumDocsWithInt:(jint)numFlushed {
  jint oldValue = [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(numDocsInRAM_)) get];
  while (![numDocsInRAM_ compareAndSetWithInt:oldValue withInt:oldValue - numFlushed]) {
    oldValue = [numDocsInRAM_ get];
  }
  JreAssert(([numDocsInRAM_ get] >= 0), (@"org/apache/lucene/index/DocumentsWriter.java:578 condition failed: assert numDocsInRAM.get() >= 0;"));
}

- (jboolean)setFlushingDeleteQueueWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:(OrgApacheLuceneIndexDocumentsWriterDeleteQueue *)session {
  return OrgApacheLuceneIndexDocumentsWriter_setFlushingDeleteQueueWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, session);
}

- (jboolean)flushAllThreads {
  OrgApacheLuceneIndexDocumentsWriterDeleteQueue *flushingDeleteQueue;
  if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(infoStream_)) isEnabledWithNSString:@"DW"]) {
    [infoStream_ messageWithNSString:@"DW" withNSString:@"startFullFlush"];
  }
  @synchronized(self) {
    JreAssignVolatileBoolean(&pendingChangesInCurrentFullFlush_, [self anyChanges]);
    flushingDeleteQueue = JreLoadVolatileId(&deleteQueue_);
    [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) markForFullFlush];
    JreAssert((OrgApacheLuceneIndexDocumentsWriter_setFlushingDeleteQueueWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, flushingDeleteQueue)), (@"org/apache/lucene/index/DocumentsWriter.java:609 condition failed: assert setFlushingDeleteQueue(flushingDeleteQueue);"));
  }
  JreAssert((JreLoadVolatileId(&currentFullFlushDelQueue_) != nil), (@"org/apache/lucene/index/DocumentsWriter.java:611 condition failed: assert currentFullFlushDelQueue != null;"));
  JreAssert((JreLoadVolatileId(&currentFullFlushDelQueue_) != JreLoadVolatileId(&deleteQueue_)), (@"org/apache/lucene/index/DocumentsWriter.java:612 condition failed: assert currentFullFlushDelQueue != deleteQueue;"));
  jboolean anythingFlushed = false;
  @try {
    OrgApacheLuceneIndexDocumentsWriterPerThread *flushingDWPT;
    while ((flushingDWPT = [flushControl_ nextPendingFlush]) != nil) {
      anythingFlushed |= OrgApacheLuceneIndexDocumentsWriter_doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread_(self, flushingDWPT);
    }
    [flushControl_ waitForFlush];
    if (!anythingFlushed && [((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(flushingDeleteQueue)) anyChanges]) {
      if ([infoStream_ isEnabledWithNSString:@"DW"]) {
        [infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$$", [((JavaLangThread *) nil_chk(JavaLangThread_currentThread())) getName], @": flush naked frozen global deletes")];
      }
      [((OrgApacheLuceneIndexDocumentsWriterFlushQueue *) nil_chk(ticketQueue_)) addDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:flushingDeleteQueue];
    }
    [((OrgApacheLuceneIndexDocumentsWriterFlushQueue *) nil_chk(ticketQueue_)) forcePurgeWithOrgApacheLuceneIndexIndexWriter:writer_];
    JreAssert((![((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(flushingDeleteQueue)) anyChanges] && ![ticketQueue_ hasTickets]), (@"org/apache/lucene/index/DocumentsWriter.java:630 condition failed: assert !flushingDeleteQueue.anyChanges() && !ticketQueue.hasTickets();"));
  }
  @finally {
    JreAssert((flushingDeleteQueue == JreLoadVolatileId(&currentFullFlushDelQueue_)), (@"org/apache/lucene/index/DocumentsWriter.java:632 condition failed: assert flushingDeleteQueue == currentFullFlushDelQueue;"));
  }
  return anythingFlushed;
}

- (void)finishFullFlushWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)indexWriter
                                               withBoolean:(jboolean)success {
  JreAssert(([((OrgApacheLuceneIndexIndexWriter *) nil_chk(indexWriter)) holdsFullFlushLock]), (@"org/apache/lucene/index/DocumentsWriter.java:638 condition failed: assert indexWriter.holdsFullFlushLock();"));
  @try {
    if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(infoStream_)) isEnabledWithNSString:@"DW"]) {
      [infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$$Z", [((JavaLangThread *) nil_chk(JavaLangThread_currentThread())) getName], @" finishFullFlush success=", success)];
    }
    JreAssert((OrgApacheLuceneIndexDocumentsWriter_setFlushingDeleteQueueWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, nil)), (@"org/apache/lucene/index/DocumentsWriter.java:643 condition failed: assert setFlushingDeleteQueue(null);"));
    if (success) {
      [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) finishFullFlush];
    }
    else {
      [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) abortFullFlushes];
    }
  }
  @finally {
    JreAssignVolatileBoolean(&pendingChangesInCurrentFullFlush_, false);
  }
}

- (OrgApacheLuceneIndexLiveIndexWriterConfig *)getIndexWriterConfig {
  return config_;
}

- (void)putEventWithOrgApacheLuceneIndexIndexWriter_Event:(id<OrgApacheLuceneIndexIndexWriter_Event>)event {
  OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(self, event);
}

- (jlong)ramBytesUsed {
  return [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(flushControl_)) ramBytesUsed];
}

- (id<JavaUtilCollection>)getChildResources {
  return JavaUtilCollections_emptyList();
}

- (id<JavaUtilQueue>)eventQueue {
  return events_;
}

- (void)__javaClone:(OrgApacheLuceneIndexDocumentsWriter *)original {
  [super __javaClone:original];
  JreCloneVolatileStrong(&deleteQueue_, &original->deleteQueue_);
  [writer_ release];
  JreCloneVolatileStrong(&currentFullFlushDelQueue_, &original->currentFullFlushDelQueue_);
}

- (void)dealloc {
  RELEASE_(directoryOrig_);
  RELEASE_(directory_);
  RELEASE_(infoStream_);
  RELEASE_(config_);
  RELEASE_(numDocsInRAM_);
  JreReleaseVolatile(&deleteQueue_);
  RELEASE_(ticketQueue_);
  RELEASE_(perThreadPool_);
  RELEASE_(flushPolicy_);
  RELEASE_(flushControl_);
  RELEASE_(events_);
  JreReleaseVolatile(&currentFullFlushDelQueue_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneIndexIndexWriter:withOrgApacheLuceneIndexLiveIndexWriterConfig:withOrgApacheLuceneStoreDirectory:withOrgApacheLuceneStoreDirectory:", "DocumentsWriter", NULL, 0x0, NULL, NULL },
    { "deleteQueriesWithOrgApacheLuceneSearchQueryArray:", "deleteQueries", "Z", 0xa0, "Ljava.io.IOException;", NULL },
    { "deleteTermsWithOrgApacheLuceneIndexTermArray:", "deleteTerms", "Z", 0xa0, "Ljava.io.IOException;", NULL },
    { "updateDocValuesWithOrgApacheLuceneIndexDocValuesUpdateArray:", "updateDocValues", "Z", 0xa0, "Ljava.io.IOException;", NULL },
    { "currentDeleteSession", NULL, "Lorg.apache.lucene.index.DocumentsWriterDeleteQueue;", 0x0, NULL, NULL },
    { "applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:", "applyAllDeletes", "Z", 0x2, "Ljava.io.IOException;", NULL },
    { "purgeBufferWithOrgApacheLuceneIndexIndexWriter:withBoolean:", "purgeBuffer", "I", 0x0, "Ljava.io.IOException;", NULL },
    { "getNumDocs", NULL, "I", 0x0, NULL, NULL },
    { "ensureOpen", NULL, "V", 0x2, "Lorg.apache.lucene.store.AlreadyClosedException;", NULL },
    { "abortWithOrgApacheLuceneIndexIndexWriter:", "abort", "V", 0x20, NULL, NULL },
    { "lockAndAbortAllWithOrgApacheLuceneIndexIndexWriter:", "lockAndAbortAll", "J", 0x20, NULL, NULL },
    { "abortThreadStateWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:", "abortThreadState", "I", 0x2, NULL, NULL },
    { "unlockAllAfterAbortAllWithOrgApacheLuceneIndexIndexWriter:", "unlockAllAfterAbortAll", "V", 0x20, NULL, NULL },
    { "anyChanges", NULL, "Z", 0x0, NULL, NULL },
    { "getBufferedDeleteTermsSize", NULL, "I", 0x1, NULL, NULL },
    { "getNumBufferedDeleteTerms", NULL, "I", 0x1, NULL, NULL },
    { "anyDeletions", NULL, "Z", 0x1, NULL, NULL },
    { "close", NULL, "V", 0x1, NULL, NULL },
    { "preUpdate", NULL, "Z", 0x2, "Ljava.io.IOException;Lorg.apache.lucene.index.AbortingException;", NULL },
    { "postUpdateWithOrgApacheLuceneIndexDocumentsWriterPerThread:withBoolean:", "postUpdate", "Z", 0x2, "Ljava.io.IOException;Lorg.apache.lucene.index.AbortingException;", NULL },
    { "ensureInitializedWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:", "ensureInitialized", "V", 0x2, "Ljava.io.IOException;", NULL },
    { "updateDocumentsWithJavaLangIterable:withOrgApacheLuceneAnalysisAnalyzer:withOrgApacheLuceneIndexTerm:", "updateDocuments", "Z", 0x0, "Ljava.io.IOException;Lorg.apache.lucene.index.AbortingException;", "(Ljava/lang/Iterable<+Ljava/lang/Iterable<+Lorg/apache/lucene/index/IndexableField;>;>;Lorg/apache/lucene/analysis/Analyzer;Lorg/apache/lucene/index/Term;)Z" },
    { "updateDocumentWithJavaLangIterable:withOrgApacheLuceneAnalysisAnalyzer:withOrgApacheLuceneIndexTerm:", "updateDocument", "Z", 0x0, "Ljava.io.IOException;Lorg.apache.lucene.index.AbortingException;", "(Ljava/lang/Iterable<+Lorg/apache/lucene/index/IndexableField;>;Lorg/apache/lucene/analysis/Analyzer;Lorg/apache/lucene/index/Term;)Z" },
    { "doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread:", "doFlush", "Z", 0x2, "Ljava.io.IOException;Lorg.apache.lucene.index.AbortingException;", NULL },
    { "subtractFlushedNumDocsWithInt:", "subtractFlushedNumDocs", "V", 0x0, NULL, NULL },
    { "setFlushingDeleteQueueWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:", "setFlushingDeleteQueue", "Z", 0x22, NULL, NULL },
    { "flushAllThreads", NULL, "Z", 0x0, "Ljava.io.IOException;Lorg.apache.lucene.index.AbortingException;", NULL },
    { "finishFullFlushWithOrgApacheLuceneIndexIndexWriter:withBoolean:", "finishFullFlush", "V", 0x0, NULL, NULL },
    { "getIndexWriterConfig", NULL, "Lorg.apache.lucene.index.LiveIndexWriterConfig;", 0x1, NULL, NULL },
    { "putEventWithOrgApacheLuceneIndexIndexWriter_Event:", "putEvent", "V", 0x2, NULL, NULL },
    { "ramBytesUsed", NULL, "J", 0x1, NULL, NULL },
    { "getChildResources", NULL, "Ljava.util.Collection;", 0x1, NULL, "()Ljava/util/Collection<Lorg/apache/lucene/util/Accountable;>;" },
    { "eventQueue", NULL, "Ljava.util.Queue;", 0x1, NULL, "()Ljava/util/Queue<Lorg/apache/lucene/index/IndexWriter$Event;>;" },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "directoryOrig_", NULL, 0x12, "Lorg.apache.lucene.store.Directory;", NULL, NULL, .constantValue.asLong = 0 },
    { "directory_", NULL, 0x12, "Lorg.apache.lucene.store.Directory;", NULL, NULL, .constantValue.asLong = 0 },
    { "closed_", NULL, 0x42, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "infoStream_", NULL, 0x12, "Lorg.apache.lucene.util.InfoStream;", NULL, NULL, .constantValue.asLong = 0 },
    { "config_", NULL, 0x12, "Lorg.apache.lucene.index.LiveIndexWriterConfig;", NULL, NULL, .constantValue.asLong = 0 },
    { "numDocsInRAM_", NULL, 0x12, "Ljava.util.concurrent.atomic.AtomicInteger;", NULL, NULL, .constantValue.asLong = 0 },
    { "deleteQueue_", NULL, 0x40, "Lorg.apache.lucene.index.DocumentsWriterDeleteQueue;", NULL, NULL, .constantValue.asLong = 0 },
    { "ticketQueue_", NULL, 0x12, "Lorg.apache.lucene.index.DocumentsWriterFlushQueue;", NULL, NULL, .constantValue.asLong = 0 },
    { "pendingChangesInCurrentFullFlush_", NULL, 0x42, "Z", NULL, NULL, .constantValue.asLong = 0 },
    { "perThreadPool_", NULL, 0x10, "Lorg.apache.lucene.index.DocumentsWriterPerThreadPool;", NULL, NULL, .constantValue.asLong = 0 },
    { "flushPolicy_", NULL, 0x10, "Lorg.apache.lucene.index.FlushPolicy;", NULL, NULL, .constantValue.asLong = 0 },
    { "flushControl_", NULL, 0x10, "Lorg.apache.lucene.index.DocumentsWriterFlushControl;", NULL, NULL, .constantValue.asLong = 0 },
    { "writer_", NULL, 0x12, "Lorg.apache.lucene.index.IndexWriter;", NULL, NULL, .constantValue.asLong = 0 },
    { "events_", NULL, 0x12, "Ljava.util.Queue;", NULL, "Ljava/util/Queue<Lorg/apache/lucene/index/IndexWriter$Event;>;", .constantValue.asLong = 0 },
    { "currentFullFlushDelQueue_", NULL, 0x42, "Lorg.apache.lucene.index.DocumentsWriterDeleteQueue;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.index.DocumentsWriter$ApplyDeletesEvent;", "Lorg.apache.lucene.index.DocumentsWriter$MergePendingEvent;", "Lorg.apache.lucene.index.DocumentsWriter$ForcedPurgeEvent;", "Lorg.apache.lucene.index.DocumentsWriter$FlushFailedEvent;", "Lorg.apache.lucene.index.DocumentsWriter$DeleteNewFilesEvent;"};
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriter = { 2, "DocumentsWriter", "org.apache.lucene.index", NULL, 0x10, 33, methods, 15, fields, 0, NULL, 5, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneIndexDocumentsWriter;
}

@end

void OrgApacheLuceneIndexDocumentsWriter_initWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexLiveIndexWriterConfig_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneStoreDirectory_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexIndexWriter *writer, OrgApacheLuceneIndexLiveIndexWriterConfig *config, OrgApacheLuceneStoreDirectory *directoryOrig, OrgApacheLuceneStoreDirectory *directory) {
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->numDocsInRAM_, new_JavaUtilConcurrentAtomicAtomicInteger_initWithInt_(0));
  JreVolatileStrongAssignAndConsume(&self->deleteQueue_, new_OrgApacheLuceneIndexDocumentsWriterDeleteQueue_init());
  JreStrongAssignAndConsume(&self->ticketQueue_, new_OrgApacheLuceneIndexDocumentsWriterFlushQueue_init());
  JreVolatileStrongAssign(&self->currentFullFlushDelQueue_, nil);
  JreStrongAssign(&self->directoryOrig_, directoryOrig);
  JreStrongAssign(&self->directory_, directory);
  JreStrongAssign(&self->config_, config);
  JreStrongAssign(&self->infoStream_, [((OrgApacheLuceneIndexLiveIndexWriterConfig *) nil_chk(config)) getInfoStream]);
  JreStrongAssign(&self->perThreadPool_, [config getIndexerThreadPool]);
  JreStrongAssign(&self->flushPolicy_, [config getFlushPolicy]);
  self->writer_ = writer;
  JreStrongAssignAndConsume(&self->events_, new_JavaUtilConcurrentConcurrentLinkedQueue_init());
  JreStrongAssignAndConsume(&self->flushControl_, new_OrgApacheLuceneIndexDocumentsWriterFlushControl_initWithOrgApacheLuceneIndexDocumentsWriter_withOrgApacheLuceneIndexLiveIndexWriterConfig_withOrgApacheLuceneIndexBufferedUpdatesStream_(self, config, ((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer))->bufferedUpdatesStream_));
}

OrgApacheLuceneIndexDocumentsWriter *new_OrgApacheLuceneIndexDocumentsWriter_initWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexLiveIndexWriterConfig_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneStoreDirectory_(OrgApacheLuceneIndexIndexWriter *writer, OrgApacheLuceneIndexLiveIndexWriterConfig *config, OrgApacheLuceneStoreDirectory *directoryOrig, OrgApacheLuceneStoreDirectory *directory) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriter, initWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexLiveIndexWriterConfig_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneStoreDirectory_, writer, config, directoryOrig, directory)
}

OrgApacheLuceneIndexDocumentsWriter *create_OrgApacheLuceneIndexDocumentsWriter_initWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexLiveIndexWriterConfig_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneStoreDirectory_(OrgApacheLuceneIndexIndexWriter *writer, OrgApacheLuceneIndexLiveIndexWriterConfig *config, OrgApacheLuceneStoreDirectory *directoryOrig, OrgApacheLuceneStoreDirectory *directory) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriter, initWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexLiveIndexWriterConfig_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneStoreDirectory_, writer, config, directoryOrig, directory)
}

jboolean OrgApacheLuceneIndexDocumentsWriter_applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterDeleteQueue *deleteQueue) {
  if ([((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(self->flushControl_)) getAndResetApplyAllDeletes]) {
    if (deleteQueue != nil && ![self->flushControl_ isFullFlush]) {
      [((OrgApacheLuceneIndexDocumentsWriterFlushQueue *) nil_chk(self->ticketQueue_)) addDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:deleteQueue];
    }
    OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(self, JreLoadStatic(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent, INSTANCE));
    return true;
  }
  return false;
}

void OrgApacheLuceneIndexDocumentsWriter_ensureOpen(OrgApacheLuceneIndexDocumentsWriter *self) {
  if (JreLoadVolatileBoolean(&self->closed_)) {
    @throw create_OrgApacheLuceneStoreAlreadyClosedException_initWithNSString_(@"this IndexWriter is closed");
  }
}

jint OrgApacheLuceneIndexDocumentsWriter_abortThreadStateWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *perThread) {
  JreAssert(([((OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *) nil_chk(perThread)) isHeldByCurrentThread]), (@"org/apache/lucene/index/DocumentsWriter.java:272 condition failed: assert perThread.isHeldByCurrentThread();"));
  if ([perThread isInitialized]) {
    @try {
      jint abortedDocCount = [((OrgApacheLuceneIndexDocumentsWriterPerThread *) nil_chk(perThread->dwpt_)) getNumDocsInRAM];
      [self subtractFlushedNumDocsWithInt:abortedDocCount];
      [((OrgApacheLuceneIndexDocumentsWriterPerThread *) nil_chk(perThread->dwpt_)) abort];
      return abortedDocCount;
    }
    @finally {
      [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(self->flushControl_)) doOnAbortWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:perThread];
    }
  }
  else {
    [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(self->flushControl_)) doOnAbortWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState:perThread];
    return 0;
  }
}

jboolean OrgApacheLuceneIndexDocumentsWriter_preUpdate(OrgApacheLuceneIndexDocumentsWriter *self) {
  OrgApacheLuceneIndexDocumentsWriter_ensureOpen(self);
  jboolean hasEvents = false;
  if ([((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(self->flushControl_)) anyStalledThreads] || [self->flushControl_ numQueuedFlushes] > 0) {
    if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(self->infoStream_)) isEnabledWithNSString:@"DW"]) {
      [self->infoStream_ messageWithNSString:@"DW" withNSString:@"DocumentsWriter has queued dwpt; will hijack this thread to flush pending segment(s)"];
    }
    do {
      OrgApacheLuceneIndexDocumentsWriterPerThread *flushingDWPT;
      while ((flushingDWPT = [self->flushControl_ nextPendingFlush]) != nil) {
        hasEvents |= OrgApacheLuceneIndexDocumentsWriter_doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread_(self, flushingDWPT);
      }
      if ([self->infoStream_ isEnabledWithNSString:@"DW"] && [self->flushControl_ anyStalledThreads]) {
        [self->infoStream_ messageWithNSString:@"DW" withNSString:@"WARNING DocumentsWriter has stalled threads; waiting"];
      }
      [self->flushControl_ waitIfStalled];
    }
    while ([self->flushControl_ numQueuedFlushes] != 0);
    if ([self->infoStream_ isEnabledWithNSString:@"DW"]) {
      [self->infoStream_ messageWithNSString:@"DW" withNSString:@"continue indexing after helping out flushing DocumentsWriter is healthy"];
    }
  }
  return hasEvents;
}

jboolean OrgApacheLuceneIndexDocumentsWriter_postUpdateWithOrgApacheLuceneIndexDocumentsWriterPerThread_withBoolean_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterPerThread *flushingDWPT, jboolean hasEvents) {
  hasEvents |= OrgApacheLuceneIndexDocumentsWriter_applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, JreLoadVolatileId(&self->deleteQueue_));
  if (flushingDWPT != nil) {
    hasEvents |= OrgApacheLuceneIndexDocumentsWriter_doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread_(self, flushingDWPT);
  }
  else {
    OrgApacheLuceneIndexDocumentsWriterPerThread *nextPendingFlush = [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(self->flushControl_)) nextPendingFlush];
    if (nextPendingFlush != nil) {
      hasEvents |= OrgApacheLuceneIndexDocumentsWriter_doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread_(self, nextPendingFlush);
    }
  }
  return hasEvents;
}

void OrgApacheLuceneIndexDocumentsWriter_ensureInitializedWithOrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *state) {
  if (((OrgApacheLuceneIndexDocumentsWriterPerThreadPool_ThreadState *) nil_chk(state))->dwpt_ == nil) {
    OrgApacheLuceneIndexFieldInfos_Builder *infos = create_OrgApacheLuceneIndexFieldInfos_Builder_initWithOrgApacheLuceneIndexFieldInfos_FieldNumbers_(((OrgApacheLuceneIndexIndexWriter *) nil_chk(self->writer_))->globalFieldNumberMap_);
    JreStrongAssignAndConsume(&state->dwpt_, new_OrgApacheLuceneIndexDocumentsWriterPerThread_initWithOrgApacheLuceneIndexIndexWriter_withNSString_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexLiveIndexWriterConfig_withOrgApacheLuceneUtilInfoStream_withOrgApacheLuceneIndexDocumentsWriterDeleteQueue_withOrgApacheLuceneIndexFieldInfos_Builder_withJavaUtilConcurrentAtomicAtomicLong_withBoolean_(self->writer_, [self->writer_ newSegmentName], self->directoryOrig_, self->directory_, self->config_, self->infoStream_, JreLoadVolatileId(&self->deleteQueue_), infos, self->writer_->pendingNumDocs_, self->writer_->enableTestPoints_));
  }
}

jboolean OrgApacheLuceneIndexDocumentsWriter_doFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterPerThread *flushingDWPT) {
  jboolean hasEvents = false;
  while (flushingDWPT != nil) {
    hasEvents = true;
    jboolean success = false;
    OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *ticket = nil;
    @try {
      JreAssert((JreLoadVolatileId(&self->currentFullFlushDelQueue_) == nil || flushingDWPT->deleteQueue_ == JreLoadVolatileId(&self->currentFullFlushDelQueue_)), (JreStrcat("$@$@CZ", @"expected: ", JreLoadVolatileId(&self->currentFullFlushDelQueue_), @"but was: ", flushingDWPT->deleteQueue_, ' ', [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(self->flushControl_)) isFullFlush])));
      @try {
        ticket = [((OrgApacheLuceneIndexDocumentsWriterFlushQueue *) nil_chk(self->ticketQueue_)) addFlushTicketWithOrgApacheLuceneIndexDocumentsWriterPerThread:flushingDWPT];
        jint flushingDocsInRam = [flushingDWPT getNumDocsInRAM];
        jboolean dwptSuccess = false;
        @try {
          OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *newSegment = [flushingDWPT flush];
          [self->ticketQueue_ addSegmentWithOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket:ticket withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:newSegment];
          dwptSuccess = true;
        }
        @finally {
          [self subtractFlushedNumDocsWithInt:flushingDocsInRam];
          if (![((id<JavaUtilSet>) nil_chk([flushingDWPT pendingFilesToDelete])) isEmpty]) {
            OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(self, create_OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent_initWithJavaUtilCollection_([flushingDWPT pendingFilesToDelete]));
            hasEvents = true;
          }
          if (!dwptSuccess) {
            OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(self, create_OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent_initWithOrgApacheLuceneIndexSegmentInfo_([flushingDWPT getSegmentInfo]));
            hasEvents = true;
          }
        }
        success = true;
      }
      @finally {
        if (!success && ticket != nil) {
          [self->ticketQueue_ markTicketFailedWithOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket:ticket];
        }
      }
      if ([self->ticketQueue_ getTicketCount] >= [((OrgApacheLuceneIndexDocumentsWriterPerThreadPool *) nil_chk(self->perThreadPool_)) getActiveThreadStateCount]) {
        OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(self, JreLoadStatic(OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent, INSTANCE));
        break;
      }
    }
    @finally {
      [self->flushControl_ doAfterFlushWithOrgApacheLuceneIndexDocumentsWriterPerThread:flushingDWPT];
    }
    flushingDWPT = [self->flushControl_ nextPendingFlush];
  }
  if (hasEvents) {
    OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(self, JreLoadStatic(OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent, INSTANCE));
  }
  jdouble ramBufferSizeMB = [((OrgApacheLuceneIndexLiveIndexWriterConfig *) nil_chk(self->config_)) getRAMBufferSizeMB];
  if (ramBufferSizeMB != OrgApacheLuceneIndexIndexWriterConfig_DISABLE_AUTO_FLUSH && [((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(self->flushControl_)) getDeleteBytesUsed] > (1024 * 1024 * ramBufferSizeMB / 2)) {
    hasEvents = true;
    if (!OrgApacheLuceneIndexDocumentsWriter_applyAllDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(self, JreLoadVolatileId(&self->deleteQueue_))) {
      if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(self->infoStream_)) isEnabledWithNSString:@"DW"]) {
        [self->infoStream_ messageWithNSString:@"DW" withNSString:NSString_formatWithJavaUtilLocale_withNSString_withNSObjectArray_(JreLoadStatic(JavaUtilLocale, ROOT), @"force apply deletes bytesUsed=%.1f MB vs ramBuffer=%.1f MB", [IOSObjectArray arrayWithObjects:(id[]){ JavaLangDouble_valueOfWithDouble_([((OrgApacheLuceneIndexDocumentsWriterFlushControl *) nil_chk(self->flushControl_)) getDeleteBytesUsed] / (1024. * 1024.)), JavaLangDouble_valueOfWithDouble_(ramBufferSizeMB) } count:2 type:NSObject_class_()])];
      }
      OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(self, JreLoadStatic(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent, INSTANCE));
    }
  }
  return hasEvents;
}

jboolean OrgApacheLuceneIndexDocumentsWriter_setFlushingDeleteQueueWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_(OrgApacheLuceneIndexDocumentsWriter *self, OrgApacheLuceneIndexDocumentsWriterDeleteQueue *session) {
  @synchronized(self) {
    JreVolatileStrongAssign(&self->currentFullFlushDelQueue_, session);
    return true;
  }
}

void OrgApacheLuceneIndexDocumentsWriter_putEventWithOrgApacheLuceneIndexIndexWriter_Event_(OrgApacheLuceneIndexDocumentsWriter *self, id<OrgApacheLuceneIndexIndexWriter_Event> event) {
  [((id<JavaUtilQueue>) nil_chk(self->events_)) addWithId:event];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriter)

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent)

id<OrgApacheLuceneIndexIndexWriter_Event> OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_INSTANCE;

@implementation OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent

+ (id<OrgApacheLuceneIndexIndexWriter_Event>)INSTANCE {
  return OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_INSTANCE;
}

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)processWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer
                                       withBoolean:(jboolean)triggerMerge
                                       withBoolean:(jboolean)forcePurge {
  [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) applyDeletesAndPurgeWithBoolean:true];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent class]) {
    JreStrongAssignAndConsume(&OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_INSTANCE, new_OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_init());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "ApplyDeletesEvent", NULL, 0x2, NULL, NULL },
    { "processWithOrgApacheLuceneIndexIndexWriter:withBoolean:withBoolean:", "process", "V", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "INSTANCE", "INSTANCE", 0x18, "Lorg.apache.lucene.index.IndexWriter$Event;", &OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_INSTANCE, NULL, .constantValue.asLong = 0 },
    { "instCount_", NULL, 0x2, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent = { 2, "ApplyDeletesEvent", "org.apache.lucene.index", "DocumentsWriter", 0x18, 2, methods, 2, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent;
}

@end

void OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_init(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent *self) {
  NSObject_init(self);
  self->instCount_ = 0;
  JreAssert((self->instCount_ == 0), (@"org/apache/lucene/index/DocumentsWriter.java:679 condition failed: assert instCount == 0;"));
  self->instCount_++;
}

OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent *new_OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent, init)
}

OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent *create_OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent, init)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriter_ApplyDeletesEvent)

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent)

id<OrgApacheLuceneIndexIndexWriter_Event> OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_INSTANCE;

@implementation OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent

+ (id<OrgApacheLuceneIndexIndexWriter_Event>)INSTANCE {
  return OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_INSTANCE;
}

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)processWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer
                                       withBoolean:(jboolean)triggerMerge
                                       withBoolean:(jboolean)forcePurge {
  [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) doAfterSegmentFlushedWithBoolean:triggerMerge withBoolean:forcePurge];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent class]) {
    JreStrongAssignAndConsume(&OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_INSTANCE, new_OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_init());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "MergePendingEvent", NULL, 0x2, NULL, NULL },
    { "processWithOrgApacheLuceneIndexIndexWriter:withBoolean:withBoolean:", "process", "V", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "INSTANCE", "INSTANCE", 0x18, "Lorg.apache.lucene.index.IndexWriter$Event;", &OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_INSTANCE, NULL, .constantValue.asLong = 0 },
    { "instCount_", NULL, 0x2, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent = { 2, "MergePendingEvent", "org.apache.lucene.index", "DocumentsWriter", 0x18, 2, methods, 2, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent;
}

@end

void OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_init(OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent *self) {
  NSObject_init(self);
  self->instCount_ = 0;
  JreAssert((self->instCount_ == 0), (@"org/apache/lucene/index/DocumentsWriter.java:693 condition failed: assert instCount == 0;"));
  self->instCount_++;
}

OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent *new_OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent, init)
}

OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent *create_OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent, init)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriter_MergePendingEvent)

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent)

id<OrgApacheLuceneIndexIndexWriter_Event> OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_INSTANCE;

@implementation OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent

+ (id<OrgApacheLuceneIndexIndexWriter_Event>)INSTANCE {
  return OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_INSTANCE;
}

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)processWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer
                                       withBoolean:(jboolean)triggerMerge
                                       withBoolean:(jboolean)forcePurge {
  [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) purgeWithBoolean:true];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent class]) {
    JreStrongAssignAndConsume(&OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_INSTANCE, new_OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_init());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "ForcedPurgeEvent", NULL, 0x2, NULL, NULL },
    { "processWithOrgApacheLuceneIndexIndexWriter:withBoolean:withBoolean:", "process", "V", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "INSTANCE", "INSTANCE", 0x18, "Lorg.apache.lucene.index.IndexWriter$Event;", &OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_INSTANCE, NULL, .constantValue.asLong = 0 },
    { "instCount_", NULL, 0x2, "I", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent = { 2, "ForcedPurgeEvent", "org.apache.lucene.index", "DocumentsWriter", 0x18, 2, methods, 2, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent;
}

@end

void OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_init(OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent *self) {
  NSObject_init(self);
  self->instCount_ = 0;
  JreAssert((self->instCount_ == 0), (@"org/apache/lucene/index/DocumentsWriter.java:707 condition failed: assert instCount == 0;"));
  self->instCount_++;
}

OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent *new_OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent, init)
}

OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent *create_OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent, init)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriter_ForcedPurgeEvent)

@implementation OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent

- (instancetype)initWithOrgApacheLuceneIndexSegmentInfo:(OrgApacheLuceneIndexSegmentInfo *)info {
  OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent_initWithOrgApacheLuceneIndexSegmentInfo_(self, info);
  return self;
}

- (void)processWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer
                                       withBoolean:(jboolean)triggerMerge
                                       withBoolean:(jboolean)forcePurge {
  [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) flushFailedWithOrgApacheLuceneIndexSegmentInfo:info_];
}

- (void)dealloc {
  RELEASE_(info_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneIndexSegmentInfo:", "FlushFailedEvent", NULL, 0x1, NULL, NULL },
    { "processWithOrgApacheLuceneIndexIndexWriter:withBoolean:withBoolean:", "process", "V", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "info_", NULL, 0x12, "Lorg.apache.lucene.index.SegmentInfo;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent = { 2, "FlushFailedEvent", "org.apache.lucene.index", "DocumentsWriter", 0x8, 2, methods, 1, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent;
}

@end

void OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent_initWithOrgApacheLuceneIndexSegmentInfo_(OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent *self, OrgApacheLuceneIndexSegmentInfo *info) {
  NSObject_init(self);
  JreStrongAssign(&self->info_, info);
}

OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent *new_OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent_initWithOrgApacheLuceneIndexSegmentInfo_(OrgApacheLuceneIndexSegmentInfo *info) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent, initWithOrgApacheLuceneIndexSegmentInfo_, info)
}

OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent *create_OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent_initWithOrgApacheLuceneIndexSegmentInfo_(OrgApacheLuceneIndexSegmentInfo *info) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent, initWithOrgApacheLuceneIndexSegmentInfo_, info)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriter_FlushFailedEvent)

@implementation OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent

- (instancetype)initWithJavaUtilCollection:(id<JavaUtilCollection>)files {
  OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent_initWithJavaUtilCollection_(self, files);
  return self;
}

- (void)processWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer
                                       withBoolean:(jboolean)triggerMerge
                                       withBoolean:(jboolean)forcePurge {
  [((OrgApacheLuceneIndexIndexWriter *) nil_chk(writer)) deleteNewFilesWithJavaUtilCollection:files_];
}

- (void)dealloc {
  RELEASE_(files_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithJavaUtilCollection:", "DeleteNewFilesEvent", NULL, 0x1, NULL, "(Ljava/util/Collection<Ljava/lang/String;>;)V" },
    { "processWithOrgApacheLuceneIndexIndexWriter:withBoolean:withBoolean:", "process", "V", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "files_", NULL, 0x12, "Ljava.util.Collection;", NULL, "Ljava/util/Collection<Ljava/lang/String;>;", .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent = { 2, "DeleteNewFilesEvent", "org.apache.lucene.index", "DocumentsWriter", 0x8, 2, methods, 1, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent;
}

@end

void OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent_initWithJavaUtilCollection_(OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent *self, id<JavaUtilCollection> files) {
  NSObject_init(self);
  JreStrongAssign(&self->files_, files);
}

OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent *new_OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent_initWithJavaUtilCollection_(id<JavaUtilCollection> files) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent, initWithJavaUtilCollection_, files)
}

OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent *create_OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent_initWithJavaUtilCollection_(id<JavaUtilCollection> files) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent, initWithJavaUtilCollection_, files)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriter_DeleteNewFilesEvent)
