//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/index/SlowCompositeReaderWrapper.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/util/HashMap.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "org/apache/lucene/index/BinaryDocValues.h"
#include "org/apache/lucene/index/CompositeReader.h"
#include "org/apache/lucene/index/DocValues.h"
#include "org/apache/lucene/index/DocValuesType.h"
#include "org/apache/lucene/index/FieldInfo.h"
#include "org/apache/lucene/index/FieldInfos.h"
#include "org/apache/lucene/index/Fields.h"
#include "org/apache/lucene/index/IndexReader.h"
#include "org/apache/lucene/index/LeafReader.h"
#include "org/apache/lucene/index/LeafReaderContext.h"
#include "org/apache/lucene/index/MultiDocValues.h"
#include "org/apache/lucene/index/MultiFields.h"
#include "org/apache/lucene/index/NumericDocValues.h"
#include "org/apache/lucene/index/RandomAccessOrds.h"
#include "org/apache/lucene/index/SlowCompositeReaderWrapper.h"
#include "org/apache/lucene/index/SortedDocValues.h"
#include "org/apache/lucene/index/SortedNumericDocValues.h"
#include "org/apache/lucene/index/SortedSetDocValues.h"
#include "org/apache/lucene/index/StoredFieldVisitor.h"
#include "org/apache/lucene/util/Bits.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/index/SlowCompositeReaderWrapper must not be compiled with ARC (-fobjc-arc)"
#endif

@interface OrgApacheLuceneIndexSlowCompositeReaderWrapper () {
 @public
  OrgApacheLuceneIndexCompositeReader *in_;
  OrgApacheLuceneIndexFields *fields_;
  jboolean merging_;
  id<JavaUtilMap> cachedOrdMaps_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexSlowCompositeReaderWrapper, in_, OrgApacheLuceneIndexCompositeReader *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexSlowCompositeReaderWrapper, fields_, OrgApacheLuceneIndexFields *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexSlowCompositeReaderWrapper, cachedOrdMaps_, id<JavaUtilMap>)

@implementation OrgApacheLuceneIndexSlowCompositeReaderWrapper

+ (OrgApacheLuceneIndexLeafReader *)wrapWithOrgApacheLuceneIndexIndexReader:(OrgApacheLuceneIndexIndexReader *)reader {
  return OrgApacheLuceneIndexSlowCompositeReaderWrapper_wrapWithOrgApacheLuceneIndexIndexReader_(reader);
}

- (instancetype)initWithOrgApacheLuceneIndexCompositeReader:(OrgApacheLuceneIndexCompositeReader *)reader
                                                withBoolean:(jboolean)merging {
  OrgApacheLuceneIndexSlowCompositeReaderWrapper_initWithOrgApacheLuceneIndexCompositeReader_withBoolean_(self, reader, merging);
  return self;
}

- (NSString *)description {
  return JreStrcat("$@C", @"SlowCompositeReaderWrapper(", in_, ')');
}

- (void)addCoreClosedListenerWithOrgApacheLuceneIndexLeafReader_CoreClosedListener:(id<OrgApacheLuceneIndexLeafReader_CoreClosedListener>)listener {
  OrgApacheLuceneIndexLeafReader_addCoreClosedListenerAsReaderClosedListenerWithOrgApacheLuceneIndexIndexReader_withOrgApacheLuceneIndexLeafReader_CoreClosedListener_(in_, listener);
}

- (void)removeCoreClosedListenerWithOrgApacheLuceneIndexLeafReader_CoreClosedListener:(id<OrgApacheLuceneIndexLeafReader_CoreClosedListener>)listener {
  OrgApacheLuceneIndexLeafReader_removeCoreClosedListenerAsReaderClosedListenerWithOrgApacheLuceneIndexIndexReader_withOrgApacheLuceneIndexLeafReader_CoreClosedListener_(in_, listener);
}

- (OrgApacheLuceneIndexFields *)fields {
  [self ensureOpen];
  return fields_;
}

- (OrgApacheLuceneIndexNumericDocValues *)getNumericDocValuesWithNSString:(NSString *)field {
  [self ensureOpen];
  return OrgApacheLuceneIndexMultiDocValues_getNumericValuesWithOrgApacheLuceneIndexIndexReader_withNSString_(in_, field);
}

- (id<OrgApacheLuceneUtilBits>)getDocsWithFieldWithNSString:(NSString *)field {
  [self ensureOpen];
  return OrgApacheLuceneIndexMultiDocValues_getDocsWithFieldWithOrgApacheLuceneIndexIndexReader_withNSString_(in_, field);
}

- (OrgApacheLuceneIndexBinaryDocValues *)getBinaryDocValuesWithNSString:(NSString *)field {
  [self ensureOpen];
  return OrgApacheLuceneIndexMultiDocValues_getBinaryValuesWithOrgApacheLuceneIndexIndexReader_withNSString_(in_, field);
}

- (OrgApacheLuceneIndexSortedNumericDocValues *)getSortedNumericDocValuesWithNSString:(NSString *)field {
  [self ensureOpen];
  return OrgApacheLuceneIndexMultiDocValues_getSortedNumericValuesWithOrgApacheLuceneIndexIndexReader_withNSString_(in_, field);
}

- (OrgApacheLuceneIndexSortedDocValues *)getSortedDocValuesWithNSString:(NSString *)field {
  [self ensureOpen];
  OrgApacheLuceneIndexMultiDocValues_OrdinalMap *map = nil;
  @synchronized(cachedOrdMaps_) {
    map = JreRetainedLocalValue([((id<JavaUtilMap>) nil_chk(cachedOrdMaps_)) getWithId:field]);
    if (map == nil) {
      OrgApacheLuceneIndexSortedDocValues *dv = OrgApacheLuceneIndexMultiDocValues_getSortedValuesWithOrgApacheLuceneIndexIndexReader_withNSString_(in_, field);
      if ([dv isKindOfClass:[OrgApacheLuceneIndexMultiDocValues_MultiSortedDocValues class]]) {
        map = JreRetainedLocalValue(((OrgApacheLuceneIndexMultiDocValues_MultiSortedDocValues *) nil_chk(((OrgApacheLuceneIndexMultiDocValues_MultiSortedDocValues *) dv)))->mapping_);
        if (JreObjectEqualsEquals(((OrgApacheLuceneIndexMultiDocValues_OrdinalMap *) nil_chk(map))->owner_, [self getCoreCacheKey]) && merging_ == false) {
          [cachedOrdMaps_ putWithId:field withId:map];
        }
      }
      return JreRetainedLocalValue(dv);
    }
  }
  if ([((OrgApacheLuceneIndexFieldInfo *) nil_chk([((OrgApacheLuceneIndexFieldInfos *) nil_chk([self getFieldInfos])) fieldInfoWithNSString:field])) getDocValuesType] != JreLoadEnum(OrgApacheLuceneIndexDocValuesType, SORTED)) {
    return nil;
  }
  jint size = [((id<JavaUtilList>) nil_chk([((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) leaves])) size];
  IOSObjectArray *values = [IOSObjectArray arrayWithLength:size type:OrgApacheLuceneIndexSortedDocValues_class_()];
  IOSIntArray *starts = [IOSIntArray arrayWithLength:size + 1];
  for (jint i = 0; i < size; i++) {
    OrgApacheLuceneIndexLeafReaderContext *context = JreRetainedLocalValue([((id<JavaUtilList>) nil_chk([in_ leaves])) getWithInt:i]);
    OrgApacheLuceneIndexSortedDocValues *v = JreRetainedLocalValue([((OrgApacheLuceneIndexLeafReader *) nil_chk([((OrgApacheLuceneIndexLeafReaderContext *) nil_chk(context)) reader])) getSortedDocValuesWithNSString:field]);
    if (v == nil) {
      v = OrgApacheLuceneIndexDocValues_emptySorted();
    }
    IOSObjectArray_Set(values, i, v);
    *IOSIntArray_GetRef(starts, i) = context->docBase_;
  }
  *IOSIntArray_GetRef(starts, size) = [self maxDoc];
  return create_OrgApacheLuceneIndexMultiDocValues_MultiSortedDocValues_initWithOrgApacheLuceneIndexSortedDocValuesArray_withIntArray_withOrgApacheLuceneIndexMultiDocValues_OrdinalMap_(values, starts, map);
}

- (OrgApacheLuceneIndexSortedSetDocValues *)getSortedSetDocValuesWithNSString:(NSString *)field {
  [self ensureOpen];
  OrgApacheLuceneIndexMultiDocValues_OrdinalMap *map = nil;
  @synchronized(cachedOrdMaps_) {
    map = JreRetainedLocalValue([((id<JavaUtilMap>) nil_chk(cachedOrdMaps_)) getWithId:field]);
    if (map == nil) {
      OrgApacheLuceneIndexSortedSetDocValues *dv = OrgApacheLuceneIndexMultiDocValues_getSortedSetValuesWithOrgApacheLuceneIndexIndexReader_withNSString_(in_, field);
      if ([dv isKindOfClass:[OrgApacheLuceneIndexMultiDocValues_MultiSortedSetDocValues class]]) {
        map = JreRetainedLocalValue(((OrgApacheLuceneIndexMultiDocValues_MultiSortedSetDocValues *) nil_chk(((OrgApacheLuceneIndexMultiDocValues_MultiSortedSetDocValues *) dv)))->mapping_);
        if (JreObjectEqualsEquals(((OrgApacheLuceneIndexMultiDocValues_OrdinalMap *) nil_chk(map))->owner_, [self getCoreCacheKey]) && merging_ == false) {
          [cachedOrdMaps_ putWithId:field withId:map];
        }
      }
      return JreRetainedLocalValue(dv);
    }
  }
  if ([((OrgApacheLuceneIndexFieldInfo *) nil_chk([((OrgApacheLuceneIndexFieldInfos *) nil_chk([self getFieldInfos])) fieldInfoWithNSString:field])) getDocValuesType] != JreLoadEnum(OrgApacheLuceneIndexDocValuesType, SORTED_SET)) {
    return nil;
  }
  JreAssert(map != nil, @"org/apache/lucene/index/SlowCompositeReaderWrapper.java:177 condition failed: assert map != null;");
  jint size = [((id<JavaUtilList>) nil_chk([((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) leaves])) size];
  IOSObjectArray *values = [IOSObjectArray arrayWithLength:size type:OrgApacheLuceneIndexSortedSetDocValues_class_()];
  IOSIntArray *starts = [IOSIntArray arrayWithLength:size + 1];
  for (jint i = 0; i < size; i++) {
    OrgApacheLuceneIndexLeafReaderContext *context = JreRetainedLocalValue([((id<JavaUtilList>) nil_chk([in_ leaves])) getWithInt:i]);
    OrgApacheLuceneIndexSortedSetDocValues *v = JreRetainedLocalValue([((OrgApacheLuceneIndexLeafReader *) nil_chk([((OrgApacheLuceneIndexLeafReaderContext *) nil_chk(context)) reader])) getSortedSetDocValuesWithNSString:field]);
    if (v == nil) {
      v = OrgApacheLuceneIndexDocValues_emptySortedSet();
    }
    IOSObjectArray_Set(values, i, v);
    *IOSIntArray_GetRef(starts, i) = context->docBase_;
  }
  *IOSIntArray_GetRef(starts, size) = [self maxDoc];
  return create_OrgApacheLuceneIndexMultiDocValues_MultiSortedSetDocValues_initWithOrgApacheLuceneIndexSortedSetDocValuesArray_withIntArray_withOrgApacheLuceneIndexMultiDocValues_OrdinalMap_(values, starts, map);
}

- (OrgApacheLuceneIndexNumericDocValues *)getNormValuesWithNSString:(NSString *)field {
  [self ensureOpen];
  return OrgApacheLuceneIndexMultiDocValues_getNormValuesWithOrgApacheLuceneIndexIndexReader_withNSString_(in_, field);
}

- (OrgApacheLuceneIndexFields *)getTermVectorsWithInt:(jint)docID {
  [self ensureOpen];
  return [((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) getTermVectorsWithInt:docID];
}

- (jint)numDocs {
  return [((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) numDocs];
}

- (jint)maxDoc {
  return [((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) maxDoc];
}

- (void)documentWithInt:(jint)docID
withOrgApacheLuceneIndexStoredFieldVisitor:(OrgApacheLuceneIndexStoredFieldVisitor *)visitor {
  [self ensureOpen];
  [((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) documentWithInt:docID withOrgApacheLuceneIndexStoredFieldVisitor:visitor];
}

- (id<OrgApacheLuceneUtilBits>)getLiveDocs {
  [self ensureOpen];
  return OrgApacheLuceneIndexMultiFields_getLiveDocsWithOrgApacheLuceneIndexIndexReader_(in_);
}

- (OrgApacheLuceneIndexFieldInfos *)getFieldInfos {
  [self ensureOpen];
  return OrgApacheLuceneIndexMultiFields_getMergedFieldInfosWithOrgApacheLuceneIndexIndexReader_(in_);
}

- (id)getCoreCacheKey {
  return [((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) getCoreCacheKey];
}

- (id)getCombinedCoreAndDeletesKey {
  return [((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) getCombinedCoreAndDeletesKey];
}

- (void)doClose {
  [((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) close];
}

- (void)checkIntegrity {
  [self ensureOpen];
  for (OrgApacheLuceneIndexLeafReaderContext * __strong ctx in nil_chk([((OrgApacheLuceneIndexCompositeReader *) nil_chk(in_)) leaves])) {
    [((OrgApacheLuceneIndexLeafReader *) nil_chk([((OrgApacheLuceneIndexLeafReaderContext *) nil_chk(ctx)) reader])) checkIntegrity];
  }
}

- (void)dealloc {
  RELEASE_(in_);
  RELEASE_(fields_);
  RELEASE_(cachedOrdMaps_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, "LOrgApacheLuceneIndexLeafReader;", 0x9, 0, 1, 2, -1, -1, -1 },
    { NULL, NULL, 0x0, -1, 3, 2, -1, -1, -1 },
    { NULL, "LNSString;", 0x1, 4, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 5, 6, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 7, 6, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexFields;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexNumericDocValues;", 0x1, 8, 9, 2, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilBits;", 0x1, 10, 9, 2, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexBinaryDocValues;", 0x1, 11, 9, 2, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexSortedNumericDocValues;", 0x1, 12, 9, 2, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexSortedDocValues;", 0x1, 13, 9, 2, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexSortedSetDocValues;", 0x1, 14, 9, 2, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexNumericDocValues;", 0x1, 15, 9, 2, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexFields;", 0x1, 16, 17, 2, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 18, 19, 2, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneUtilBits;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexFieldInfos;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LNSObject;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LNSObject;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x4, -1, -1, 2, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, 2, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(wrapWithOrgApacheLuceneIndexIndexReader:);
  methods[1].selector = @selector(initWithOrgApacheLuceneIndexCompositeReader:withBoolean:);
  methods[2].selector = @selector(description);
  methods[3].selector = @selector(addCoreClosedListenerWithOrgApacheLuceneIndexLeafReader_CoreClosedListener:);
  methods[4].selector = @selector(removeCoreClosedListenerWithOrgApacheLuceneIndexLeafReader_CoreClosedListener:);
  methods[5].selector = @selector(fields);
  methods[6].selector = @selector(getNumericDocValuesWithNSString:);
  methods[7].selector = @selector(getDocsWithFieldWithNSString:);
  methods[8].selector = @selector(getBinaryDocValuesWithNSString:);
  methods[9].selector = @selector(getSortedNumericDocValuesWithNSString:);
  methods[10].selector = @selector(getSortedDocValuesWithNSString:);
  methods[11].selector = @selector(getSortedSetDocValuesWithNSString:);
  methods[12].selector = @selector(getNormValuesWithNSString:);
  methods[13].selector = @selector(getTermVectorsWithInt:);
  methods[14].selector = @selector(numDocs);
  methods[15].selector = @selector(maxDoc);
  methods[16].selector = @selector(documentWithInt:withOrgApacheLuceneIndexStoredFieldVisitor:);
  methods[17].selector = @selector(getLiveDocs);
  methods[18].selector = @selector(getFieldInfos);
  methods[19].selector = @selector(getCoreCacheKey);
  methods[20].selector = @selector(getCombinedCoreAndDeletesKey);
  methods[21].selector = @selector(doClose);
  methods[22].selector = @selector(checkIntegrity);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "in_", "LOrgApacheLuceneIndexCompositeReader;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "fields_", "LOrgApacheLuceneIndexFields;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "merging_", "Z", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "cachedOrdMaps_", "LJavaUtilMap;", .constantValue.asLong = 0, 0x12, -1, -1, 20, -1 },
  };
  static const void *ptrTable[] = { "wrap", "LOrgApacheLuceneIndexIndexReader;", "LJavaIoIOException;", "LOrgApacheLuceneIndexCompositeReader;Z", "toString", "addCoreClosedListener", "LOrgApacheLuceneIndexLeafReader_CoreClosedListener;", "removeCoreClosedListener", "getNumericDocValues", "LNSString;", "getDocsWithField", "getBinaryDocValues", "getSortedNumericDocValues", "getSortedDocValues", "getSortedSetDocValues", "getNormValues", "getTermVectors", "I", "document", "ILOrgApacheLuceneIndexStoredFieldVisitor;", "Ljava/util/Map<Ljava/lang/String;Lorg/apache/lucene/index/MultiDocValues$OrdinalMap;>;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexSlowCompositeReaderWrapper = { "SlowCompositeReaderWrapper", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x11, 23, 4, -1, -1, -1, -1, -1 };
  return &_OrgApacheLuceneIndexSlowCompositeReaderWrapper;
}

@end

OrgApacheLuceneIndexLeafReader *OrgApacheLuceneIndexSlowCompositeReaderWrapper_wrapWithOrgApacheLuceneIndexIndexReader_(OrgApacheLuceneIndexIndexReader *reader) {
  OrgApacheLuceneIndexSlowCompositeReaderWrapper_initialize();
  if ([reader isKindOfClass:[OrgApacheLuceneIndexCompositeReader class]]) {
    return create_OrgApacheLuceneIndexSlowCompositeReaderWrapper_initWithOrgApacheLuceneIndexCompositeReader_withBoolean_((OrgApacheLuceneIndexCompositeReader *) reader, false);
  }
  else {
    JreAssert([reader isKindOfClass:[OrgApacheLuceneIndexLeafReader class]], @"org/apache/lucene/index/SlowCompositeReaderWrapper.java:59 condition failed: assert reader instanceof LeafReader;");
    return (OrgApacheLuceneIndexLeafReader *) cast_chk(reader, [OrgApacheLuceneIndexLeafReader class]);
  }
}

void OrgApacheLuceneIndexSlowCompositeReaderWrapper_initWithOrgApacheLuceneIndexCompositeReader_withBoolean_(OrgApacheLuceneIndexSlowCompositeReaderWrapper *self, OrgApacheLuceneIndexCompositeReader *reader, jboolean merging) {
  OrgApacheLuceneIndexLeafReader_init(self);
  JreStrongAssignAndConsume(&self->cachedOrdMaps_, new_JavaUtilHashMap_init());
  JreStrongAssign(&self->in_, reader);
  JreStrongAssign(&self->fields_, OrgApacheLuceneIndexMultiFields_getFieldsWithOrgApacheLuceneIndexIndexReader_(self->in_));
  [((OrgApacheLuceneIndexCompositeReader *) nil_chk(self->in_)) registerParentReaderWithOrgApacheLuceneIndexIndexReader:self];
  self->merging_ = merging;
}

OrgApacheLuceneIndexSlowCompositeReaderWrapper *new_OrgApacheLuceneIndexSlowCompositeReaderWrapper_initWithOrgApacheLuceneIndexCompositeReader_withBoolean_(OrgApacheLuceneIndexCompositeReader *reader, jboolean merging) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexSlowCompositeReaderWrapper, initWithOrgApacheLuceneIndexCompositeReader_withBoolean_, reader, merging)
}

OrgApacheLuceneIndexSlowCompositeReaderWrapper *create_OrgApacheLuceneIndexSlowCompositeReaderWrapper_initWithOrgApacheLuceneIndexCompositeReader_withBoolean_(OrgApacheLuceneIndexCompositeReader *reader, jboolean merging) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexSlowCompositeReaderWrapper, initWithOrgApacheLuceneIndexCompositeReader_withBoolean_, reader, merging)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexSlowCompositeReaderWrapper)
