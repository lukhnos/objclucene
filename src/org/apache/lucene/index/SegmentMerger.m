//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/index/SegmentMerger.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/System.h"
#include "java/util/List.h"
#include "org/apache/lucene/codecs/Codec.h"
#include "org/apache/lucene/codecs/DocValuesConsumer.h"
#include "org/apache/lucene/codecs/DocValuesFormat.h"
#include "org/apache/lucene/codecs/FieldInfosFormat.h"
#include "org/apache/lucene/codecs/FieldsConsumer.h"
#include "org/apache/lucene/codecs/NormsConsumer.h"
#include "org/apache/lucene/codecs/NormsFormat.h"
#include "org/apache/lucene/codecs/PostingsFormat.h"
#include "org/apache/lucene/codecs/StoredFieldsFormat.h"
#include "org/apache/lucene/codecs/StoredFieldsWriter.h"
#include "org/apache/lucene/codecs/TermVectorsFormat.h"
#include "org/apache/lucene/codecs/TermVectorsWriter.h"
#include "org/apache/lucene/index/FieldInfo.h"
#include "org/apache/lucene/index/FieldInfos.h"
#include "org/apache/lucene/index/MergeState.h"
#include "org/apache/lucene/index/SegmentInfo.h"
#include "org/apache/lucene/index/SegmentMerger.h"
#include "org/apache/lucene/index/SegmentWriteState.h"
#include "org/apache/lucene/store/Directory.h"
#include "org/apache/lucene/store/IOContext.h"
#include "org/apache/lucene/util/InfoStream.h"

@interface OrgApacheLuceneIndexSegmentMerger () {
 @public
  OrgApacheLuceneStoreDirectory *directory_;
  OrgApacheLuceneCodecsCodec *codec_;
  OrgApacheLuceneStoreIOContext *context_;
  OrgApacheLuceneIndexFieldInfos_Builder *fieldInfosBuilder_;
}

- (void)mergeDocValuesWithOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)segmentWriteState;

- (void)mergeNormsWithOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)segmentWriteState;

/*!
 @brief Merge stored fields from each of the segments into the new one.
 @return The number of documents in all of the readers
 @throws CorruptIndexException if the index is corrupt
 @throws IOException if there is a low-level IO error
 */
- (jint)mergeFields;

/*!
 @brief Merge the TermVectors from each of the segments into the new one.
 @throws IOException if there is a low-level IO error
 */
- (jint)mergeVectors;

- (void)mergeTermsWithOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)segmentWriteState;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexSegmentMerger, directory_, OrgApacheLuceneStoreDirectory *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexSegmentMerger, codec_, OrgApacheLuceneCodecsCodec *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexSegmentMerger, context_, OrgApacheLuceneStoreIOContext *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexSegmentMerger, fieldInfosBuilder_, OrgApacheLuceneIndexFieldInfos_Builder *)

__attribute__((unused)) static void OrgApacheLuceneIndexSegmentMerger_mergeDocValuesWithOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneIndexSegmentMerger *self, OrgApacheLuceneIndexSegmentWriteState *segmentWriteState);

__attribute__((unused)) static void OrgApacheLuceneIndexSegmentMerger_mergeNormsWithOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneIndexSegmentMerger *self, OrgApacheLuceneIndexSegmentWriteState *segmentWriteState);

__attribute__((unused)) static jint OrgApacheLuceneIndexSegmentMerger_mergeFields(OrgApacheLuceneIndexSegmentMerger *self);

__attribute__((unused)) static jint OrgApacheLuceneIndexSegmentMerger_mergeVectors(OrgApacheLuceneIndexSegmentMerger *self);

__attribute__((unused)) static void OrgApacheLuceneIndexSegmentMerger_mergeTermsWithOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneIndexSegmentMerger *self, OrgApacheLuceneIndexSegmentWriteState *segmentWriteState);

@implementation OrgApacheLuceneIndexSegmentMerger

- (instancetype)initWithJavaUtilList:(id<JavaUtilList>)readers
 withOrgApacheLuceneIndexSegmentInfo:(OrgApacheLuceneIndexSegmentInfo *)segmentInfo
   withOrgApacheLuceneUtilInfoStream:(OrgApacheLuceneUtilInfoStream *)infoStream
   withOrgApacheLuceneStoreDirectory:(OrgApacheLuceneStoreDirectory *)dir
withOrgApacheLuceneIndexFieldInfos_FieldNumbers:(OrgApacheLuceneIndexFieldInfos_FieldNumbers *)fieldNumbers
   withOrgApacheLuceneStoreIOContext:(OrgApacheLuceneStoreIOContext *)context {
  OrgApacheLuceneIndexSegmentMerger_initWithJavaUtilList_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneUtilInfoStream_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_FieldNumbers_withOrgApacheLuceneStoreIOContext_(self, readers, segmentInfo, infoStream, dir, fieldNumbers, context);
  return self;
}

- (jboolean)shouldMerge {
  return [((OrgApacheLuceneIndexSegmentInfo *) nil_chk(((OrgApacheLuceneIndexMergeState *) nil_chk(mergeState_))->segmentInfo_)) maxDoc] > 0;
}

- (OrgApacheLuceneIndexMergeState *)merge {
  if (![self shouldMerge]) {
    @throw create_JavaLangIllegalStateException_initWithNSString_(@"Merge would result in 0 document segment");
  }
  [self mergeFieldInfos];
  jlong t0 = 0;
  if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(((OrgApacheLuceneIndexMergeState *) nil_chk(mergeState_))->infoStream_)) isEnabledWithNSString:@"SM"]) {
    t0 = JavaLangSystem_nanoTime();
  }
  jint numMerged = OrgApacheLuceneIndexSegmentMerger_mergeFields(self);
  if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
    jlong t1 = JavaLangSystem_nanoTime();
    [mergeState_->infoStream_ messageWithNSString:@"SM" withNSString:JreStrcat("J$I$", ((t1 - t0) / 1000000), @" msec to merge stored fields [", numMerged, @" docs]")];
  }
  JreAssert((numMerged == [((OrgApacheLuceneIndexSegmentInfo *) nil_chk(mergeState_->segmentInfo_)) maxDoc]), (JreStrcat("$I$I", @"numMerged=", numMerged, @" vs mergeState.segmentInfo.maxDoc()=", [mergeState_->segmentInfo_ maxDoc])));
  OrgApacheLuceneIndexSegmentWriteState *segmentWriteState = create_OrgApacheLuceneIndexSegmentWriteState_initWithOrgApacheLuceneUtilInfoStream_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneIndexFieldInfos_withOrgApacheLuceneIndexBufferedUpdates_withOrgApacheLuceneStoreIOContext_(mergeState_->infoStream_, directory_, mergeState_->segmentInfo_, mergeState_->mergeFieldInfos_, nil, context_);
  if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
    t0 = JavaLangSystem_nanoTime();
  }
  OrgApacheLuceneIndexSegmentMerger_mergeTermsWithOrgApacheLuceneIndexSegmentWriteState_(self, segmentWriteState);
  if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
    jlong t1 = JavaLangSystem_nanoTime();
    [mergeState_->infoStream_ messageWithNSString:@"SM" withNSString:JreStrcat("J$I$", ((t1 - t0) / 1000000), @" msec to merge postings [", numMerged, @" docs]")];
  }
  if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
    t0 = JavaLangSystem_nanoTime();
  }
  if ([((OrgApacheLuceneIndexFieldInfos *) nil_chk(mergeState_->mergeFieldInfos_)) hasDocValues]) {
    OrgApacheLuceneIndexSegmentMerger_mergeDocValuesWithOrgApacheLuceneIndexSegmentWriteState_(self, segmentWriteState);
  }
  if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
    jlong t1 = JavaLangSystem_nanoTime();
    [mergeState_->infoStream_ messageWithNSString:@"SM" withNSString:JreStrcat("J$I$", ((t1 - t0) / 1000000), @" msec to merge doc values [", numMerged, @" docs]")];
  }
  if ([((OrgApacheLuceneIndexFieldInfos *) nil_chk(mergeState_->mergeFieldInfos_)) hasNorms]) {
    if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
      t0 = JavaLangSystem_nanoTime();
    }
    OrgApacheLuceneIndexSegmentMerger_mergeNormsWithOrgApacheLuceneIndexSegmentWriteState_(self, segmentWriteState);
    if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
      jlong t1 = JavaLangSystem_nanoTime();
      [mergeState_->infoStream_ messageWithNSString:@"SM" withNSString:JreStrcat("J$I$", ((t1 - t0) / 1000000), @" msec to merge norms [", numMerged, @" docs]")];
    }
  }
  if ([((OrgApacheLuceneIndexFieldInfos *) nil_chk(mergeState_->mergeFieldInfos_)) hasVectors]) {
    if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
      t0 = JavaLangSystem_nanoTime();
    }
    numMerged = OrgApacheLuceneIndexSegmentMerger_mergeVectors(self);
    if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
      jlong t1 = JavaLangSystem_nanoTime();
      [mergeState_->infoStream_ messageWithNSString:@"SM" withNSString:JreStrcat("J$I$", ((t1 - t0) / 1000000), @" msec to merge vectors [", numMerged, @" docs]")];
    }
    JreAssert((numMerged == [mergeState_->segmentInfo_ maxDoc]), (@"org/apache/lucene/index/SegmentMerger.java:132 condition failed: assert numMerged == mergeState.segmentInfo.maxDoc();"));
  }
  if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
    t0 = JavaLangSystem_nanoTime();
  }
  [((OrgApacheLuceneCodecsFieldInfosFormat *) nil_chk([((OrgApacheLuceneCodecsCodec *) nil_chk(codec_)) fieldInfosFormat])) writeWithOrgApacheLuceneStoreDirectory:directory_ withOrgApacheLuceneIndexSegmentInfo:mergeState_->segmentInfo_ withNSString:@"" withOrgApacheLuceneIndexFieldInfos:mergeState_->mergeFieldInfos_ withOrgApacheLuceneStoreIOContext:context_];
  if ([mergeState_->infoStream_ isEnabledWithNSString:@"SM"]) {
    jlong t1 = JavaLangSystem_nanoTime();
    [mergeState_->infoStream_ messageWithNSString:@"SM" withNSString:JreStrcat("J$I$", ((t1 - t0) / 1000000), @" msec to write field infos [", numMerged, @" docs]")];
  }
  return mergeState_;
}

- (void)mergeDocValuesWithOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)segmentWriteState {
  OrgApacheLuceneIndexSegmentMerger_mergeDocValuesWithOrgApacheLuceneIndexSegmentWriteState_(self, segmentWriteState);
}

- (void)mergeNormsWithOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)segmentWriteState {
  OrgApacheLuceneIndexSegmentMerger_mergeNormsWithOrgApacheLuceneIndexSegmentWriteState_(self, segmentWriteState);
}

- (void)mergeFieldInfos {
  {
    IOSObjectArray *a__ = ((OrgApacheLuceneIndexMergeState *) nil_chk(mergeState_))->fieldInfos_;
    OrgApacheLuceneIndexFieldInfos * const *b__ = ((IOSObjectArray *) nil_chk(a__))->buffer_;
    OrgApacheLuceneIndexFieldInfos * const *e__ = b__ + a__->size_;
    while (b__ < e__) {
      OrgApacheLuceneIndexFieldInfos *readerFieldInfos = *b__++;
      for (OrgApacheLuceneIndexFieldInfo * __strong fi in nil_chk(readerFieldInfos)) {
        [((OrgApacheLuceneIndexFieldInfos_Builder *) nil_chk(fieldInfosBuilder_)) addWithOrgApacheLuceneIndexFieldInfo:fi];
      }
    }
  }
  JreStrongAssign(&mergeState_->mergeFieldInfos_, [((OrgApacheLuceneIndexFieldInfos_Builder *) nil_chk(fieldInfosBuilder_)) finish]);
}

- (jint)mergeFields {
  return OrgApacheLuceneIndexSegmentMerger_mergeFields(self);
}

- (jint)mergeVectors {
  return OrgApacheLuceneIndexSegmentMerger_mergeVectors(self);
}

- (void)mergeTermsWithOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)segmentWriteState {
  OrgApacheLuceneIndexSegmentMerger_mergeTermsWithOrgApacheLuceneIndexSegmentWriteState_(self, segmentWriteState);
}

- (void)dealloc {
  RELEASE_(directory_);
  RELEASE_(codec_);
  RELEASE_(context_);
  RELEASE_(mergeState_);
  RELEASE_(fieldInfosBuilder_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithJavaUtilList:withOrgApacheLuceneIndexSegmentInfo:withOrgApacheLuceneUtilInfoStream:withOrgApacheLuceneStoreDirectory:withOrgApacheLuceneIndexFieldInfos_FieldNumbers:withOrgApacheLuceneStoreIOContext:", "SegmentMerger", NULL, 0x0, "Ljava.io.IOException;", "(Ljava/util/List<Lorg/apache/lucene/index/CodecReader;>;Lorg/apache/lucene/index/SegmentInfo;Lorg/apache/lucene/util/InfoStream;Lorg/apache/lucene/store/Directory;Lorg/apache/lucene/index/FieldInfos$FieldNumbers;Lorg/apache/lucene/store/IOContext;)V" },
    { "shouldMerge", NULL, "Z", 0x0, NULL, NULL },
    { "merge", NULL, "Lorg.apache.lucene.index.MergeState;", 0x0, "Ljava.io.IOException;", NULL },
    { "mergeDocValuesWithOrgApacheLuceneIndexSegmentWriteState:", "mergeDocValues", "V", 0x2, "Ljava.io.IOException;", NULL },
    { "mergeNormsWithOrgApacheLuceneIndexSegmentWriteState:", "mergeNorms", "V", 0x2, "Ljava.io.IOException;", NULL },
    { "mergeFieldInfos", NULL, "V", 0x1, "Ljava.io.IOException;", NULL },
    { "mergeFields", NULL, "I", 0x2, "Ljava.io.IOException;", NULL },
    { "mergeVectors", NULL, "I", 0x2, "Ljava.io.IOException;", NULL },
    { "mergeTermsWithOrgApacheLuceneIndexSegmentWriteState:", "mergeTerms", "V", 0x2, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "directory_", NULL, 0x12, "Lorg.apache.lucene.store.Directory;", NULL, NULL, .constantValue.asLong = 0 },
    { "codec_", NULL, 0x12, "Lorg.apache.lucene.codecs.Codec;", NULL, NULL, .constantValue.asLong = 0 },
    { "context_", NULL, 0x12, "Lorg.apache.lucene.store.IOContext;", NULL, NULL, .constantValue.asLong = 0 },
    { "mergeState_", NULL, 0x10, "Lorg.apache.lucene.index.MergeState;", NULL, NULL, .constantValue.asLong = 0 },
    { "fieldInfosBuilder_", NULL, 0x12, "Lorg.apache.lucene.index.FieldInfos$Builder;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexSegmentMerger = { 2, "SegmentMerger", "org.apache.lucene.index", NULL, 0x10, 9, methods, 5, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneIndexSegmentMerger;
}

@end

void OrgApacheLuceneIndexSegmentMerger_initWithJavaUtilList_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneUtilInfoStream_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_FieldNumbers_withOrgApacheLuceneStoreIOContext_(OrgApacheLuceneIndexSegmentMerger *self, id<JavaUtilList> readers, OrgApacheLuceneIndexSegmentInfo *segmentInfo, OrgApacheLuceneUtilInfoStream *infoStream, OrgApacheLuceneStoreDirectory *dir, OrgApacheLuceneIndexFieldInfos_FieldNumbers *fieldNumbers, OrgApacheLuceneStoreIOContext *context) {
  NSObject_init(self);
  if (((OrgApacheLuceneStoreIOContext *) nil_chk(context))->context_ != JreLoadEnum(OrgApacheLuceneStoreIOContext_Context, MERGE)) {
    @throw create_JavaLangIllegalArgumentException_initWithNSString_(JreStrcat("$@", @"IOContext.context should be MERGE; got: ", context->context_));
  }
  JreStrongAssignAndConsume(&self->mergeState_, new_OrgApacheLuceneIndexMergeState_initWithJavaUtilList_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneUtilInfoStream_(readers, segmentInfo, infoStream));
  JreStrongAssign(&self->directory_, dir);
  JreStrongAssign(&self->codec_, [((OrgApacheLuceneIndexSegmentInfo *) nil_chk(segmentInfo)) getCodec]);
  JreStrongAssign(&self->context_, context);
  JreStrongAssignAndConsume(&self->fieldInfosBuilder_, new_OrgApacheLuceneIndexFieldInfos_Builder_initWithOrgApacheLuceneIndexFieldInfos_FieldNumbers_(fieldNumbers));
}

OrgApacheLuceneIndexSegmentMerger *new_OrgApacheLuceneIndexSegmentMerger_initWithJavaUtilList_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneUtilInfoStream_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_FieldNumbers_withOrgApacheLuceneStoreIOContext_(id<JavaUtilList> readers, OrgApacheLuceneIndexSegmentInfo *segmentInfo, OrgApacheLuceneUtilInfoStream *infoStream, OrgApacheLuceneStoreDirectory *dir, OrgApacheLuceneIndexFieldInfos_FieldNumbers *fieldNumbers, OrgApacheLuceneStoreIOContext *context) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexSegmentMerger, initWithJavaUtilList_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneUtilInfoStream_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_FieldNumbers_withOrgApacheLuceneStoreIOContext_, readers, segmentInfo, infoStream, dir, fieldNumbers, context)
}

OrgApacheLuceneIndexSegmentMerger *create_OrgApacheLuceneIndexSegmentMerger_initWithJavaUtilList_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneUtilInfoStream_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_FieldNumbers_withOrgApacheLuceneStoreIOContext_(id<JavaUtilList> readers, OrgApacheLuceneIndexSegmentInfo *segmentInfo, OrgApacheLuceneUtilInfoStream *infoStream, OrgApacheLuceneStoreDirectory *dir, OrgApacheLuceneIndexFieldInfos_FieldNumbers *fieldNumbers, OrgApacheLuceneStoreIOContext *context) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexSegmentMerger, initWithJavaUtilList_withOrgApacheLuceneIndexSegmentInfo_withOrgApacheLuceneUtilInfoStream_withOrgApacheLuceneStoreDirectory_withOrgApacheLuceneIndexFieldInfos_FieldNumbers_withOrgApacheLuceneStoreIOContext_, readers, segmentInfo, infoStream, dir, fieldNumbers, context)
}

void OrgApacheLuceneIndexSegmentMerger_mergeDocValuesWithOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneIndexSegmentMerger *self, OrgApacheLuceneIndexSegmentWriteState *segmentWriteState) {
  {
    OrgApacheLuceneCodecsDocValuesConsumer *consumer = [((OrgApacheLuceneCodecsDocValuesFormat *) nil_chk([((OrgApacheLuceneCodecsCodec *) nil_chk(self->codec_)) docValuesFormat])) fieldsConsumerWithOrgApacheLuceneIndexSegmentWriteState:segmentWriteState];
    NSException *__primaryException1 = nil;
    @try {
      [((OrgApacheLuceneCodecsDocValuesConsumer *) nil_chk(consumer)) mergeWithOrgApacheLuceneIndexMergeState:self->mergeState_];
    }
    @catch (NSException *e) {
      __primaryException1 = e;
      @throw e;
    }
    @finally {
      if (consumer != nil) {
        if (__primaryException1 != nil) {
          @try {
            [consumer close];
          } @catch (NSException *e) {
            [__primaryException1 addSuppressedWithNSException:e];
          }
        } else {
          [consumer close];
        }
      }
    }
  }
}

void OrgApacheLuceneIndexSegmentMerger_mergeNormsWithOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneIndexSegmentMerger *self, OrgApacheLuceneIndexSegmentWriteState *segmentWriteState) {
  {
    OrgApacheLuceneCodecsNormsConsumer *consumer = [((OrgApacheLuceneCodecsNormsFormat *) nil_chk([((OrgApacheLuceneCodecsCodec *) nil_chk(self->codec_)) normsFormat])) normsConsumerWithOrgApacheLuceneIndexSegmentWriteState:segmentWriteState];
    NSException *__primaryException1 = nil;
    @try {
      [((OrgApacheLuceneCodecsNormsConsumer *) nil_chk(consumer)) mergeWithOrgApacheLuceneIndexMergeState:self->mergeState_];
    }
    @catch (NSException *e) {
      __primaryException1 = e;
      @throw e;
    }
    @finally {
      if (consumer != nil) {
        if (__primaryException1 != nil) {
          @try {
            [consumer close];
          } @catch (NSException *e) {
            [__primaryException1 addSuppressedWithNSException:e];
          }
        } else {
          [consumer close];
        }
      }
    }
  }
}

jint OrgApacheLuceneIndexSegmentMerger_mergeFields(OrgApacheLuceneIndexSegmentMerger *self) {
  {
    OrgApacheLuceneCodecsStoredFieldsWriter *fieldsWriter = [((OrgApacheLuceneCodecsStoredFieldsFormat *) nil_chk([((OrgApacheLuceneCodecsCodec *) nil_chk(self->codec_)) storedFieldsFormat])) fieldsWriterWithOrgApacheLuceneStoreDirectory:self->directory_ withOrgApacheLuceneIndexSegmentInfo:((OrgApacheLuceneIndexMergeState *) nil_chk(self->mergeState_))->segmentInfo_ withOrgApacheLuceneStoreIOContext:self->context_];
    NSException *__primaryException1 = nil;
    @try {
      return [((OrgApacheLuceneCodecsStoredFieldsWriter *) nil_chk(fieldsWriter)) mergeWithOrgApacheLuceneIndexMergeState:self->mergeState_];
    }
    @catch (NSException *e) {
      __primaryException1 = e;
      @throw e;
    }
    @finally {
      if (fieldsWriter != nil) {
        if (__primaryException1 != nil) {
          @try {
            [fieldsWriter close];
          } @catch (NSException *e) {
            [__primaryException1 addSuppressedWithNSException:e];
          }
        } else {
          [fieldsWriter close];
        }
      }
    }
  }
}

jint OrgApacheLuceneIndexSegmentMerger_mergeVectors(OrgApacheLuceneIndexSegmentMerger *self) {
  {
    OrgApacheLuceneCodecsTermVectorsWriter *termVectorsWriter = [((OrgApacheLuceneCodecsTermVectorsFormat *) nil_chk([((OrgApacheLuceneCodecsCodec *) nil_chk(self->codec_)) termVectorsFormat])) vectorsWriterWithOrgApacheLuceneStoreDirectory:self->directory_ withOrgApacheLuceneIndexSegmentInfo:((OrgApacheLuceneIndexMergeState *) nil_chk(self->mergeState_))->segmentInfo_ withOrgApacheLuceneStoreIOContext:self->context_];
    NSException *__primaryException1 = nil;
    @try {
      return [((OrgApacheLuceneCodecsTermVectorsWriter *) nil_chk(termVectorsWriter)) mergeWithOrgApacheLuceneIndexMergeState:self->mergeState_];
    }
    @catch (NSException *e) {
      __primaryException1 = e;
      @throw e;
    }
    @finally {
      if (termVectorsWriter != nil) {
        if (__primaryException1 != nil) {
          @try {
            [termVectorsWriter close];
          } @catch (NSException *e) {
            [__primaryException1 addSuppressedWithNSException:e];
          }
        } else {
          [termVectorsWriter close];
        }
      }
    }
  }
}

void OrgApacheLuceneIndexSegmentMerger_mergeTermsWithOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneIndexSegmentMerger *self, OrgApacheLuceneIndexSegmentWriteState *segmentWriteState) {
  {
    OrgApacheLuceneCodecsFieldsConsumer *consumer = [((OrgApacheLuceneCodecsPostingsFormat *) nil_chk([((OrgApacheLuceneCodecsCodec *) nil_chk(self->codec_)) postingsFormat])) fieldsConsumerWithOrgApacheLuceneIndexSegmentWriteState:segmentWriteState];
    NSException *__primaryException1 = nil;
    @try {
      [((OrgApacheLuceneCodecsFieldsConsumer *) nil_chk(consumer)) mergeWithOrgApacheLuceneIndexMergeState:self->mergeState_];
    }
    @catch (NSException *e) {
      __primaryException1 = e;
      @throw e;
    }
    @finally {
      if (consumer != nil) {
        if (__primaryException1 != nil) {
          @try {
            [consumer close];
          } @catch (NSException *e) {
            [__primaryException1 addSuppressedWithNSException:e];
          }
        } else {
          [consumer close];
        }
      }
    }
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexSegmentMerger)
