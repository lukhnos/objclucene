//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/index/DocumentsWriterFlushQueue.java
//

#include "J2ObjC_source.h"
#include "java/lang/Thread.h"
#include "java/util/LinkedList.h"
#include "java/util/Queue.h"
#include "java/util/concurrent/atomic/AtomicInteger.h"
#include "java/util/concurrent/locks/ReentrantLock.h"
#include "org/apache/lucene/index/DocumentsWriterDeleteQueue.h"
#include "org/apache/lucene/index/DocumentsWriterFlushQueue.h"
#include "org/apache/lucene/index/DocumentsWriterPerThread.h"
#include "org/apache/lucene/index/FrozenBufferedUpdates.h"
#include "org/apache/lucene/index/IndexWriter.h"
#include "org/apache/lucene/index/SegmentCommitInfo.h"
#include "org/apache/lucene/util/InfoStream.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/index/DocumentsWriterFlushQueue must not be compiled with ARC (-fobjc-arc)"
#endif

@interface OrgApacheLuceneIndexDocumentsWriterFlushQueue () {
 @public
  id<JavaUtilQueue> queue_;
  JavaUtilConcurrentAtomicAtomicInteger *ticketCount_;
  JavaUtilConcurrentLocksReentrantLock *purgeLock_;
}

- (void)incTickets;

- (void)decTickets;

- (jint)innerPurgeWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer;

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriterFlushQueue, queue_, id<JavaUtilQueue>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriterFlushQueue, ticketCount_, JavaUtilConcurrentAtomicAtomicInteger *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriterFlushQueue, purgeLock_, JavaUtilConcurrentLocksReentrantLock *)

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriterFlushQueue_incTickets(OrgApacheLuceneIndexDocumentsWriterFlushQueue *self);

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriterFlushQueue_decTickets(OrgApacheLuceneIndexDocumentsWriterFlushQueue *self);

__attribute__((unused)) static jint OrgApacheLuceneIndexDocumentsWriterFlushQueue_innerPurgeWithOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexDocumentsWriterFlushQueue *self, OrgApacheLuceneIndexIndexWriter *writer);

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_publishFlushedSegmentWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket *self, OrgApacheLuceneIndexIndexWriter *indexWriter, OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *newSegment, OrgApacheLuceneIndexFrozenBufferedUpdates *globalPacket);

__attribute__((unused)) static void OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_finishFlushWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket *self, OrgApacheLuceneIndexIndexWriter *indexWriter, OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *newSegment, OrgApacheLuceneIndexFrozenBufferedUpdates *bufferedUpdates);

@interface OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket () {
 @public
  OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *segment_;
  jboolean failed_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket, segment_, OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *)

@implementation OrgApacheLuceneIndexDocumentsWriterFlushQueue

- (instancetype)initPackagePrivate {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_initPackagePrivate(self);
  return self;
}

- (void)addDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:(OrgApacheLuceneIndexDocumentsWriterDeleteQueue *)deleteQueue {
  @synchronized(self) {
    OrgApacheLuceneIndexDocumentsWriterFlushQueue_incTickets(self);
    jboolean success = false;
    @try {
      [((id<JavaUtilQueue>) nil_chk(queue_)) addWithId:create_OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_([((OrgApacheLuceneIndexDocumentsWriterDeleteQueue *) nil_chk(deleteQueue)) freezeGlobalBufferWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue_DeleteSlice:nil])];
      success = true;
    }
    @finally {
      if (!success) {
        OrgApacheLuceneIndexDocumentsWriterFlushQueue_decTickets(self);
      }
    }
  }
}

- (void)incTickets {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_incTickets(self);
}

- (void)decTickets {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_decTickets(self);
}

- (OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *)addFlushTicketWithOrgApacheLuceneIndexDocumentsWriterPerThread:(OrgApacheLuceneIndexDocumentsWriterPerThread *)dwpt {
  @synchronized(self) {
    OrgApacheLuceneIndexDocumentsWriterFlushQueue_incTickets(self);
    jboolean success = false;
    @try {
      OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *ticket = create_OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_([((OrgApacheLuceneIndexDocumentsWriterPerThread *) nil_chk(dwpt)) prepareFlush]);
      [((id<JavaUtilQueue>) nil_chk(queue_)) addWithId:ticket];
      success = true;
      return JreRetainedLocalValue(ticket);
    }
    @finally {
      if (!success) {
        OrgApacheLuceneIndexDocumentsWriterFlushQueue_decTickets(self);
      }
    }
  }
}

- (void)addSegmentWithOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket:(OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *)ticket
                       withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:(OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *)segment {
  @synchronized(self) {
    [((OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *) nil_chk(ticket)) setSegmentWithOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:segment];
  }
}

- (void)markTicketFailedWithOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket:(OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *)ticket {
  @synchronized(self) {
    [((OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *) nil_chk(ticket)) setFailed];
  }
}

- (jboolean)hasTickets {
  JreAssert([((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(ticketCount_)) get] >= 0, JreStrcat("$I", @"ticketCount should be >= 0 but was: ", [ticketCount_ get]));
  return [ticketCount_ get] != 0;
}

- (jint)innerPurgeWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  return OrgApacheLuceneIndexDocumentsWriterFlushQueue_innerPurgeWithOrgApacheLuceneIndexIndexWriter_(self, writer);
}

- (jint)forcePurgeWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  JreAssert(!JavaLangThread_holdsLockWithId_(self), @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:134 condition failed: assert !Thread.holdsLock(this);");
  JreAssert(!JavaLangThread_holdsLockWithId_(writer), @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:135 condition failed: assert !Thread.holdsLock(writer);");
  [((JavaUtilConcurrentLocksReentrantLock *) nil_chk(purgeLock_)) lock];
  @try {
    return OrgApacheLuceneIndexDocumentsWriterFlushQueue_innerPurgeWithOrgApacheLuceneIndexIndexWriter_(self, writer);
  }
  @finally {
    [purgeLock_ unlock];
  }
}

- (jint)tryPurgeWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  JreAssert(!JavaLangThread_holdsLockWithId_(self), @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:145 condition failed: assert !Thread.holdsLock(this);");
  JreAssert(!JavaLangThread_holdsLockWithId_(writer), @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:146 condition failed: assert !Thread.holdsLock(writer);");
  if ([((JavaUtilConcurrentLocksReentrantLock *) nil_chk(purgeLock_)) tryLock]) {
    @try {
      return OrgApacheLuceneIndexDocumentsWriterFlushQueue_innerPurgeWithOrgApacheLuceneIndexIndexWriter_(self, writer);
    }
    @finally {
      [purgeLock_ unlock];
    }
  }
  return 0;
}

- (jint)getTicketCount {
  return [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(ticketCount_)) get];
}

- (void)clear {
  @synchronized(self) {
    [((id<JavaUtilQueue>) nil_chk(queue_)) clear];
    [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(ticketCount_)) setWithInt:0];
  }
}

- (void)dealloc {
  RELEASE_(queue_);
  RELEASE_(ticketCount_);
  RELEASE_(purgeLock_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x0, 0, 1, 2, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x2, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket;", 0x20, 3, 4, -1, -1, -1, -1 },
    { NULL, "V", 0x20, 5, 6, -1, -1, -1, -1 },
    { NULL, "V", 0x20, 7, 8, -1, -1, -1, -1 },
    { NULL, "Z", 0x0, -1, -1, -1, -1, -1, -1 },
    { NULL, "I", 0x2, 9, 10, 2, -1, -1, -1 },
    { NULL, "I", 0x0, 11, 10, 2, -1, -1, -1 },
    { NULL, "I", 0x0, 12, 10, 2, -1, -1, -1 },
    { NULL, "I", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x20, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initPackagePrivate);
  methods[1].selector = @selector(addDeletesWithOrgApacheLuceneIndexDocumentsWriterDeleteQueue:);
  methods[2].selector = @selector(incTickets);
  methods[3].selector = @selector(decTickets);
  methods[4].selector = @selector(addFlushTicketWithOrgApacheLuceneIndexDocumentsWriterPerThread:);
  methods[5].selector = @selector(addSegmentWithOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket:withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:);
  methods[6].selector = @selector(markTicketFailedWithOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket:);
  methods[7].selector = @selector(hasTickets);
  methods[8].selector = @selector(innerPurgeWithOrgApacheLuceneIndexIndexWriter:);
  methods[9].selector = @selector(forcePurgeWithOrgApacheLuceneIndexIndexWriter:);
  methods[10].selector = @selector(tryPurgeWithOrgApacheLuceneIndexIndexWriter:);
  methods[11].selector = @selector(getTicketCount);
  methods[12].selector = @selector(clear);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "queue_", "LJavaUtilQueue;", .constantValue.asLong = 0, 0x12, -1, -1, 13, -1 },
    { "ticketCount_", "LJavaUtilConcurrentAtomicAtomicInteger;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "purgeLock_", "LJavaUtilConcurrentLocksReentrantLock;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "addDeletes", "LOrgApacheLuceneIndexDocumentsWriterDeleteQueue;", "LJavaIoIOException;", "addFlushTicket", "LOrgApacheLuceneIndexDocumentsWriterPerThread;", "addSegment", "LOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket;LOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment;", "markTicketFailed", "LOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket;", "innerPurge", "LOrgApacheLuceneIndexIndexWriter;", "forcePurge", "tryPurge", "Ljava/util/Queue<Lorg/apache/lucene/index/DocumentsWriterFlushQueue$FlushTicket;>;", "LOrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket;LOrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket;LOrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriterFlushQueue = { "DocumentsWriterFlushQueue", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x0, 13, 3, -1, 14, -1, -1, -1 };
  return &_OrgApacheLuceneIndexDocumentsWriterFlushQueue;
}

@end

void OrgApacheLuceneIndexDocumentsWriterFlushQueue_initPackagePrivate(OrgApacheLuceneIndexDocumentsWriterFlushQueue *self) {
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->queue_, new_JavaUtilLinkedList_init());
  JreStrongAssignAndConsume(&self->ticketCount_, new_JavaUtilConcurrentAtomicAtomicInteger_init());
  JreStrongAssignAndConsume(&self->purgeLock_, new_JavaUtilConcurrentLocksReentrantLock_init());
}

OrgApacheLuceneIndexDocumentsWriterFlushQueue *new_OrgApacheLuceneIndexDocumentsWriterFlushQueue_initPackagePrivate() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriterFlushQueue, initPackagePrivate)
}

OrgApacheLuceneIndexDocumentsWriterFlushQueue *create_OrgApacheLuceneIndexDocumentsWriterFlushQueue_initPackagePrivate() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriterFlushQueue, initPackagePrivate)
}

void OrgApacheLuceneIndexDocumentsWriterFlushQueue_incTickets(OrgApacheLuceneIndexDocumentsWriterFlushQueue *self) {
  jint numTickets = [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(self->ticketCount_)) incrementAndGet];
  JreAssert(numTickets > 0, @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:55 condition failed: assert numTickets > 0;");
}

void OrgApacheLuceneIndexDocumentsWriterFlushQueue_decTickets(OrgApacheLuceneIndexDocumentsWriterFlushQueue *self) {
  jint numTickets = [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(self->ticketCount_)) decrementAndGet];
  JreAssert(numTickets >= 0, @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:60 condition failed: assert numTickets >= 0;");
}

jint OrgApacheLuceneIndexDocumentsWriterFlushQueue_innerPurgeWithOrgApacheLuceneIndexIndexWriter_(OrgApacheLuceneIndexDocumentsWriterFlushQueue *self, OrgApacheLuceneIndexIndexWriter *writer) {
  JreAssert([((JavaUtilConcurrentLocksReentrantLock *) nil_chk(self->purgeLock_)) isHeldByCurrentThread], @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:98 condition failed: assert purgeLock.isHeldByCurrentThread();");
  jint numPurged = 0;
  while (true) {
    OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket *head;
    jboolean canPublish;
    @synchronized(self) {
      head = JreRetainedLocalValue([((id<JavaUtilQueue>) nil_chk(self->queue_)) peek]);
      canPublish = (head != nil && [head canPublish]);
    }
    if (canPublish) {
      numPurged++;
      @try {
        [((OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket *) nil_chk(head)) publishWithOrgApacheLuceneIndexIndexWriter:writer];
      }
      @finally {
        @synchronized(self) {
          OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket *poll = [self->queue_ poll];
          [((JavaUtilConcurrentAtomicAtomicInteger *) nil_chk(self->ticketCount_)) decrementAndGet];
          JreAssert(JreObjectEqualsEquals(poll, head), @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:123 condition failed: assert poll == head;");
        }
      }
    }
    else {
      break;
    }
  }
  return numPurged;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriterFlushQueue)

@implementation OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket

- (instancetype)initWithOrgApacheLuceneIndexFrozenBufferedUpdates:(OrgApacheLuceneIndexFrozenBufferedUpdates *)frozenUpdates {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(self, frozenUpdates);
  return self;
}

- (void)publishWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
}

- (jboolean)canPublish {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (void)publishFlushedSegmentWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)indexWriter
 withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:(OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *)newSegment
                   withOrgApacheLuceneIndexFrozenBufferedUpdates:(OrgApacheLuceneIndexFrozenBufferedUpdates *)globalPacket {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_publishFlushedSegmentWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(self, indexWriter, newSegment, globalPacket);
}

- (void)finishFlushWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)indexWriter
withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:(OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *)newSegment
         withOrgApacheLuceneIndexFrozenBufferedUpdates:(OrgApacheLuceneIndexFrozenBufferedUpdates *)bufferedUpdates {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_finishFlushWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(self, indexWriter, newSegment, bufferedUpdates);
}

- (void)dealloc {
  RELEASE_(frozenUpdates_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x4, -1, 0, -1, -1, -1, -1 },
    { NULL, "V", 0x404, 1, 2, 3, -1, -1, -1 },
    { NULL, "Z", 0x404, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x14, 4, 5, 3, -1, -1, -1 },
    { NULL, "V", 0x14, 6, 5, 3, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneIndexFrozenBufferedUpdates:);
  methods[1].selector = @selector(publishWithOrgApacheLuceneIndexIndexWriter:);
  methods[2].selector = @selector(canPublish);
  methods[3].selector = @selector(publishFlushedSegmentWithOrgApacheLuceneIndexIndexWriter:withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:withOrgApacheLuceneIndexFrozenBufferedUpdates:);
  methods[4].selector = @selector(finishFlushWithOrgApacheLuceneIndexIndexWriter:withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:withOrgApacheLuceneIndexFrozenBufferedUpdates:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "frozenUpdates_", "LOrgApacheLuceneIndexFrozenBufferedUpdates;", .constantValue.asLong = 0, 0x4, -1, -1, -1, -1 },
    { "published_", "Z", .constantValue.asLong = 0, 0x4, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneIndexFrozenBufferedUpdates;", "publish", "LOrgApacheLuceneIndexIndexWriter;", "LJavaIoIOException;", "publishFlushedSegment", "LOrgApacheLuceneIndexIndexWriter;LOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment;LOrgApacheLuceneIndexFrozenBufferedUpdates;", "finishFlush", "LOrgApacheLuceneIndexDocumentsWriterFlushQueue;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket = { "FlushTicket", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x408, 5, 2, 7, -1, -1, -1, -1 };
  return &_OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket;
}

@end

void OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket *self, OrgApacheLuceneIndexFrozenBufferedUpdates *frozenUpdates) {
  NSObject_init(self);
  self->published_ = false;
  JreAssert(frozenUpdates != nil, @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:171 condition failed: assert frozenUpdates != null;");
  JreStrongAssign(&self->frozenUpdates_, frozenUpdates);
}

void OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_publishFlushedSegmentWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket *self, OrgApacheLuceneIndexIndexWriter *indexWriter, OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *newSegment, OrgApacheLuceneIndexFrozenBufferedUpdates *globalPacket) {
  JreAssert(newSegment != nil, @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:186 condition failed: assert newSegment != null;");
  JreAssert(((OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *) nil_chk(newSegment))->segmentInfo_ != nil, @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:187 condition failed: assert newSegment.segmentInfo != null;");
  OrgApacheLuceneIndexFrozenBufferedUpdates *segmentUpdates = newSegment->segmentUpdates_;
  if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(((OrgApacheLuceneIndexIndexWriter *) nil_chk(indexWriter))->infoStream_)) isEnabledWithNSString:@"DW"]) {
    [indexWriter->infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$@", @"publishFlushedSegment seg-private updates=", segmentUpdates)];
  }
  if (segmentUpdates != nil && [indexWriter->infoStream_ isEnabledWithNSString:@"DW"]) {
    [indexWriter->infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$@", @"flush: push buffered seg private updates: ", segmentUpdates)];
  }
  [indexWriter publishFlushedSegmentWithOrgApacheLuceneIndexSegmentCommitInfo:newSegment->segmentInfo_ withOrgApacheLuceneIndexFrozenBufferedUpdates:segmentUpdates withOrgApacheLuceneIndexFrozenBufferedUpdates:globalPacket];
}

void OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_finishFlushWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket *self, OrgApacheLuceneIndexIndexWriter *indexWriter, OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *newSegment, OrgApacheLuceneIndexFrozenBufferedUpdates *bufferedUpdates) {
  if (newSegment == nil) {
    JreAssert(bufferedUpdates != nil, @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:205 condition failed: assert bufferedUpdates != null;");
    if (bufferedUpdates != nil && [bufferedUpdates any]) {
      [((OrgApacheLuceneIndexIndexWriter *) nil_chk(indexWriter)) publishFrozenUpdatesWithOrgApacheLuceneIndexFrozenBufferedUpdates:bufferedUpdates];
      if ([((OrgApacheLuceneUtilInfoStream *) nil_chk(indexWriter->infoStream_)) isEnabledWithNSString:@"DW"]) {
        [indexWriter->infoStream_ messageWithNSString:@"DW" withNSString:JreStrcat("$@", @"flush: push buffered updates: ", bufferedUpdates)];
      }
    }
  }
  else {
    OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_publishFlushedSegmentWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(self, indexWriter, newSegment, bufferedUpdates);
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket)

@implementation OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket

- (instancetype)initWithOrgApacheLuceneIndexFrozenBufferedUpdates:(OrgApacheLuceneIndexFrozenBufferedUpdates *)frozenUpdates {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(self, frozenUpdates);
  return self;
}

- (void)publishWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  JreAssert(!published_, @"ticket was already publised - can not publish twice");
  published_ = true;
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_finishFlushWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(self, writer, nil, frozenUpdates_);
}

- (jboolean)canPublish {
  return true;
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x4, -1, 0, -1, -1, -1, -1 },
    { NULL, "V", 0x4, 1, 2, 3, -1, -1, -1 },
    { NULL, "Z", 0x4, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneIndexFrozenBufferedUpdates:);
  methods[1].selector = @selector(publishWithOrgApacheLuceneIndexIndexWriter:);
  methods[2].selector = @selector(canPublish);
  #pragma clang diagnostic pop
  static const void *ptrTable[] = { "LOrgApacheLuceneIndexFrozenBufferedUpdates;", "publish", "LOrgApacheLuceneIndexIndexWriter;", "LJavaIoIOException;", "LOrgApacheLuceneIndexDocumentsWriterFlushQueue;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket = { "GlobalDeletesTicket", "org.apache.lucene.index", ptrTable, methods, NULL, 7, 0x18, 3, 0, 4, -1, -1, -1, -1 };
  return &_OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket;
}

@end

void OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket *self, OrgApacheLuceneIndexFrozenBufferedUpdates *frozenUpdates) {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(self, frozenUpdates);
}

OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket *new_OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexFrozenBufferedUpdates *frozenUpdates) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket, initWithOrgApacheLuceneIndexFrozenBufferedUpdates_, frozenUpdates)
}

OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket *create_OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexFrozenBufferedUpdates *frozenUpdates) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket, initWithOrgApacheLuceneIndexFrozenBufferedUpdates_, frozenUpdates)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriterFlushQueue_GlobalDeletesTicket)

@implementation OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket

- (instancetype)initWithOrgApacheLuceneIndexFrozenBufferedUpdates:(OrgApacheLuceneIndexFrozenBufferedUpdates *)frozenDeletes {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(self, frozenDeletes);
  return self;
}

- (void)publishWithOrgApacheLuceneIndexIndexWriter:(OrgApacheLuceneIndexIndexWriter *)writer {
  JreAssert(!published_, @"ticket was already publised - can not publish twice");
  published_ = true;
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_finishFlushWithOrgApacheLuceneIndexIndexWriter_withOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment_withOrgApacheLuceneIndexFrozenBufferedUpdates_(self, writer, segment_, frozenUpdates_);
}

- (void)setSegmentWithOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:(OrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment *)segment {
  JreAssert(!failed_, @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:253 condition failed: assert !failed;");
  JreStrongAssign(&self->segment_, segment);
}

- (void)setFailed {
  JreAssert(segment_ == nil, @"org/apache/lucene/index/DocumentsWriterFlushQueue.java:258 condition failed: assert segment == null;");
  failed_ = true;
}

- (jboolean)canPublish {
  return segment_ != nil || failed_;
}

- (void)dealloc {
  RELEASE_(segment_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x4, -1, 0, -1, -1, -1, -1 },
    { NULL, "V", 0x4, 1, 2, 3, -1, -1, -1 },
    { NULL, "V", 0x4, 4, 5, -1, -1, -1, -1 },
    { NULL, "V", 0x4, -1, -1, -1, -1, -1, -1 },
    { NULL, "Z", 0x4, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgApacheLuceneIndexFrozenBufferedUpdates:);
  methods[1].selector = @selector(publishWithOrgApacheLuceneIndexIndexWriter:);
  methods[2].selector = @selector(setSegmentWithOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment:);
  methods[3].selector = @selector(setFailed);
  methods[4].selector = @selector(canPublish);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "segment_", "LOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "failed_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgApacheLuceneIndexFrozenBufferedUpdates;", "publish", "LOrgApacheLuceneIndexIndexWriter;", "LJavaIoIOException;", "setSegment", "LOrgApacheLuceneIndexDocumentsWriterPerThread_FlushedSegment;", "LOrgApacheLuceneIndexDocumentsWriterFlushQueue;" };
  static const J2ObjcClassInfo _OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket = { "SegmentFlushTicket", "org.apache.lucene.index", ptrTable, methods, fields, 7, 0x18, 5, 2, 6, -1, -1, -1, -1 };
  return &_OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket;
}

@end

void OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *self, OrgApacheLuceneIndexFrozenBufferedUpdates *frozenDeletes) {
  OrgApacheLuceneIndexDocumentsWriterFlushQueue_FlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(self, frozenDeletes);
  self->failed_ = false;
}

OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *new_OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexFrozenBufferedUpdates *frozenDeletes) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket, initWithOrgApacheLuceneIndexFrozenBufferedUpdates_, frozenDeletes)
}

OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket *create_OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket_initWithOrgApacheLuceneIndexFrozenBufferedUpdates_(OrgApacheLuceneIndexFrozenBufferedUpdates *frozenDeletes) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket, initWithOrgApacheLuceneIndexFrozenBufferedUpdates_, frozenDeletes)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneIndexDocumentsWriterFlushQueue_SegmentFlushTicket)
