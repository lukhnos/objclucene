//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/codecs/lucene50/Lucene50SkipWriter.java
//

#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/util/Arrays.h"
#include "org/apache/lucene/codecs/MultiLevelSkipListWriter.h"
#include "org/apache/lucene/codecs/lucene50/Lucene50SkipWriter.h"
#include "org/apache/lucene/store/IndexOutput.h"

#if __has_feature(objc_arc)
#error "org/apache/lucene/codecs/lucene50/Lucene50SkipWriter must not be compiled with ARC (-fobjc-arc)"
#endif

@interface OrgApacheLuceneCodecsLucene50Lucene50SkipWriter () {
 @public
  IOSIntArray *lastSkipDoc_;
  IOSLongArray *lastSkipDocPointer_;
  IOSLongArray *lastSkipPosPointer_;
  IOSLongArray *lastSkipPayPointer_;
  IOSIntArray *lastPayloadByteUpto_;
  OrgApacheLuceneStoreIndexOutput *docOut_;
  OrgApacheLuceneStoreIndexOutput *posOut_;
  OrgApacheLuceneStoreIndexOutput *payOut_;
  jint curDoc_;
  jlong curDocPointer_;
  jlong curPosPointer_;
  jlong curPayPointer_;
  jint curPosBufferUpto_;
  jint curPayloadByteUpto_;
  jboolean fieldHasPositions_;
  jboolean fieldHasOffsets_;
  jboolean fieldHasPayloads_;
  jboolean initialized_;
}

@end

J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, lastSkipDoc_, IOSIntArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, lastSkipDocPointer_, IOSLongArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, lastSkipPosPointer_, IOSLongArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, lastSkipPayPointer_, IOSLongArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, lastPayloadByteUpto_, IOSIntArray *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, docOut_, OrgApacheLuceneStoreIndexOutput *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, posOut_, OrgApacheLuceneStoreIndexOutput *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, payOut_, OrgApacheLuceneStoreIndexOutput *)

@implementation OrgApacheLuceneCodecsLucene50Lucene50SkipWriter

- (instancetype)initPackagePrivateWithInt:(jint)maxSkipLevels
                                  withInt:(jint)blockSize
                                  withInt:(jint)docCount
      withOrgApacheLuceneStoreIndexOutput:(OrgApacheLuceneStoreIndexOutput *)docOut
      withOrgApacheLuceneStoreIndexOutput:(OrgApacheLuceneStoreIndexOutput *)posOut
      withOrgApacheLuceneStoreIndexOutput:(OrgApacheLuceneStoreIndexOutput *)payOut {
  OrgApacheLuceneCodecsLucene50Lucene50SkipWriter_initPackagePrivateWithInt_withInt_withInt_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_(self, maxSkipLevels, blockSize, docCount, docOut, posOut, payOut);
  return self;
}

- (void)setFieldWithBoolean:(jboolean)fieldHasPositions
                withBoolean:(jboolean)fieldHasOffsets
                withBoolean:(jboolean)fieldHasPayloads {
  self->fieldHasPositions_ = fieldHasPositions;
  self->fieldHasOffsets_ = fieldHasOffsets;
  self->fieldHasPayloads_ = fieldHasPayloads;
}

- (void)resetSkip {
  lastDocFP_ = [((OrgApacheLuceneStoreIndexOutput *) nil_chk(docOut_)) getFilePointer];
  if (fieldHasPositions_) {
    lastPosFP_ = [((OrgApacheLuceneStoreIndexOutput *) nil_chk(posOut_)) getFilePointer];
    if (fieldHasOffsets_ || fieldHasPayloads_) {
      lastPayFP_ = [((OrgApacheLuceneStoreIndexOutput *) nil_chk(payOut_)) getFilePointer];
    }
  }
  initialized_ = false;
}

- (void)initSkip {
  if (!initialized_) {
    [super resetSkip];
    JavaUtilArrays_fillWithIntArray_withInt_(lastSkipDoc_, 0);
    JavaUtilArrays_fillWithLongArray_withLong_(lastSkipDocPointer_, lastDocFP_);
    if (fieldHasPositions_) {
      JavaUtilArrays_fillWithLongArray_withLong_(lastSkipPosPointer_, lastPosFP_);
      if (fieldHasPayloads_) {
        JavaUtilArrays_fillWithIntArray_withInt_(lastPayloadByteUpto_, 0);
      }
      if (fieldHasOffsets_ || fieldHasPayloads_) {
        JavaUtilArrays_fillWithLongArray_withLong_(lastSkipPayPointer_, lastPayFP_);
      }
    }
    initialized_ = true;
  }
}

- (void)bufferSkipWithInt:(jint)doc
                  withInt:(jint)numDocs
                 withLong:(jlong)posFP
                 withLong:(jlong)payFP
                  withInt:(jint)posBufferUpto
                  withInt:(jint)payloadByteUpto {
  [self initSkip];
  self->curDoc_ = doc;
  self->curDocPointer_ = [((OrgApacheLuceneStoreIndexOutput *) nil_chk(docOut_)) getFilePointer];
  self->curPosPointer_ = posFP;
  self->curPayPointer_ = payFP;
  self->curPosBufferUpto_ = posBufferUpto;
  self->curPayloadByteUpto_ = payloadByteUpto;
  [self bufferSkipWithInt:numDocs];
}

- (void)writeSkipDataWithInt:(jint)level
withOrgApacheLuceneStoreIndexOutput:(OrgApacheLuceneStoreIndexOutput *)skipBuffer {
  jint delta = curDoc_ - IOSIntArray_Get(nil_chk(lastSkipDoc_), level);
  [((OrgApacheLuceneStoreIndexOutput *) nil_chk(skipBuffer)) writeVIntWithInt:delta];
  *IOSIntArray_GetRef(nil_chk(lastSkipDoc_), level) = curDoc_;
  [skipBuffer writeVLongWithLong:curDocPointer_ - IOSLongArray_Get(nil_chk(lastSkipDocPointer_), level)];
  *IOSLongArray_GetRef(nil_chk(lastSkipDocPointer_), level) = curDocPointer_;
  if (fieldHasPositions_) {
    [skipBuffer writeVLongWithLong:curPosPointer_ - IOSLongArray_Get(nil_chk(lastSkipPosPointer_), level)];
    *IOSLongArray_GetRef(nil_chk(lastSkipPosPointer_), level) = curPosPointer_;
    [skipBuffer writeVIntWithInt:curPosBufferUpto_];
    if (fieldHasPayloads_) {
      [skipBuffer writeVIntWithInt:curPayloadByteUpto_];
    }
    if (fieldHasOffsets_ || fieldHasPayloads_) {
      [skipBuffer writeVLongWithLong:curPayPointer_ - IOSLongArray_Get(nil_chk(lastSkipPayPointer_), level)];
      *IOSLongArray_GetRef(nil_chk(lastSkipPayPointer_), level) = curPayPointer_;
    }
  }
}

- (void)dealloc {
  RELEASE_(lastSkipDoc_);
  RELEASE_(lastSkipDocPointer_);
  RELEASE_(lastSkipPosPointer_);
  RELEASE_(lastSkipPayPointer_);
  RELEASE_(lastPayloadByteUpto_);
  RELEASE_(docOut_);
  RELEASE_(posOut_);
  RELEASE_(payOut_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 1, 2, -1, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 3, 4, 5, -1, -1, -1 },
    { NULL, "V", 0x4, 6, 7, 5, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initPackagePrivateWithInt:withInt:withInt:withOrgApacheLuceneStoreIndexOutput:withOrgApacheLuceneStoreIndexOutput:withOrgApacheLuceneStoreIndexOutput:);
  methods[1].selector = @selector(setFieldWithBoolean:withBoolean:withBoolean:);
  methods[2].selector = @selector(resetSkip);
  methods[3].selector = @selector(initSkip);
  methods[4].selector = @selector(bufferSkipWithInt:withInt:withLong:withLong:withInt:withInt:);
  methods[5].selector = @selector(writeSkipDataWithInt:withOrgApacheLuceneStoreIndexOutput:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "lastSkipDoc_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "lastSkipDocPointer_", "[J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "lastSkipPosPointer_", "[J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "lastSkipPayPointer_", "[J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "lastPayloadByteUpto_", "[I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "docOut_", "LOrgApacheLuceneStoreIndexOutput;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "posOut_", "LOrgApacheLuceneStoreIndexOutput;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "payOut_", "LOrgApacheLuceneStoreIndexOutput;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "curDoc_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "curDocPointer_", "J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "curPosPointer_", "J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "curPayPointer_", "J", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "curPosBufferUpto_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "curPayloadByteUpto_", "I", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "fieldHasPositions_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "fieldHasOffsets_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "fieldHasPayloads_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "initialized_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "lastDocFP_", "J", .constantValue.asLong = 0, 0x0, -1, -1, -1, -1 },
    { "lastPosFP_", "J", .constantValue.asLong = 0, 0x0, -1, -1, -1, -1 },
    { "lastPayFP_", "J", .constantValue.asLong = 0, 0x0, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "IIILOrgApacheLuceneStoreIndexOutput;LOrgApacheLuceneStoreIndexOutput;LOrgApacheLuceneStoreIndexOutput;", "setField", "ZZZ", "bufferSkip", "IIJJII", "LJavaIoIOException;", "writeSkipData", "ILOrgApacheLuceneStoreIndexOutput;" };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsLucene50Lucene50SkipWriter = { "Lucene50SkipWriter", "org.apache.lucene.codecs.lucene50", ptrTable, methods, fields, 7, 0x10, 6, 21, -1, -1, -1, -1, -1 };
  return &_OrgApacheLuceneCodecsLucene50Lucene50SkipWriter;
}

@end

void OrgApacheLuceneCodecsLucene50Lucene50SkipWriter_initPackagePrivateWithInt_withInt_withInt_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter *self, jint maxSkipLevels, jint blockSize, jint docCount, OrgApacheLuceneStoreIndexOutput *docOut, OrgApacheLuceneStoreIndexOutput *posOut, OrgApacheLuceneStoreIndexOutput *payOut) {
  OrgApacheLuceneCodecsMultiLevelSkipListWriter_initWithInt_withInt_withInt_withInt_(self, blockSize, 8, maxSkipLevels, docCount);
  JreStrongAssign(&self->docOut_, docOut);
  JreStrongAssign(&self->posOut_, posOut);
  JreStrongAssign(&self->payOut_, payOut);
  JreStrongAssignAndConsume(&self->lastSkipDoc_, [IOSIntArray newArrayWithLength:maxSkipLevels]);
  JreStrongAssignAndConsume(&self->lastSkipDocPointer_, [IOSLongArray newArrayWithLength:maxSkipLevels]);
  if (posOut != nil) {
    JreStrongAssignAndConsume(&self->lastSkipPosPointer_, [IOSLongArray newArrayWithLength:maxSkipLevels]);
    if (payOut != nil) {
      JreStrongAssignAndConsume(&self->lastSkipPayPointer_, [IOSLongArray newArrayWithLength:maxSkipLevels]);
    }
    JreStrongAssignAndConsume(&self->lastPayloadByteUpto_, [IOSIntArray newArrayWithLength:maxSkipLevels]);
  }
}

OrgApacheLuceneCodecsLucene50Lucene50SkipWriter *new_OrgApacheLuceneCodecsLucene50Lucene50SkipWriter_initPackagePrivateWithInt_withInt_withInt_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_(jint maxSkipLevels, jint blockSize, jint docCount, OrgApacheLuceneStoreIndexOutput *docOut, OrgApacheLuceneStoreIndexOutput *posOut, OrgApacheLuceneStoreIndexOutput *payOut) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, initPackagePrivateWithInt_withInt_withInt_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_, maxSkipLevels, blockSize, docCount, docOut, posOut, payOut)
}

OrgApacheLuceneCodecsLucene50Lucene50SkipWriter *create_OrgApacheLuceneCodecsLucene50Lucene50SkipWriter_initPackagePrivateWithInt_withInt_withInt_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_(jint maxSkipLevels, jint blockSize, jint docCount, OrgApacheLuceneStoreIndexOutput *docOut, OrgApacheLuceneStoreIndexOutput *posOut, OrgApacheLuceneStoreIndexOutput *payOut) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter, initPackagePrivateWithInt_withInt_withInt_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_withOrgApacheLuceneStoreIndexOutput_, maxSkipLevels, blockSize, docCount, docOut, posOut, payOut)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsLucene50Lucene50SkipWriter)
