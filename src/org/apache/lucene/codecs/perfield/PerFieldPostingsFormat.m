//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: ./core/src/java/org/apache/lucene/codecs/perfield/PerFieldPostingsFormat.java
//

#include "IOSClass.h"
#include "J2ObjC_source.h"
#include "java/io/IOException.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/Integer.h"
#include "java/util/ArrayList.h"
#include "java/util/Collection.h"
#include "java/util/Collections.h"
#include "java/util/HashMap.h"
#include "java/util/IdentityHashMap.h"
#include "java/util/Iterator.h"
#include "java/util/List.h"
#include "java/util/Map.h"
#include "java/util/Set.h"
#include "java/util/TreeMap.h"
#include "java/util/TreeSet.h"
#include "org/apache/lucene/codecs/FieldsConsumer.h"
#include "org/apache/lucene/codecs/FieldsProducer.h"
#include "org/apache/lucene/codecs/PostingsFormat.h"
#include "org/apache/lucene/codecs/perfield/PerFieldPostingsFormat.h"
#include "org/apache/lucene/index/FieldInfo.h"
#include "org/apache/lucene/index/FieldInfos.h"
#include "org/apache/lucene/index/Fields.h"
#include "org/apache/lucene/index/FilterLeafReader.h"
#include "org/apache/lucene/index/IndexOptions.h"
#include "org/apache/lucene/index/SegmentInfo.h"
#include "org/apache/lucene/index/SegmentReadState.h"
#include "org/apache/lucene/index/SegmentWriteState.h"
#include "org/apache/lucene/index/Terms.h"
#include "org/apache/lucene/util/Accountables.h"
#include "org/apache/lucene/util/IOUtils.h"
#include "org/apache/lucene/util/RamUsageEstimator.h"

@interface OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter : OrgApacheLuceneCodecsFieldsConsumer {
 @public
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *this$0_;
  OrgApacheLuceneIndexSegmentWriteState *writeState_;
  id<JavaUtilList> toClose_;
}

- (instancetype)initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat:(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *)outer$
                                  withOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)writeState;

- (void)writeWithOrgApacheLuceneIndexFields:(OrgApacheLuceneIndexFields *)fields;

- (void)close;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter)

J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter, this$0_, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter, writeState_, OrgApacheLuceneIndexSegmentWriteState *)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter, toClose_, id<JavaUtilList>)

__attribute__((unused)) static void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter *self, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *outer$, OrgApacheLuceneIndexSegmentWriteState *writeState);

__attribute__((unused)) static OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *outer$, OrgApacheLuceneIndexSegmentWriteState *writeState) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *outer$, OrgApacheLuceneIndexSegmentWriteState *writeState);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter)

@interface OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1 : OrgApacheLuceneIndexFilterLeafReader_FilterFields {
 @public
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *val$group_;
}

- (id<JavaUtilIterator>)iterator;

- (instancetype)initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup:(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *)capture$0
                                                         withOrgApacheLuceneIndexFields:(OrgApacheLuceneIndexFields *)arg$0;

@end

J2OBJC_EMPTY_STATIC_INIT(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1)

J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1, val$group_, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *)

__attribute__((unused)) static void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1 *self, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *capture$0, OrgApacheLuceneIndexFields *arg$0);

__attribute__((unused)) static OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1 *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *capture$0, OrgApacheLuceneIndexFields *arg$0) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1 *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *capture$0, OrgApacheLuceneIndexFields *arg$0);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1)

@interface OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader : OrgApacheLuceneCodecsFieldsProducer {
 @public
  id<JavaUtilMap> fields_;
  id<JavaUtilMap> formats_;
  NSString *segment_;
}

- (instancetype)initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader:(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *)other;

- (instancetype)initWithOrgApacheLuceneIndexSegmentReadState:(OrgApacheLuceneIndexSegmentReadState *)readState;

- (id<JavaUtilIterator>)iterator;

- (OrgApacheLuceneIndexTerms *)termsWithNSString:(NSString *)field;

- (jint)size;

- (void)close;

- (jlong)ramBytesUsed;

- (id<JavaUtilCollection>)getChildResources;

- (void)checkIntegrity;

- (OrgApacheLuceneCodecsFieldsProducer *)getMergeInstance;

- (NSString *)description;

@end

J2OBJC_STATIC_INIT(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader)

J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader, fields_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader, formats_, id<JavaUtilMap>)
J2OBJC_FIELD_SETTER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader, segment_, NSString *)

inline jlong OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_get_BASE_RAM_BYTES_USED();
static jlong OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_BASE_RAM_BYTES_USED;
J2OBJC_STATIC_FIELD_PRIMITIVE_FINAL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader, BASE_RAM_BYTES_USED, jlong)

__attribute__((unused)) static void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *self, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *other);

__attribute__((unused)) static OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *other) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *other);

__attribute__((unused)) static void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *self, OrgApacheLuceneIndexSegmentReadState *readState);

__attribute__((unused)) static OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneIndexSegmentReadState *readState) NS_RETURNS_RETAINED;

__attribute__((unused)) static OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneIndexSegmentReadState *readState);

J2OBJC_TYPE_LITERAL_HEADER(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader)

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat)

NSString *OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_NAME = @"PerField40";
NSString *OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_FORMAT_KEY;
NSString *OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_SUFFIX_KEY;

@implementation OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat

+ (NSString *)PER_FIELD_NAME {
  return OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_NAME;
}

+ (NSString *)PER_FIELD_FORMAT_KEY {
  return OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_FORMAT_KEY;
}

+ (NSString *)PER_FIELD_SUFFIX_KEY {
  return OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_SUFFIX_KEY;
}

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

+ (NSString *)getSuffixWithNSString:(NSString *)formatName
                       withNSString:(NSString *)suffix {
  return OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_getSuffixWithNSString_withNSString_(formatName, suffix);
}

+ (NSString *)getFullSegmentSuffixWithNSString:(NSString *)fieldName
                                  withNSString:(NSString *)outerSegmentSuffix
                                  withNSString:(NSString *)segmentSuffix {
  return OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_getFullSegmentSuffixWithNSString_withNSString_withNSString_(fieldName, outerSegmentSuffix, segmentSuffix);
}

- (OrgApacheLuceneCodecsFieldsConsumer *)fieldsConsumerWithOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)state {
  return create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_(self, state);
}

- (OrgApacheLuceneCodecsFieldsProducer *)fieldsProducerWithOrgApacheLuceneIndexSegmentReadState:(OrgApacheLuceneIndexSegmentReadState *)state {
  return create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneIndexSegmentReadState_(state);
}

- (OrgApacheLuceneCodecsPostingsFormat *)getPostingsFormatForFieldWithNSString:(NSString *)field {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

+ (void)initialize {
  if (self == [OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat class]) {
    JreStrongAssign(&OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_FORMAT_KEY, JreStrcat("$$", [OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_class_() getSimpleName], @".format"));
    JreStrongAssign(&OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_SUFFIX_KEY, JreStrcat("$$", [OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_class_() getSimpleName], @".suffix"));
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "PerFieldPostingsFormat", NULL, 0x1, NULL, NULL },
    { "getSuffixWithNSString:withNSString:", "getSuffix", "Ljava.lang.String;", 0x8, NULL, NULL },
    { "getFullSegmentSuffixWithNSString:withNSString:withNSString:", "getFullSegmentSuffix", "Ljava.lang.String;", 0x8, NULL, NULL },
    { "fieldsConsumerWithOrgApacheLuceneIndexSegmentWriteState:", "fieldsConsumer", "Lorg.apache.lucene.codecs.FieldsConsumer;", 0x11, "Ljava.io.IOException;", NULL },
    { "fieldsProducerWithOrgApacheLuceneIndexSegmentReadState:", "fieldsProducer", "Lorg.apache.lucene.codecs.FieldsProducer;", 0x11, "Ljava.io.IOException;", NULL },
    { "getPostingsFormatForFieldWithNSString:", "getPostingsFormatForField", "Lorg.apache.lucene.codecs.PostingsFormat;", 0x401, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "PER_FIELD_NAME", "PER_FIELD_NAME", 0x19, "Ljava.lang.String;", &OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_NAME, NULL, .constantValue.asLong = 0 },
    { "PER_FIELD_FORMAT_KEY", "PER_FIELD_FORMAT_KEY", 0x19, "Ljava.lang.String;", &OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_FORMAT_KEY, NULL, .constantValue.asLong = 0 },
    { "PER_FIELD_SUFFIX_KEY", "PER_FIELD_SUFFIX_KEY", 0x19, "Ljava.lang.String;", &OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_SUFFIX_KEY, NULL, .constantValue.asLong = 0 },
  };
  static const char *inner_classes[] = {"Lorg.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsGroup;", "Lorg.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsWriter;", "Lorg.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsReader;"};
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat = { 2, "PerFieldPostingsFormat", "org.apache.lucene.codecs.perfield", NULL, 0x401, 6, methods, 3, fields, 0, NULL, 3, inner_classes, NULL, NULL };
  return &_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat;
}

@end

void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_init(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *self) {
  OrgApacheLuceneCodecsPostingsFormat_initWithNSString_(self, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_PER_FIELD_NAME);
}

NSString *OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_getSuffixWithNSString_withNSString_(NSString *formatName, NSString *suffix) {
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_initialize();
  return JreStrcat("$C$", formatName, '_', suffix);
}

NSString *OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_getFullSegmentSuffixWithNSString_withNSString_withNSString_(NSString *fieldName, NSString *outerSegmentSuffix, NSString *segmentSuffix) {
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_initialize();
  if (((jint) [((NSString *) nil_chk(outerSegmentSuffix)) length]) == 0) {
    return segmentSuffix;
  }
  else {
    @throw create_JavaLangIllegalStateException_initWithNSString_(JreStrcat("$$$", @"cannot embed PerFieldPostingsFormat inside itself (field \"", fieldName, @"\" returned PerFieldPostingsFormat)"));
  }
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat)

@implementation OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)dealloc {
  RELEASE_(fields_);
  RELEASE_(state_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "init", "FieldsGroup", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "fields_", NULL, 0x10, "Ljava.util.Set;", NULL, "Ljava/util/Set<Ljava/lang/String;>;", .constantValue.asLong = 0 },
    { "suffix_", NULL, 0x0, "I", NULL, NULL, .constantValue.asLong = 0 },
    { "state_", NULL, 0x0, "Lorg.apache.lucene.index.SegmentWriteState;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup = { 2, "FieldsGroup", "org.apache.lucene.codecs.perfield", "PerFieldPostingsFormat", 0x8, 1, methods, 3, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup;
}

@end

void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_init(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *self) {
  NSObject_init(self);
  JreStrongAssignAndConsume(&self->fields_, new_JavaUtilTreeSet_init());
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_init() {
  J2OBJC_NEW_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup, init)
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_init() {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup, init)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup)

@implementation OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter

- (instancetype)initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat:(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *)outer$
                                  withOrgApacheLuceneIndexSegmentWriteState:(OrgApacheLuceneIndexSegmentWriteState *)writeState {
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_(self, outer$, writeState);
  return self;
}

- (void)writeWithOrgApacheLuceneIndexFields:(OrgApacheLuceneIndexFields *)fields {
  id<JavaUtilMap> formatToGroups = create_JavaUtilHashMap_init();
  id<JavaUtilMap> suffixes = create_JavaUtilHashMap_init();
  for (NSString * __strong field in nil_chk(fields)) {
    OrgApacheLuceneIndexFieldInfo *fieldInfo = [((OrgApacheLuceneIndexFieldInfos *) nil_chk(((OrgApacheLuceneIndexSegmentWriteState *) nil_chk(writeState_))->fieldInfos_)) fieldInfoWithNSString:field];
    OrgApacheLuceneCodecsPostingsFormat *format = [this$0_ getPostingsFormatForFieldWithNSString:field];
    if (format == nil) {
      @throw create_JavaLangIllegalStateException_initWithNSString_(JreStrcat("$$C", @"invalid null PostingsFormat for field=\"", field, '"'));
    }
    NSString *formatName = [format getName];
    OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *group = [formatToGroups getWithId:format];
    if (group == nil) {
      JavaLangInteger *suffix = [suffixes getWithId:formatName];
      if (suffix == nil) {
        suffix = JavaLangInteger_valueOfWithInt_(0);
      }
      else {
        suffix = JavaLangInteger_valueOfWithInt_([suffix intValue] + 1);
      }
      [suffixes putWithId:formatName withId:suffix];
      NSString *segmentSuffix = OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_getFullSegmentSuffixWithNSString_withNSString_withNSString_(field, writeState_->segmentSuffix_, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_getSuffixWithNSString_withNSString_(formatName, JavaLangInteger_toStringWithInt_([suffix intValue])));
      group = create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_init();
      JreStrongAssignAndConsume(&group->state_, new_OrgApacheLuceneIndexSegmentWriteState_initWithOrgApacheLuceneIndexSegmentWriteState_withNSString_(writeState_, segmentSuffix));
      group->suffix_ = [suffix intValue];
      [formatToGroups putWithId:format withId:group];
    }
    else {
      if (![suffixes containsKeyWithId:formatName]) {
        @throw create_JavaLangIllegalStateException_initWithNSString_(JreStrcat("$$$I", @"no suffix for format name: ", formatName, @", expected: ", group->suffix_));
      }
    }
    [((id<JavaUtilSet>) nil_chk(group->fields_)) addWithId:field];
    NSString *previousValue = [((OrgApacheLuceneIndexFieldInfo *) nil_chk(fieldInfo)) putAttributeWithNSString:JreLoadStatic(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat, PER_FIELD_FORMAT_KEY) withNSString:formatName];
    if (previousValue != nil) {
      @throw create_JavaLangIllegalStateException_initWithNSString_(JreStrcat("$$$$$$$$", @"found existing value for ", JreLoadStatic(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat, PER_FIELD_FORMAT_KEY), @", field=", fieldInfo->name_, @", old=", previousValue, @", new=", formatName));
    }
    previousValue = [fieldInfo putAttributeWithNSString:JreLoadStatic(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat, PER_FIELD_SUFFIX_KEY) withNSString:JavaLangInteger_toStringWithInt_(group->suffix_)];
    if (previousValue != nil) {
      @throw create_JavaLangIllegalStateException_initWithNSString_(JreStrcat("$$$$$$$I", @"found existing value for ", JreLoadStatic(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat, PER_FIELD_SUFFIX_KEY), @", field=", fieldInfo->name_, @", old=", previousValue, @", new=", group->suffix_));
    }
  }
  jboolean success = false;
  @try {
    for (id<JavaUtilMap_Entry> __strong ent in nil_chk([formatToGroups entrySet])) {
      OrgApacheLuceneCodecsPostingsFormat *format = [((id<JavaUtilMap_Entry>) nil_chk(ent)) getKey];
      OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *group = [ent getValue];
      OrgApacheLuceneIndexFields *maskedFields = create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_(group, fields);
      OrgApacheLuceneCodecsFieldsConsumer *consumer = [((OrgApacheLuceneCodecsPostingsFormat *) nil_chk(format)) fieldsConsumerWithOrgApacheLuceneIndexSegmentWriteState:((OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *) nil_chk(group))->state_];
      [((id<JavaUtilList>) nil_chk(toClose_)) addWithId:consumer];
      [((OrgApacheLuceneCodecsFieldsConsumer *) nil_chk(consumer)) writeWithOrgApacheLuceneIndexFields:maskedFields];
    }
    success = true;
  }
  @finally {
    if (success == false) {
      OrgApacheLuceneUtilIOUtils_closeWhileHandlingExceptionWithJavaLangIterable_(toClose_);
    }
  }
}

- (void)close {
  OrgApacheLuceneUtilIOUtils_closeWithJavaLangIterable_(toClose_);
}

- (void)dealloc {
  RELEASE_(this$0_);
  RELEASE_(writeState_);
  RELEASE_(toClose_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat:withOrgApacheLuceneIndexSegmentWriteState:", "FieldsWriter", NULL, 0x1, NULL, NULL },
    { "writeWithOrgApacheLuceneIndexFields:", "write", "V", 0x1, "Ljava.io.IOException;", NULL },
    { "close", NULL, "V", 0x1, "Ljava.io.IOException;", NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "this$0_", NULL, 0x1012, "Lorg.apache.lucene.codecs.perfield.PerFieldPostingsFormat;", NULL, NULL, .constantValue.asLong = 0 },
    { "writeState_", NULL, 0x10, "Lorg.apache.lucene.index.SegmentWriteState;", NULL, NULL, .constantValue.asLong = 0 },
    { "toClose_", NULL, 0x10, "Ljava.util.List;", NULL, "Ljava/util/List<Ljava/io/Closeable;>;", .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter = { 2, "FieldsWriter", "org.apache.lucene.codecs.perfield", "PerFieldPostingsFormat", 0x2, 3, methods, 3, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter;
}

@end

void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter *self, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *outer$, OrgApacheLuceneIndexSegmentWriteState *writeState) {
  JreStrongAssign(&self->this$0_, outer$);
  OrgApacheLuceneCodecsFieldsConsumer_init(self);
  JreStrongAssignAndConsume(&self->toClose_, new_JavaUtilArrayList_init());
  JreStrongAssign(&self->writeState_, writeState);
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *outer$, OrgApacheLuceneIndexSegmentWriteState *writeState) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter, initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_, outer$, writeState)
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat *outer$, OrgApacheLuceneIndexSegmentWriteState *writeState) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter, initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_withOrgApacheLuceneIndexSegmentWriteState_, outer$, writeState)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter)

@implementation OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1

- (id<JavaUtilIterator>)iterator {
  return [((id<JavaUtilSet>) nil_chk(((OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *) nil_chk(val$group_))->fields_)) iterator];
}

- (instancetype)initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup:(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *)capture$0
                                                         withOrgApacheLuceneIndexFields:(OrgApacheLuceneIndexFields *)arg$0 {
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_(self, capture$0, arg$0);
  return self;
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf, len);
}

- (void)dealloc {
  RELEASE_(val$group_);
  [super dealloc];
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "iterator", NULL, "Ljava.util.Iterator;", 0x1, NULL, "()Ljava/util/Iterator<Ljava/lang/String;>;" },
    { "initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup:withOrgApacheLuceneIndexFields:", "", NULL, 0x0, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "val$group_", NULL, 0x1012, "Lorg.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsGroup;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjCEnclosingMethodInfo enclosing_method = { "OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter", "writeWithOrgApacheLuceneIndexFields:" };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1 = { 2, "", "org.apache.lucene.codecs.perfield", "PerFieldPostingsFormat$FieldsWriter", 0x8008, 2, methods, 1, fields, 0, NULL, 0, NULL, &enclosing_method, NULL };
  return &_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1;
}

@end

void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1 *self, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *capture$0, OrgApacheLuceneIndexFields *arg$0) {
  JreStrongAssign(&self->val$group_, capture$0);
  OrgApacheLuceneIndexFilterLeafReader_FilterFields_initWithOrgApacheLuceneIndexFields_(self, arg$0);
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1 *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *capture$0, OrgApacheLuceneIndexFields *arg$0) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1, initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_, capture$0, arg$0)
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1 *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup *capture$0, OrgApacheLuceneIndexFields *arg$0) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1, initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsGroup_withOrgApacheLuceneIndexFields_, capture$0, arg$0)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsWriter_$1)

J2OBJC_INITIALIZED_DEFN(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader)

@implementation OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader

- (instancetype)initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader:(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *)other {
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_(self, other);
  return self;
}

- (instancetype)initWithOrgApacheLuceneIndexSegmentReadState:(OrgApacheLuceneIndexSegmentReadState *)readState {
  OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneIndexSegmentReadState_(self, readState);
  return self;
}

- (id<JavaUtilIterator>)iterator {
  return [((id<JavaUtilSet>) nil_chk(JavaUtilCollections_unmodifiableSetWithJavaUtilSet_([((id<JavaUtilMap>) nil_chk(fields_)) keySet]))) iterator];
}

- (OrgApacheLuceneIndexTerms *)termsWithNSString:(NSString *)field {
  OrgApacheLuceneCodecsFieldsProducer *fieldsProducer = [((id<JavaUtilMap>) nil_chk(fields_)) getWithId:field];
  return fieldsProducer == nil ? nil : [fieldsProducer termsWithNSString:field];
}

- (jint)size {
  return [((id<JavaUtilMap>) nil_chk(fields_)) size];
}

- (void)close {
  OrgApacheLuceneUtilIOUtils_closeWithJavaLangIterable_([((id<JavaUtilMap>) nil_chk(formats_)) values]);
}

- (jlong)ramBytesUsed {
  jlong ramBytesUsed = OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_BASE_RAM_BYTES_USED;
  ramBytesUsed += [((id<JavaUtilMap>) nil_chk(fields_)) size] * 2LL * JreLoadStatic(OrgApacheLuceneUtilRamUsageEstimator, NUM_BYTES_OBJECT_REF);
  ramBytesUsed += [((id<JavaUtilMap>) nil_chk(formats_)) size] * 2LL * JreLoadStatic(OrgApacheLuceneUtilRamUsageEstimator, NUM_BYTES_OBJECT_REF);
  for (id<JavaUtilMap_Entry> __strong entry_ in nil_chk([formats_ entrySet])) {
    ramBytesUsed += [((OrgApacheLuceneCodecsFieldsProducer *) nil_chk([((id<JavaUtilMap_Entry>) nil_chk(entry_)) getValue])) ramBytesUsed];
  }
  return ramBytesUsed;
}

- (id<JavaUtilCollection>)getChildResources {
  return OrgApacheLuceneUtilAccountables_namedAccountablesWithNSString_withJavaUtilMap_(@"format", formats_);
}

- (void)checkIntegrity {
  for (OrgApacheLuceneCodecsFieldsProducer * __strong producer in nil_chk([((id<JavaUtilMap>) nil_chk(formats_)) values])) {
    [((OrgApacheLuceneCodecsFieldsProducer *) nil_chk(producer)) checkIntegrity];
  }
}

- (OrgApacheLuceneCodecsFieldsProducer *)getMergeInstance {
  return create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_(self);
}

- (NSString *)description {
  return JreStrcat("$$$IC", @"PerFieldPostings(segment=", segment_, @" formats=", [((id<JavaUtilMap>) nil_chk(formats_)) size], ')');
}

- (NSUInteger)countByEnumeratingWithState:(NSFastEnumerationState *)state objects:(__unsafe_unretained id *)stackbuf count:(NSUInteger)len {
  return JreDefaultFastEnumeration(self, state, stackbuf, len);
}

- (void)dealloc {
  RELEASE_(fields_);
  RELEASE_(formats_);
  RELEASE_(segment_);
  [super dealloc];
}

+ (void)initialize {
  if (self == [OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader class]) {
    OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_BASE_RAM_BYTES_USED = OrgApacheLuceneUtilRamUsageEstimator_shallowSizeOfInstanceWithIOSClass_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_class_());
    J2OBJC_SET_INITIALIZED(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader)
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static const J2ObjcMethodInfo methods[] = {
    { "initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader:", "FieldsReader", NULL, 0x0, "Ljava.io.IOException;", NULL },
    { "initWithOrgApacheLuceneIndexSegmentReadState:", "FieldsReader", NULL, 0x1, "Ljava.io.IOException;", NULL },
    { "iterator", NULL, "Ljava.util.Iterator;", 0x1, NULL, "()Ljava/util/Iterator<Ljava/lang/String;>;" },
    { "termsWithNSString:", "terms", "Lorg.apache.lucene.index.Terms;", 0x1, "Ljava.io.IOException;", NULL },
    { "size", NULL, "I", 0x1, NULL, NULL },
    { "close", NULL, "V", 0x1, "Ljava.io.IOException;", NULL },
    { "ramBytesUsed", NULL, "J", 0x1, NULL, NULL },
    { "getChildResources", NULL, "Ljava.util.Collection;", 0x1, NULL, "()Ljava/util/Collection<Lorg/apache/lucene/util/Accountable;>;" },
    { "checkIntegrity", NULL, "V", 0x1, "Ljava.io.IOException;", NULL },
    { "getMergeInstance", NULL, "Lorg.apache.lucene.codecs.FieldsProducer;", 0x1, "Ljava.io.IOException;", NULL },
    { "description", "toString", "Ljava.lang.String;", 0x1, NULL, NULL },
  };
  static const J2ObjcFieldInfo fields[] = {
    { "BASE_RAM_BYTES_USED", "BASE_RAM_BYTES_USED", 0x1a, "J", &OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_BASE_RAM_BYTES_USED, NULL, .constantValue.asLong = 0 },
    { "fields_", NULL, 0x12, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;Lorg/apache/lucene/codecs/FieldsProducer;>;", .constantValue.asLong = 0 },
    { "formats_", NULL, 0x12, "Ljava.util.Map;", NULL, "Ljava/util/Map<Ljava/lang/String;Lorg/apache/lucene/codecs/FieldsProducer;>;", .constantValue.asLong = 0 },
    { "segment_", NULL, 0x12, "Ljava.lang.String;", NULL, NULL, .constantValue.asLong = 0 },
  };
  static const J2ObjcClassInfo _OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader = { 2, "FieldsReader", "org.apache.lucene.codecs.perfield", "PerFieldPostingsFormat", 0xa, 11, methods, 4, fields, 0, NULL, 0, NULL, NULL, NULL };
  return &_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader;
}

@end

void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *self, OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *other) {
  OrgApacheLuceneCodecsFieldsProducer_init(self);
  JreStrongAssignAndConsume(&self->fields_, new_JavaUtilTreeMap_init());
  JreStrongAssignAndConsume(&self->formats_, new_JavaUtilHashMap_init());
  id<JavaUtilMap> oldToNew = create_JavaUtilIdentityHashMap_init();
  for (id<JavaUtilMap_Entry> __strong ent in nil_chk([((OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *) nil_chk(other))->formats_ entrySet])) {
    OrgApacheLuceneCodecsFieldsProducer *values = [((OrgApacheLuceneCodecsFieldsProducer *) nil_chk([((id<JavaUtilMap_Entry>) nil_chk(ent)) getValue])) getMergeInstance];
    [self->formats_ putWithId:[ent getKey] withId:values];
    [oldToNew putWithId:[ent getValue] withId:values];
  }
  for (id<JavaUtilMap_Entry> __strong ent in nil_chk([other->fields_ entrySet])) {
    OrgApacheLuceneCodecsFieldsProducer *producer = [oldToNew getWithId:[((id<JavaUtilMap_Entry>) nil_chk(ent)) getValue]];
    JreAssert((producer != nil), (@"org/apache/lucene/codecs/perfield/PerFieldPostingsFormat.java:235 condition failed: assert producer != null;"));
    [self->fields_ putWithId:[ent getKey] withId:producer];
  }
  JreStrongAssign(&self->segment_, other->segment_);
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *other) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader, initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_, other)
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *other) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader, initWithOrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_, other)
}

void OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *self, OrgApacheLuceneIndexSegmentReadState *readState) {
  OrgApacheLuceneCodecsFieldsProducer_init(self);
  JreStrongAssignAndConsume(&self->fields_, new_JavaUtilTreeMap_init());
  JreStrongAssignAndConsume(&self->formats_, new_JavaUtilHashMap_init());
  jboolean success = false;
  @try {
    for (OrgApacheLuceneIndexFieldInfo * __strong fi in nil_chk(((OrgApacheLuceneIndexSegmentReadState *) nil_chk(readState))->fieldInfos_)) {
      if ([((OrgApacheLuceneIndexFieldInfo *) nil_chk(fi)) getIndexOptions] != JreLoadEnum(OrgApacheLuceneIndexIndexOptions, NONE)) {
        NSString *fieldName = fi->name_;
        NSString *formatName = [fi getAttributeWithNSString:JreLoadStatic(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat, PER_FIELD_FORMAT_KEY)];
        if (formatName != nil) {
          NSString *suffix = [fi getAttributeWithNSString:JreLoadStatic(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat, PER_FIELD_SUFFIX_KEY)];
          if (suffix == nil) {
            @throw create_JavaLangIllegalStateException_initWithNSString_(JreStrcat("$$$$", @"missing attribute: ", JreLoadStatic(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat, PER_FIELD_SUFFIX_KEY), @" for field: ", fieldName));
          }
          OrgApacheLuceneCodecsPostingsFormat *format = OrgApacheLuceneCodecsPostingsFormat_forNameWithNSString_(formatName);
          NSString *segmentSuffix = OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_getSuffixWithNSString_withNSString_(formatName, suffix);
          if (![self->formats_ containsKeyWithId:segmentSuffix]) {
            [self->formats_ putWithId:segmentSuffix withId:[((OrgApacheLuceneCodecsPostingsFormat *) nil_chk(format)) fieldsProducerWithOrgApacheLuceneIndexSegmentReadState:create_OrgApacheLuceneIndexSegmentReadState_initWithOrgApacheLuceneIndexSegmentReadState_withNSString_(readState, segmentSuffix)]];
          }
          [self->fields_ putWithId:fieldName withId:[self->formats_ getWithId:segmentSuffix]];
        }
      }
    }
    success = true;
  }
  @finally {
    if (!success) {
      OrgApacheLuceneUtilIOUtils_closeWhileHandlingExceptionWithJavaLangIterable_([self->formats_ values]);
    }
  }
  JreStrongAssign(&self->segment_, ((OrgApacheLuceneIndexSegmentInfo *) nil_chk(readState->segmentInfo_))->name_);
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *new_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneIndexSegmentReadState *readState) {
  J2OBJC_NEW_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader, initWithOrgApacheLuceneIndexSegmentReadState_, readState)
}

OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader *create_OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader_initWithOrgApacheLuceneIndexSegmentReadState_(OrgApacheLuceneIndexSegmentReadState *readState) {
  J2OBJC_CREATE_IMPL(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader, initWithOrgApacheLuceneIndexSegmentReadState_, readState)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgApacheLuceneCodecsPerfieldPerFieldPostingsFormat_FieldsReader)
